\section{量子力学の基礎}

量子力学に特徴的な事は、
物理量が単なる数ではなくHilbert空間に作用する
非可換なoperator（演算子、作用素）となる事である。
観測可能な量はHermitian operatorとなるので、
我々はoperatorとして専らlinearな
Hermitianないしunitary operatorを扱う。

\subsection{正準量子化}

\subsubsection{状態空間とOperator}

量子力学に現れるoperator $O$とは、
写像$O: \mathcal{H} \to \mathcal{H}$
すなわち
ある複素vector space $\mathcal{H}$の
元$\ket{\psi}$に作用して
再びvector space の元
$O\ket{\psi} \in \mathcal{H}$
を与えるものである。

あるoperator $O$が$\mathcal{H}$にlinearに作用している、
あるいはlinearである、とは
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        O\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a O \ket{\psi_1}
        +
        b O \ket{\psi_2}    
\end{align}
であることを言う。
例えば時間反転操作に対応するoperator $T$は
anti-unitary (anti-linearかつunitary)
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        T\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a^* T \ket{\psi_1}
        +
        b^* T \ket{\psi_2}    
\end{align}
なoperatorの重要な例であるが、
以下では専らlinearなものに話を限る。

量子力学では物理量はoperatorで表され、
解析力学で基本的な力学自由度であった
$\{q\},\{p\}$
さえもoperatorとなっている。
我々は任意の観測量の時間発展が決定論的な
物理法則によって記述されることを仮定するが、
一方で直接観測される量はもちろん実数であるので、
まずはこれらの観測量を
$\{\hat{q}\},\{\hat{p}\}$
のようなoperatorと関係付ける方法を考えなければならない。
以下ではこの方法を
Hilbert空間と呼ばれるvector spaceを用いて与えよう。

vector space $\mathcal{H}$が
内積$\eta$を持つとは、
$
\forall \ket{\psi_1}, \ket{\psi_2}
\in \mathcal{H}
$
に対し複素数
$ \braket{ \psi_1 | \psi_2 }
:= \eta(\ket{\psi_1}, \ket{\psi_2})
\in \mathbb{C} $
を与える写像
$\eta: 
\mathcal{H}\times \mathcal{H}
\to \mathbb{C}$
であって、
\begin{align}
    \braket{ \psi | \phi } &= \braket{ \phi | \psi }^*
&\text{（共役対称性）}
\\
            \bra{\phi}\Big(
            a \ket{\psi_1}
        +
            b \ket{\psi_2}
        \Big)
    &=
        a \braket{\phi|\psi_1}
    +
        b \braket{\phi|\psi_2}
    \qquad
    \text{ for } \forall
    a,b\in \mathbb{C}
&\text{（線形性）}
\\
    \braket{ \psi | \psi } \ge 0
    ,\quad&\text{and}\quad
    \braket{ \phi | \phi } = 0
    \Leftrightarrow
    \ket{\phi}=0
&\text{（正定値性）}
\end{align}
を満たすものがあることを言う。
Hilbert空間とは内積空間であって完備な
（直感的には、極限が十分に存在する）
ものを言う。
物理学において時間発展は微分方程式で与えられるので、
微分を定義するために
極限が存在する必要があるのである。

量子力学において決定論的な時間発展方程式に従う力学自由度は
Hilbert空間の元である。
このHilbert空間を状態空間と言い、
その元を状態vectorと呼ぶ。
個々の状態vectorの
時間発展はSchr\"odinger方程式
\begin{align}
    i\hbar \dfrac{d}{dt}
        \ket{\psi(t)}
    &=
    \hat{H} \ket{\psi(t)}
\end{align}
によって与えられる。
ここで$\hbar$は換算Planck定数またはDirac定数と呼ばれ、
Planck定数$h$により
\begin{align}
    \hbar := \dfrac{h}{2\pi}
\end{align}
と定義される。
また、
$\hat{H}$は以下で定義する
Hamiltonian operatorである。

\subsubsection{正準交換関係（CCR: Canonical Commutation Relation）}

二つのoperator $\hat{A}, \hat{B}$の間の交換関係を
\begin{align}
    [\hat{A}, \hat{B}] := \hat{A} \hat{B} - \hat{B} \hat{A}
\end{align}
で定義し、$[\hat{A}, \hat{B}] = 0$であるとき
$\hat{A}, \hat{B}$は可換であるという。
全く同様に反交換を
\begin{align}
    \{\hat{A}, \hat{B}\} := \hat{A} \hat{B} + \hat{B} \hat{A}
\end{align}
で定義しておく。
量子力学を考えるまで、
あらゆる量は可換であった。
このように全ての量が可換である力学系を
古典力学系と言い、そこに現れる可換な数を$c$-数という。

任意の関数$F(a)$について、
演算子$\hat{x}$の関数$\hat{F}(\hat{x})$を
（$a=0$周りの）Taylor展開により
\begin{align}
    \hat{F}(\hat{x}) := \sum_{n=0}^\infty
        \dfrac{1}{n!}
        \dfrac{d^nF(a)}{da^n}\bigg|_{a=0}
        \hat{x}^n
\end{align}
と定義する。
ある古典力学系のHamiltonian $H(\{q\},\{p\})$
が知られているとき、
その正準力学変数$\{q\},\{p\}$を
正準交換関係：
\begin{align}
    [ \hat{q}_i , \hat{p}_j ] = i\hbar \delta_{ij}
\end{align}
を満たすoperatorの組
$ \{\hat{q}\} , \{\hat{p}\} $
で置き換える手続きを正準量子化と呼び、
\begin{align}
    \hat{H}
    &:=
    \hat{H}(\{\hat{q}\} , \{\hat{p}\})
\end{align}
を得られた量子力学系の
Hamiltonian operator
という。

\subsubsection{ObservablesとHermitian conjugate}

任意のvector $\ket{\psi} \in \mathcal{H}$の
Hermitian conjugate $\ket{\psi}^\dagger$を
内積を使って
\begin{align}
    \ket{\psi}^\dagger
    :=
    \eta(\ket{\psi},\ )
\end{align}
により定め、$\bra{\psi}$とも書く。
元の空間の任意の元
$\ket{\phi} \in \mathcal{H}$
との内積が
\begin{align}
    \ket{\psi}^\dagger \ket{\phi}
    :=
    \braket{\psi|\phi}
    = \eta(\ket{\psi}, \ket{\phi})
    \in \mathbb{C}
\end{align}
のように複素数を与えるため、
内積の線形性から
$\bra{\psi}$は$\mathcal{H}$上の
線形汎関数と見做すことが出来、
$\bra{\psi}$のなす集合$\mathcal{H}^*$は
$\mathcal{H}$の（位相的あるいは線形）双対空間となる。

この定義の下でoperator $\hat{O}$の
Hermitian conjugate $\hat{O}^\dagger$も、
任意のvector $\ket{\psi}, \ket{\phi}$に対して
\begin{align}
    \bra{\psi}
    \hat{O}^\dagger
    \ket{\phi}
    =
    \ket{\psi}^\dagger
    \hat{O}^\dagger
    \ket{\phi}
    &:=
    \Big( \hat{O} \ket{\psi} \Big)^\dagger
    \ket{\phi}
    =
    \Big[
        \bra{\phi} \Big( \hat{O} \ket{\psi} \Big)
    \Big]^*
\end{align}
となるoperatorと定めることが出来る。

あるoperator $\hat{O}$がHermitianであるとは、
$\hat{O}$が
\begin{align}
    \hat{O} = \hat{O}^\dagger
\end{align}
を満たすことを言う。
量子力学におけるObservable（可換測量）は、
Hermitian operator で表される。

\subsubsection{Hermitian operatorとその固有状態}

Operatorはvectorに作用して
再びvectorを与えるので、
ある$\hat{O}$に対し
$\ket{\psi} \neq 0$が存在して
\begin{align}
    \hat{O}\ket{\psi} \propto \ket{\psi}
,\quad\text{
    i.e.   
    $\exists E\in\mathbb{C}$
    s.t.
}\quad
    \hat{O}\ket{\psi} = E \ket{\psi}
\end{align}
となる特別な状況を考えることが出来る。
このとき、vector $\ket{\psi}$は
$\hat{O}$の固有状態（eigenstate）であると言い、
定数$E$を$\ket{\psi}$の固有値（eigenvalue）と呼ぶ。
我々が特に興味があるのはObservableを表す
Hermitian operatorであるが、
$\hat{O} = \hat{O}^\dagger$のとき
$E$が実数となることが容易に示される。

\subsubsection{同時固有状態と物理的状態空間}

量子力学的な物理系の状態が
vector $\ket{\psi}$
で表されているとき、
物理量$\hat{A}$の期待値は
\begin{align}
    \braket{A} :=
    \dfrac{
        \bra{\psi} \hat{A} \ket{\psi}
    }{
        \braket{\psi|\psi}
    }
\end{align} 
と表される。
$\hat{A}$のspectral decompositionを
連続spectrum と点spectrum に分け、
対応するspectrumの固有空間への
projection operator $\hat{P}$を用いて
\begin{align}
    \hat{A} &=
    \sum_n { \hat{P}_n a_n }
    +
    \int d \hat{P} (a) a
\end{align}
のように書くと、
単位演算子との関係
\begin{align}
    1 = 
    \sum_n \hat{P}_n
    +
    \int d \hat{P} (a)
\end{align}
を用いて
\begin{align}
    \ket{\psi} = 
    \sum_n \hat{P}_n \ket{\psi}
    +
    \int d \hat{P} (a) \ket{\psi}
\end{align}
と書ける。
実際に観測される結果は演算子$\hat{A}$の
固有値のいずれかであり、
全く同一の状態$\ket{\psi}$で表される物理系を
十分多く用意したときの観測値は
\begin{enumerate}
    \item{点spectrum $a_n$が確率
    $
    \bra{\psi} \hat{P}_n \ket{\psi}
    $}
    \item{連続spectrum $a$が確率密度
    $
    \bra{\psi} d \hat{P}(a) \ket{\psi}
    $}
\end{enumerate}
で与えられるのである。

物理的状態は単にHilbert空間の元ではなく、
射線（ray）と呼ばれるobjectにより表される。

$\hat{H}$の固有状態をenergy固有状態と呼び、
energy固有状態が持つ固有値をenergyという。
特に、縮退がない場合はenergy $E$に属する状態が
一意に定まるため、これを$\ket{E}$と名付ける
conventionが一般的である。

\subsubsection{調和振動子の例}

$n$次元調和振動子を正準量子化してみよう。
$\{\hat{q}\}, \{\hat{p}\}$は可換測な物理量なのでHermitianであることを仮定しており、
\begin{align}
    \hat{H} &= \sum_{k=1}^n \bigg(
        \dfrac{ \hat{p}_k^2 }{2m} 
    +
        \dfrac{ m\omega^2 }{2} \hat{q}_k^2
    \bigg)
\\
    [ \hat{q}_i , \hat{p}_j ] &= i\hbar \delta_{ij}
\end{align}
から
$\hat{H}$のHermiticityも自然に従う。
公式(\ref{A,BC to B(A,C) + (A,B)C})を使って
\begin{align}
    [\hat{q}_i, H] &= i\hbar \dfrac{ \hat{p}_i }{m} 
\\
    [\hat{p}_j, H] &= - i \hbar\ m\omega^2 \hat{q}_j
\end{align}
が得られる。
これらが調和振動子の正準方程式
(\ref{hamiltonian e.o.m for harmonic oscillator})
に非常によく類似している事に注意しよう。

このままでは議論を進めるのが難しいが、
必ずしもHermitianではない無次元量への
変数変換を考えることで見通しが良くなる。
生成消滅演算子（creation and annihilation operator。昇降(raising and lowering)演算子、はしご(ladder)演算子などとも言う）を
\begin{align}
    \hat{a}_i :=\ & 
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        +
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\\
    \hat{a}^\dagger_i =\ &
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        -
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\end{align}
で定義しよう。
これは単に$\{\hat{q}\}, \{\hat{p}\}$から
$\{\hat{a}\}, \{\hat{a}^\dagger\}$への
線形変換であり、
逆変換は
\begin{align}
    \hat{q}_i &=
    \dfrac{1}{2}\sqrt{
        \dfrac{2\hbar}{m\omega}
    }
    \left(
        \hat{a}_i + \hat{a}^\dagger_i
    \right)
\\
    \hat{p}_i &=
    \dfrac{1}{2i}\sqrt{
        2\hbar m\omega
    }
    \left(
        \hat{a}_i - \hat{a}^\dagger_i
    \right)
\end{align}
で与えられる。

元の変数は容易に消去出来て
\begin{align}
    \hat{H}
%    &
    =
    \dfrac{ \hbar\omega }{ 2 }
    \sum_k
    \left(
        \hat{a}^\dagger_k\hat{a}_k
        +
        \hat{a}_k\hat{a}_k^\dagger
    \right)
%\\
    & 
    =
    \hbar\omega
    \sum_k
    \left(
        \hat{N}_k
        +
        \dfrac{ 1 }{ 2 }
    \right)
\\
    \hat{N}_k &:= \hat{a}^\dagger_k\hat{a}_k
\\
    [\hat{a}_i, \hat{a}^\dagger_j]
    &=\delta_{ij}
\\
    [\hat{H},\hat{a}_i]
    &= - \hbar \omega \hat{a}_i
    \\
    [\hat{H},\hat{a}^\dagger_j]
    &= + \hbar \omega \hat{a}^\dagger_j
\end{align}
が得られる。
ただし、
$k$番目の自由度のnumber operator
$\hat{N}_k$を定義した。
適当なenergy固有状態$ \ket{\psi} \neq 0 $
\begin{align}
    \hat{H} \ket{\psi}
    &=
    E \ket{\psi}
\end{align}
が存在するとき、
状態$\hat{a}_i \ket{\psi}$に$ \hat{H} $
を作用させると
\begin{align}
    \hat{H} \bigg(
        \hat{a}_i \ket{\psi}
    \bigg) 
&=
    \left(
        \hat{a}_i \hat{H} 
    +
        \left[ \hat{H}, \hat{a}_i \right]
    \right) \ket{\psi}
\quad\\&=
    \left(
        \hat{a}_i E
    - \hbar \omega \hat{a}_i
    \right) \ket{\psi}
\quad\\&=
    \left(
        E - \hbar \omega
    \right)
    \hat{a}_i \ket{\psi}
\end{align}
が得られ、状態$\hat{a}_i \ket{\psi}$は
（もし$0$でないならば）
energy $E - \hbar \omega$に属する
energy固有vector
（ただし規格化されているとは限らない）
であることが分かる。
全く同様に
\begin{align}
    \hat{H} \bigg(
        \hat{a}^\dagger_i \ket{\psi}
    \bigg) 
&=
    \left(
        E + \hbar \omega
    \right)
    \hat{a}^\dagger_i \ket{\psi}
\end{align}
であり、
$\hat{a}^\dagger_i, \hat{a}_i$は
$i$番目の自由度のenergy levelを
enrgy量子$\hbar\omega$分だけ上下することが分かる。
これが生成消滅の名の所以である。

$ \hat{H} = \hbar\omega
\sum_k
\left(
    \hat{a}^\dagger_k\hat{a}_k
    +
    \dfrac{ 1 }{ 2 }
\right) $
に気を付けると
\begin{align}
    E &=
    \bra{\psi} E \ket{\psi}
    = 
    \bra{\psi} \hat{H} \ket{\psi}
    = 
    \hbar\omega \sum_k
    \bra{\psi}     
        \left(
            \hat{a}^\dagger_k\hat{a}_k
        +
            \dfrac{ 1 }{ 2 }
        \right)
    \ket{\psi}
\notag\\&=
    \hbar\omega \sum_k
        \left(
        \bra{\psi}     
            \hat{a}^\dagger_k\hat{a}_k
        \ket{\psi}
            +
            \dfrac{ 1 }{ 2 }
        \right)
\notag\\&=
    \hbar\omega
        \left(
            \sum_k
            \Big|\Big|
                \hat{a}_k \ket{\psi}
            \Big|\Big|^2
            +
            \dfrac{ n }{ 2 }
        \right)
\ge
            \dfrac{ n \hbar\omega }{ 2 }
\end{align}
が導かれる。ここで内積の正定値性
$\Big|\Big|
\hat{a}_k \ket{\psi}
\Big|\Big|^2 \ge 0
$
を使った。

興味深いのは、$ \hat{H} $が
正定値なHilbert空間に作用しているという仮定のみから、
Hilbert空間にどのようなenergy固有状態が存在するかの
情報が得られるということである。

$\hat{a}_i \ket{\psi} \neq 0$ならnormが
\begin{align}
    \Big|\Big|
        \hat{a}_i \ket{\psi}
    \Big|\Big|^2
    &=
    \bra{\psi}     
            \hat{a}^\dagger_i \hat{a}_i
    \ket{\psi}
\end{align}
であるので、規格化は
