\section{量子力学の基礎}

量子力学に特徴的な事は、
物理量が単なる数ではなくHilbert空間に作用する
非可換なoperator（演算子、作用素）となる事である。
観測可能な量はHermitian operatorとなるので、
我々はoperatorとして専らlinearな
Hermitianないしunitary operatorを扱う。

\subsection{正準量子化}

\subsubsection{Hilbert空間とOperator}

量子力学に現れるoperator $O$とは、
写像$O: \mathcal{H} \to \mathcal{H}$
すなわち
ある複素vector space $\mathcal{H}$の
元$\ket{\psi}$に作用して
再びvector space の元
$O\ket{\psi} \in \mathcal{H}$
を与えるものである。

あるoperator $O$が$\mathcal{H}$にlinearに作用している、
あるいはlinearである、とは
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        O\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a O \ket{\psi_1}
        +
        b O \ket{\psi_2}    
\end{align}
であることを言う。
例えば時間反転操作に対応するoperator $T$は
anti-unitary (anti-linearかつunitary)
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        T\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a^* T \ket{\psi_1}
        +
        b^* T \ket{\psi_2}    
\end{align}
なoperatorの重要な例であるが、
以下では専らlinearなものに話を限る。

量子力学では物理量はoperatorで表され、
解析力学で基本的な力学自由度であった
$\{q\},\{p\}$
さえもoperatorとなっている。
我々は任意の観測量の時間発展が決定論的な
物理法則によって記述されることを仮定するが、
一方で直接観測される量はもちろん実数であるので、
まずはこれらの観測量を
$\{\hat{q}\},\{\hat{p}\}$
のようなoperatorと関係付ける方法を考えなければならない。
以下ではこの方法を
Hilbert空間と呼ばれるvector spaceを用いて与えよう。

vector space $\mathcal{H}$が
内積$\eta$を持つとは、
$
\forall \ket{\psi_1}, \ket{\psi_2}
\in \mathcal{H}
$
に対し複素数
$ \braket{ \psi_1 | \psi_2 }
:= \eta(\ket{\psi_1}, \ket{\psi_2})
\in \mathbb{C} $
を与える写像
$\eta: 
\mathcal{H}\times \mathcal{H}
\to \mathbb{C}$
であって、
\begin{align}
    \braket{ \psi | \phi } &= \braket{ \phi | \psi }^*
&\text{（共役対称性）}
\\
            \bra{\phi}\Big(
            a \ket{\psi_1}
        +
            b \ket{\psi_2}
        \Big)
    &=
        a \braket{\phi|\psi_1}
    +
        b \braket{\phi|\psi_2}
    \qquad
    \text{ for } \forall
    a,b\in \mathbb{C}
&\text{（線形性）}
\\
    \braket{ \psi | \psi } \ge 0
    ,\quad&\text{and}\quad
    \braket{ \phi | \phi } = 0
    \Leftrightarrow
    \ket{\phi}=0
&\text{（正定値性）}
\end{align}
を満たすものがあることを言う。
Hilbert空間とは内積空間であって完備な
（直感的には、極限が十分に存在する）
ものを言う。
物理学において時間発展は微分方程式で与えられるので、
微分を定義するために
極限が存在する必要があるのである。

量子力学において決定論的な時間発展方程式に従う力学自由度は
Hilbert空間の元である。
このHilbert空間を状態空間と言い、
その元を状態vectorと呼ぶ。
個々の状態vectorの
時間発展はSchr\"odinger方程式
\begin{align}
    i\hbar \dfrac{d}{dt}
        \ket{\psi(t)}
    &=
    \hat{H} \ket{\psi(t)}
\end{align}
によって与えられる。
ここで$\hbar$は換算Planck定数またはDirac定数と呼ばれ、
Planck定数$h$により
\begin{align}
    \hbar := \dfrac{h}{2\pi}
\end{align}
と定義される。
また、
$\hat{H}$は以下で定義する
Hamiltonian operatorである。

\subsubsection{正準交換関係（CCR: Canonical Commutation Relation）}

二つのoperator $\hat{A}, \hat{B}$の間の交換関係を
\begin{align}
    [\hat{A}, \hat{B}] := \hat{A} \hat{B} - \hat{B} \hat{A}
\end{align}
で定義し、$[\hat{A}, \hat{B}] = 0$であるとき
$\hat{A}, \hat{B}$は可換であるという。
全く同様に反交換を
\begin{align}
    \{\hat{A}, \hat{B}\} := \hat{A} \hat{B} + \hat{B} \hat{A}
\end{align}
で定義しておく。
量子力学を考えるまで、
あらゆる量は可換であった。
このように全ての量が可換である力学系を
古典力学系と言い、そこに現れる可換な数を$c$-数という。

任意の関数$F(a)$について、
演算子$\hat{x}$の関数$F(\hat{x})$を
（$a=0$周りの）Taylor展開により
\begin{align}
    F(\hat{x}) := \sum_{n=0}^\infty
        \dfrac{1}{n!}
        \dfrac{d^nF(a)}{da^n}\bigg|_{a=0}
        \hat{x}^n
\label{function of operator}
\end{align}
と定義する。
ある古典力学系のHamiltonian $H(\{q\},\{p\})$
が知られているとき、
その正準力学変数$\{q\},\{p\}$を
正準交換関係：
\begin{align}
    [ \hat{q}_i , \hat{p}_j ] = i\hbar \delta_{ij}
\end{align}
を満たすoperatorの組
$ \{\hat{q}\} , \{\hat{p}\} $
で置き換える手続きを正準量子化と呼び、
\begin{align}
    \hat{H}
    &:=
    H(\{\hat{q}\} , \{\hat{p}\})
\end{align}
を得られた量子力学系の
Hamiltonian operator
という。

厳密にはこれだけでは古典的Hamiltonian $H$が
例えば$qp$のような項を持っていたとき、それを
$\hat{p}\hat{q}$で置き換えるのか
$\hat{q}\hat{p} = \hat{p}\hat{q} + i\hbar$で置き換えるのか
といった問題は残る。
これを演算子順序の問題といい、
Hamiltonian operatorのHermiticityや
量子系の持つべき大域的対称性などから
一定の解答を与えることは出来るものの、
異なる演算子順序は物理的に異なる量子系を与えるため
一般に与えられた古典系に対して量子系を一意に定めることは出来ない。
ただし特定の文脈で自然な演算子順序は存在し、
このことは経路積分を扱う際により詳しく議論する。

\subsubsection{ObservablesとHermitian conjugate}

任意のvector $\ket{\psi} \in \mathcal{H}$の
Hermitian conjugate $\ket{\psi}^\dagger$を
内積を使って
\begin{align}
    \ket{\psi}^\dagger
    :=
    \eta(\ket{\psi},\ )
\end{align}
により定め、$\bra{\psi}$とも書く。
元の空間の任意の元
$\ket{\phi} \in \mathcal{H}$
との内積が
\begin{align}
    \ket{\psi}^\dagger \ket{\phi}
    :=
    \braket{\psi|\phi}
    = \eta(\ket{\psi}, \ket{\phi})
    \in \mathbb{C}
\end{align}
のように複素数を与えるため、
内積の線形性から
$\bra{\psi}$は$\mathcal{H}$上の
線形汎関数と見做すことが出来、
$\bra{\psi}$のなす集合$\mathcal{H}^*$は
$\mathcal{H}$の（位相的あるいは線形）双対空間となる。

この定義の下でoperator $\hat{O}$の
Hermitian conjugate $\hat{O}^\dagger$も、
任意のvector $\ket{\psi}, \ket{\phi}$に対して
\begin{align}
    \bra{\psi}
    \hat{O}^\dagger
    \ket{\phi}
    =
    \ket{\psi}^\dagger
    \hat{O}^\dagger
    \ket{\phi}
    &:=
    \Big( \hat{O} \ket{\psi} \Big)^\dagger
    \ket{\phi}
    =
    \Big[
        \bra{\phi} \Big( \hat{O} \ket{\psi} \Big)
    \Big]^*
\end{align}
となるoperatorと定めることが出来る。

あるoperator $\hat{O}$がHermitianであるとは、
$\hat{O}$が
\begin{align}
    \hat{O} = \hat{O}^\dagger
\end{align}
を満たすことを言う。
量子力学におけるObservable（可換測量）は、
Hermitian operator で表される。

\subsubsection{固有状態とHermitian operator}

Operatorはvectorに作用して
再びvectorを与えるので、
ある$\hat{O}$に対し
$\ket{\psi} \neq 0$が存在して
\begin{align}
    \hat{O}\ket{\psi} \propto \ket{\psi}
,\quad\text{
    i.e.   
    $\exists \lambda\in\mathbb{C}$
    s.t.
}\quad
    \hat{O}\ket{\psi} = \lambda \ket{\psi}
\end{align}
となる特別な状況を考えることが出来る。
このとき、定数$\lambda$を$\ket{\psi}$の固有値（eigenvalue）と呼び、
状態vector $\ket{\psi}$は
$\hat{O}$の固有値$\lambda$に属する
固有vecctorまたは
固有状態（eigenstate）であると言う。
また、上の等式を固有方程式（特性方程式、永年方程式とも）という。

ある固有値$\lambda$に属する線形独立な
固有vectorが$n$個あるとき
$n$を$\lambda$の縮退度と呼び、
$n = 1$ならば縮退がない、
$n \ge 2$ならば$n$重縮退があるという。
固有値$\lambda$に属する固有vectorの集合は
vector spaceを為し、これを固有値$\lambda$に対する
固有空間という。

我々が特に興味があるのはObservableを表す
Hermitian operatorであるが、
$\hat{O} = \hat{O}^\dagger$のとき
$\lambda$が実数となることが容易に示される。
例えば
$\hat{H}$の固有状態をenergy固有状態、
energy固有状態が持つ固有値をenergyというが、
任意のenergyは実数である。

\subsubsection{同時固有状態}

互いに可換な$n$個のoperator
$\hat{A}_1, \hat{A}_2, \dots, \hat{A}_n$
と、固有値$\lambda_i$に属する
$\hat{A}_i$の固有vector $\ket{\psi} \neq 0$
があるとしよう。
可換性$[\hat{A}_i, \hat{A}_j] = 0$から
\begin{align}
    \lambda_i \hat{A}_j \ket{\psi}
    &=
    \hat{A}_j \lambda_i \ket{\psi}
    =
    \hat{A}_j \hat{A}_i \ket{\psi}
    =
    \hat{A}_i \hat{A}_j \ket{\psi}
\end{align}
となるが、この式は
$\hat{A}_j \ket{\psi}$
が再び$\hat{A}_i$の固有値$\lambda_i$に対する
固有空間の元である事を意味する。
特に、縮退がない場合は
ある固有値
$\lambda_i$に属するvectorが定数倍を除いて一意に定まるため、
$\hat{A}_j \ket{\psi}$も
$\ket{\psi}$に比例しているはずである。
すなわち、$\ket{\psi}$は$\hat{A}_i$だけでなく
$\hat{A}_j$の固有vectorにもなっている。
$\lambda_i$に$m$重縮退がある場合でも、
固有空間の基底
$\ket{\psi_1}, \ket{\psi_2}, \dots, \ket{\psi_m}$
を適切に取ることにより
やはり全ての$\ket{\psi_k}$が
$\hat{A}_j$の固有vectorにもなるよう出来る事が示される
（ただし、$k$ごとに$\hat{A}_j$の固有値は
異なってよい）。

このように互いに可換なoperatorのうち一方の固有vectorが
同時に他方の固有vectorとなるように出来、
そのようなvectorを同時（simultaneous）固有vectorという。

\subsubsection{観測値とOperatorの関係、状態vectorの命名規則、物理的状態空間}

量子力学的な物理系の状態が
vector $\ket{\psi}$
で表されているとき、
物理量$\hat{A}$の期待値は
\begin{align}
    \braket{A} :=
    \dfrac{
        \bra{\psi} \hat{A} \ket{\psi}
    }{
        \braket{\psi|\psi}
    }
\end{align} 
と表される。
$\hat{A}$のspectral decompositionを
連続spectrum と点spectrum に分け、
対応するspectrumの固有空間への
projection operator $\hat{P}$を用いて
\begin{align}
    \hat{A} &=
    \sum_n { \hat{P}_n a_n }
    +
    \int d \hat{P} (a) a
\end{align}
のように書くと、
単位演算子との関係
\begin{align}
    1 = 
    \sum_n \hat{P}_n
    +
    \int d \hat{P} (a)
\end{align}
を用いて
\begin{align}
    \ket{\psi} = 
    \sum_n \hat{P}_n \ket{\psi}
    +
    \int d \hat{P} (a) \ket{\psi}
\end{align}
が成り立つ。
実際に観測される結果は演算子$\hat{A}$の
固有値のいずれかであり、
全く同一の状態 vector $\ket{\psi}$で表される物理系を
十分多く用意したときの観測値は
\begin{enumerate}
    \item{点spectrum $a_n$に関しては確率
    $
    \dfrac{
        \bra{\psi} \hat{P}_n \ket{\psi}
    }{
     \braket{\psi|\psi}   
    }    
    $}
    \item{連続spectrum $a$に関しては確率密度
    $
    \dfrac{
        \bra{\psi} d \hat{P}(a) \ket{\psi}
    }{
     \braket{\psi|\psi}   
    }    
    $}
\end{enumerate}
で与えられるのである。

これらの規則を見ると、状態vector $\ket{\psi}$を
定数（たとえば$a \in \mathbb{C}$）倍だけ
再定義してもnormが伴って
$\braket{\psi|\psi} \mapsto |a|^2 \braket{\psi|\psi}$
と変化するため、
物理法則が予言する個々の観測量の期待値や確率は
一切変化しない事に気付くであろう。
実際vectorのnormは物理的情報を持っておらず、
従ってvector $\ket{\psi}$と$a \ket{\psi}$は
物理的に区別されるべき異なる状態ではない。
よって常に
$a = \dfrac{1}{\sqrt{ \braket{\psi|\psi} }}$
による再定義で$\braket{\psi|\psi} = 1$
としておくのが便利である。
このようなvectorの再定義を規格化（normalization）と言い、
以下では状態vectorは規格化されているものとする。
状態vectorを規格化してもなお、
$a=e^{i\theta}, \theta\in \mathbb{R}$
のような場合は$\ket{\psi}$と
$e^{i\theta}\ket{\psi}$は
独立な状態を表さない。
このようなoverallの位相も物理的情報を持たない
（もちろん複数のvectorの相対的な位相は意味を持つが）ため、
物理的状態は単にHilbert空間の元ではなく、
それらを規格化し、更に位相だけの違いは同一視した
射線（ray）と呼ばれるobjectにより表される。

物理的に区別できないvectorについては上のように述べたが、
更に我々は物理的に明確に区別できる
（つまりあるHermitian operatorについて異なる固有値を持つ）
状態を表す状態vectorが互いに直交する事を要求する。
当然、任意のoperatorについて同じ固有値を持つvectorは
どのような物理量ないし実験によっても区別できないため同じ状態と見做す。
一般にある量子系において、
線形独立なHermitian operatorのうち
可換に取れるもののmaximalな個数が$n$であるとき、
そのようなoperator
$\hat{O}_1,\hat{O}_2,\dots,\hat{O}_n$
の同時固有vectorは
（どのoperatorについて議論しているのか明らかな場合には）対応する固有値
$\lambda_1, \lambda_2, \dots , \lambda_n$を用いて
$\ket{\lambda_1, \lambda_2, \dots , \lambda_n}$
と名付けるのが普通であり、
このvectorに対応するrayが
（互いに独立な）物理的状態を表すのである。

改めてrayの集合を物理的状態空間あるいは単に状態空間（state space）
と呼ぶことにしよう。
ある物理的状態とそれを表すrayまたは状態vectorも区別せず、
これら全てを単に状態と呼ぶことにする。
以下で規格化などによる同一視を行わないHilbert空間を直接扱うことはなく、
そのため議論にvectorのnormが関わることもないので、
以前の用語との混乱は生じない。

\subsubsection{DiracのBracket記法}

これまでは$\ket{\psi}$のような記号を
単に状態vectorを表すものと扱っていたが、
Diracはこれを更に便利にする記法を導入した。
$\hat{A}$の固有値$a_n$に対する
固有vectorを$\ket{a_n}$と略記し、
固有空間に$m$重縮退がある場合には
適当な正規直交基底$\ket{a_n,i}(i=1,\dots,m)$を取る。
ここで、対応する固有空間へのprojection operatorを
\begin{align}
    \hat{P}_k &=: \sum_{i=1}^m \ket{a_n,i}\bra{a_n,i}
\\
    \hat{P}(a) &=: da \ket{a}\bra{a}
\end{align}
のように書くというのである。
なお数学的には連続spectrumに対して固有vectorは存在しないが、
上は単にspectral decompositionの略記法だと思えばよい。
点spetrumと連続spectrumとを形式的に区別せずに書けるため、
物理学者には非常に重宝がられている記法である。

\subsubsection{調和振動子の例}

$n$次元調和振動子を正準量子化してみよう。
$\{\hat{q}\}, \{\hat{p}\}$は可換測な物理量なのでHermitianであることを仮定しており、
\begin{align}
    \hat{H} &= \sum_{k=1}^n \bigg(
        \dfrac{ \hat{p}_k^2 }{2m} 
    +
        \dfrac{ m\omega^2 }{2} \hat{q}_k^2
    \bigg)
\\
    [ \hat{q}_i , \hat{p}_j ] &= i\hbar \delta_{ij}
\end{align}
から
$\hat{H}$のHermiticityも自然に従う。
公式(\ref{A,BC to B(A,C) + (A,B)C})を使って
\begin{align}
    [\hat{q}_i, \hat{H}] &= i\hbar \dfrac{ \hat{p}_i }{m} 
\\
    [\hat{p}_j, \hat{H}] &= - i \hbar\ m\omega^2 \hat{q}_j
\end{align}
が得られる。
これらが調和振動子の正準方程式
(\ref{hamiltonian e.o.m for harmonic oscillator})
に非常によく類似している事に注意しよう
（より詳しくは
(\ref{Hamiltonian as time translation generator})
を参照）。

このままでは議論を進めるのが難しいが、
必ずしもHermitianではない無次元量への
変数変換を考えることで見通しが良くなる。
生成消滅演算子（creation and annihilation operator。昇降(raising and lowering)演算子、はしご(ladder)演算子などとも言う）を
\begin{align}
    \hat{a}_i :=\ & 
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        +
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\\
    \hat{a}^\dagger_i =\ &
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        -
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\end{align}
で定義しよう。
これは単に$\{\hat{q}\}, \{\hat{p}\}$から
$\{\hat{a}\}, \{\hat{a}^\dagger\}$への
線形変換であり、
逆変換は
\begin{align}
    \hat{q}_i &=
    \dfrac{1}{2}\sqrt{
        \dfrac{2\hbar}{m\omega}
    }
    \left(
        \hat{a}_i + \hat{a}^\dagger_i
    \right)
\\
    \hat{p}_i &=
    \dfrac{1}{2i}\sqrt{
        2\hbar m\omega
    }
    \left(
        \hat{a}_i - \hat{a}^\dagger_i
    \right)
\end{align}
で与えられる。

元の変数は容易に消去出来て
\begin{align}
    \hat{H}
%    &
    =
    \dfrac{ \hbar\omega }{ 2 }
    \sum_k
    \left(
        \hat{a}^\dagger_k\hat{a}_k
        +
        \hat{a}_k\hat{a}_k^\dagger
    \right)
%\\
    & 
    =
    \hbar\omega
    \sum_k
    \left(
        \hat{N}_k
        +
        \dfrac{ 1 }{ 2 }
    \right)
\\
    \hat{N}_k &:= \hat{a}^\dagger_k\hat{a}_k
\\
    [\hat{a}_i, \hat{a}^\dagger_j]
    &=\delta_{ij}
\\
    [\hat{H},\hat{a}_i]
    &= - \hbar \omega \hat{a}_i
    \\
    [\hat{H},\hat{a}^\dagger_j]
    &= + \hbar \omega \hat{a}^\dagger_j
\end{align}
が得られる。
ただし、
$k$番目の自由度のnumber operator
$\hat{N}_k$を定義した。
適当なenergy固有状態$ \ket{\psi} \neq 0 $
\begin{align}
    \hat{H} \ket{\psi}
    &=
    E \ket{\psi}
\end{align}
が存在するとき、
状態$\hat{a}_i \ket{\psi}$に$ \hat{H} $
を作用させると
\begin{align}
    \hat{H} \bigg(
        \hat{a}_i \ket{\psi}
    \bigg) 
&=
    \left(
        \hat{a}_i \hat{H} 
    +
        \left[ \hat{H}, \hat{a}_i \right]
    \right) \ket{\psi}
\quad\\&=
    \left(
        \hat{a}_i E
    - \hbar \omega \hat{a}_i
    \right) \ket{\psi}
\quad\\&=
    \left(
        E - \hbar \omega
    \right)
    \hat{a}_i \ket{\psi}
\end{align}
が得られ、状態$\hat{a}_i \ket{\psi}$は
（もし$0$でないならば）
energy $E - \hbar \omega$に属する
energy固有vector
（ただし規格化されているとは限らない）
であることが分かる。
全く同様に
\begin{align}
    \hat{H} \bigg(
        \hat{a}^\dagger_i \ket{\psi}
    \bigg) 
&=
    \left(
        E + \hbar \omega
    \right)
    \hat{a}^\dagger_i \ket{\psi}
\end{align}
であり、
$\hat{a}^\dagger_i, \hat{a}_i$は
$i$番目の自由度のenergy levelを
enrgy量子$\hbar\omega$分だけ上下することが分かる。
これが生成消滅の名の所以である。

興味深いのは、$ \hat{H} $が
正定値なHilbert空間に作用しているという仮定のみから、
Hilbert空間にどのようなenergy固有状態が存在するかの
情報が得られるということである。
$\hat{N}_i$同士は互いに可換なので、
その同時固有状態$\ket{N_1, N_2,\dots, N_n}$
を用意できる。
これは明らかに
$ \hat{H} = \hbar\omega
\sum_k
\left(
    \hat{N}_k
    +
    \dfrac{ 1 }{ 2 }
\right) $
の固有状態でもあり、
$\hat{a}^\dagger_i, \hat{a}_i$が
$\hat{N}_i$のみの固有値を$1$だけ上下する事も
上の議論から明らかであろう。
この状態$\ket{N_1, N_2,\dots, N_n}$によって
$\hat{N}_i$の期待値を取ると
\begin{align}
    N_i &=
    \bra{N_1, N_2,\dots, N_n} N_i \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \bra{N_1, N_2,\dots, N_n} \hat{N}_i \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \bra{N_1, N_2,\dots, N_n}     
    \hat{a}^\dagger_i\hat{a}_i
    \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \Big|\Big|
        \hat{a}_i \ket{N_1, N_2,\dots, N_n}
    \Big|\Big|^2 \ge 0
\end{align}
が導かれる。
最後の不等式は単に内積の正定値性から要求されるのだが、
$0<N_i<1$のとき
$\hat{a}_i$によって$\hat{N}_i$の固有値を下げると
\begin{align}
    \bra{N_1, N_2,\dots, N_n}
        \hat{a}_i^\dagger \hat{N}_i \hat{a}_i
    \ket{N_1, N_2,\dots, N_n}
    &\propto
    N_i - 1 < 0
\end{align}
となり、（比例定数は単に
$\hat{a}_i \ket{N_1, N_2,\dots, N_n}$
の規格化から出る正の定数であるため）
正定値性から導かれる不等式に矛盾してしまう。
同様に適当な自然数$p\in\mathbb{N}_+$に対し
$p<N_i<p+1$のときも$\hat{a}_i$を$p$回以上作用させれば
正定値性の不等式に矛盾する結果が得られるので、
$\hat{N}_i$の任意の固有値は非負整数であり、
かつ
$N_i = 0$の状態に対しては
\begin{align}
    \hat{a}_i \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n} = 0
\end{align}
が成り立つ必要があると分かる。
すなわち$\forall i$について$N_i \in \mathbb{N}_{\ge 0}$であり、
energy固有値はこれらを用い
\begin{align}
    E = \hbar\omega
    \left(
    \sum_{k=1}^n
        N_k
    +
        \dfrac{ n }{ 2 }
    \right)
\end{align}
と表されることが内積の正定値性のみから導かれたのである。
