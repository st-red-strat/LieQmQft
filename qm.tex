\section{量子力学の基礎}

量子力学に特徴的な事は、
物理量が単なる数ではなくHilbert空間に作用する
非可換なoperator（演算子、作用素）となる事である。
観測可能な量はHermitian operatorとなるので、
我々はoperatorとして専らlinearな
Hermitianないしunitary operatorを扱う。

\subsection{正準量子化}

\subsubsection{Hilbert空間とOperator}

量子力学に現れるoperator $O$とは、
写像$O: \mathcal{H} \to \mathcal{H}$
すなわち
ある複素vector space $\mathcal{H}$の
元$\ket{\psi}$に作用して
再びvector space の元
$O\ket{\psi} \in \mathcal{H}$
を与えるものである。
例えばidentity operator（恒等演算子、単位演算子）$1$は
任意のvector $\ket{\psi}$に対し
\begin{align}
    1 \ket{\psi} = \ket{\psi}
\end{align}
を与える。

あるoperator $O$が$\mathcal{H}$にlinearに作用している、
あるいはlinearである、とは
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        O\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a O \ket{\psi_1}
        +
        b O \ket{\psi_2}    
\end{align}
であることを言う。
例えば時間反転操作に対応するoperator $T$は
anti-unitary (anti-linearかつunitary)
\begin{align}
    \text{ For }
        \forall \ket{\psi_1}, \ket{\psi_2}
        \in \mathcal{H}
    \text{ and }
        \forall a,b\in \mathbb{C}
    ,\qquad
        T\Big(
            a \ket{\psi_1}
            +
            b \ket{\psi_2}    
        \Big)
    =
        a^* T \ket{\psi_1}
        +
        b^* T \ket{\psi_2}    
\end{align}
なoperatorの重要な例であるが、
以下では専らlinearなものに話を限る。

量子力学では物理量はoperatorで表され、
解析力学で基本的な力学自由度であった
$\{q\},\{p\}$
さえもoperatorとなっている。
我々は任意の観測量の時間発展が決定論的な
物理法則によって記述されることを仮定するが、
一方で直接観測される量はもちろん実数であるので、
まずはこれらの観測量を
$\{\hat{q}\},\{\hat{p}\}$
のようなoperatorと関係付ける方法を考えなければならない。
以下ではこの方法を
Hilbert空間と呼ばれるvector spaceを用いて与えよう。

vector space $\mathcal{H}$が
内積$\eta$を持つとは、
$
\forall \ket{\psi_1}, \ket{\psi_2}
\in \mathcal{H}
$
に対し複素数
$ \braket{ \psi_1 | \psi_2 }
:= \eta(\ket{\psi_1}, \ket{\psi_2})
\in \mathbb{C} $
を与える写像
$\eta: 
\mathcal{H}\times \mathcal{H}
\to \mathbb{C}$
であって、
\begin{align}
    \braket{ \psi | \phi } &= \braket{ \phi | \psi }^*
&\text{（共役対称性）}
\\
            \bra{\phi}\Big(
            a \ket{\psi_1}
        +
            b \ket{\psi_2}
        \Big)
    &=
        a \braket{\phi|\psi_1}
    +
        b \braket{\phi|\psi_2}
    \qquad
    \text{ for } \forall
    a,b\in \mathbb{C}
&\text{（線形性）}
\\
    \braket{ \psi | \psi } \ge 0
    ,\quad&\text{and}\quad
    \braket{ \phi | \phi } = 0
    \Leftrightarrow
    \ket{\phi}=0
&\text{（正定値性）}
\end{align}
を満たすものがあることを言う。
$\Big|\Big| \ket{\psi} \Big|\Big|^2
:= \braket{ \psi | \psi }$
を$\ket{\psi}$のnormという。
$2$つのvector $\ket{\psi},\ket{\phi}$の間の
内積が消える
$\braket{\psi | \phi} = 0$
とき、$\ket{\psi}$と$\ket{\phi}$は直交する（normalである）といい、
$\ket{\psi} \perp \ket{\phi}$などと書く。
例えば$0$は任意のvectorと直交する。
Hilbert空間とは内積空間であって完備な
（直感的には、極限が十分に存在する）
ものを言う。
物理学において時間発展は微分方程式で与えられるので、
微分を定義するために
極限が存在する必要があるのである。

量子力学において決定論的な時間発展方程式に従う力学自由度は
Hilbert空間の元である。
このHilbert空間を状態空間と言い、
その元を状態vectorと呼ぶ。
個々の状態vectorの
時間発展はSchr\"odinger方程式
\begin{align}
    i\hbar \dfrac{d}{dt}
        \ket{\psi(t)}
    &=
    \hat{H} \ket{\psi(t)}
\end{align}
によって与えられる。
ここで$\hbar$は換算Planck定数またはDirac定数と呼ばれ、
Planck定数$h$により
\begin{align}
    \hbar := \dfrac{h}{2\pi}
\end{align}
と定義される。
また、
$\hat{H}$は以下で定義する
Hamiltonian operatorである。

\subsubsection{正準交換関係（CCR: Canonical Commutation Relation）}

二つのoperator $\hat{A}, \hat{B}$の間の交換関係を
\begin{align}
    [\hat{A}, \hat{B}] := \hat{A} \hat{B} - \hat{B} \hat{A}
\end{align}
で定義し、$[\hat{A}, \hat{B}] = 0$であるとき
$\hat{A}, \hat{B}$は可換であるという。
全く同様に反交換を
\begin{align}
    \{\hat{A}, \hat{B}\} := \hat{A} \hat{B} + \hat{B} \hat{A}
\end{align}
で定義しておく。
量子力学を考えるまで、
あらゆる量は可換であった。
このように全ての量が可換である力学系を
古典力学系と言い、そこに現れる可換な数を$c$-数という。

任意の関数$F(a)$について、
演算子$\hat{x}$の関数$F(\hat{x})$を
（$a=0$周りの）Taylor展開により
\begin{align}
    F(\hat{x}) := \sum_{n=0}^\infty
        \dfrac{1}{n!}
        \dfrac{d^nF(a)}{da^n}\bigg|_{a=0}
        \hat{x}^n
\label{function of operator}
\end{align}
と定義する。
ある古典力学系のHamiltonian $H(\{q\},\{p\})$
が知られているとき、
その正準力学変数$\{q\},\{p\}$を
正準交換関係：
\begin{align}
    [ \hat{q}_i , \hat{p}_j ] = i\hbar \delta_{ij}
\end{align}
を満たすoperatorの組
$ \{\hat{q}\} , \{\hat{p}\} $
で置き換える手続きを正準量子化と呼び、
\begin{align}
    \hat{H}
    &:=
    H(\{\hat{q}\} , \{\hat{p}\})
\end{align}
を得られた量子力学系の
Hamiltonian operator
という。

厳密にはこれだけでは古典的Hamiltonian $H$が
例えば$qp$のような項を持っていたとき、それを
$\hat{p}\hat{q}$で置き換えるのか
$\hat{q}\hat{p} = \hat{p}\hat{q} + i\hbar$で置き換えるのか
といった問題は残る。
これを演算子順序の問題といい、
Hamiltonian operatorのHermiticityや
量子系の持つべき大域的対称性などから
一定の解答を与えることは出来るものの、
異なる演算子順序は物理的に異なる量子系を与えるため
一般に与えられた古典系に対して量子系を一意に定めることは出来ない。
ただし特定の文脈で自然な演算子順序は存在し、
このことは経路積分を扱う際により詳しく議論する。

\subsubsection{ObservablesとHermitian conjugate、Unitary operator}

任意のvector $\ket{\psi} \in \mathcal{H}$の
Hermitian conjugate（エルミート共役） $\ket{\psi}^\dagger$を
内積を使って
\begin{align}
    \ket{\psi}^\dagger
    :=
    \eta(\ket{\psi},\ )
\end{align}
により定め、$\bra{\psi}$とも書く。
元の空間の任意の元
$\ket{\phi} \in \mathcal{H}$
との内積が
\begin{align}
    \ket{\psi}^\dagger \ket{\phi}
    :=
    \braket{\psi|\phi}
    = \eta(\ket{\psi}, \ket{\phi})
    \in \mathbb{C}
\end{align}
のように複素数を与えるため、
内積の線形性から
$\bra{\psi}$は$\mathcal{H}$上の
線形汎関数と見做すことが出来、
Riesz representation theoremから
$\bra{\psi}$のなす集合$\mathcal{H}^*$は
$\mathcal{H}$の（位相的あるいは線形）双対空間となる。
Hilbert空間の元$\ket{\psi}$をket vector、
その双対空間の元$\bra{\psi}$をbra vectorという。

この定義の下でoperator $\hat{O}$の
Hermitian conjugate $\hat{O}^\dagger$も、
任意のvector $\ket{\psi}, \ket{\phi}$に対して
\begin{align}
    \bra{\psi}
    \hat{O}^\dagger
    \ket{\phi}
    =
    \ket{\psi}^\dagger
    \hat{O}^\dagger
    \ket{\phi}
    &:=
    \Big( \hat{O} \ket{\psi} \Big)^\dagger
    \ket{\phi}
    =
    \Big[
        \bra{\phi} \Big( \hat{O} \ket{\psi} \Big)
    \Big]^*
\end{align}
となるoperatorと定めることが出来る。
このようなoperatorが一意的に存在することも
Riesz representation theoremから保証される。

あるoperator $\hat{O}$が
Hermitian（自己共役、自己随伴）であるとは、
$\hat{O}$が
\begin{align}
    \hat{O} = \hat{O}^\dagger
\end{align}
を満たすことを言う。
量子力学におけるobservable（可換測量）は、
Hermitian operator で表される。

あるoperator $\hat{O}$の
inverse operator（逆演算子、逆作用素）
$\hat{O}^{-1}$
を
\begin{align}
    \hat{O}^{-1} \hat{O} \ket{\psi} &= \ket{\psi}
    \quad\text{for $\forall \ket{\psi}$}
\end{align}
で定義する。
あるoperator $\hat{U}$がunitaryであるとは、
$ \hat{U}^\dagger = \hat{U}^{-1} $
すなわち
\begin{align}
    \hat{U}^\dagger \hat{U} \ket{\psi} &= \ket{\psi}
    \quad\text{for $\forall \ket{\psi}$}
\end{align}
が成り立つことを言う。
例えば、時間発展operator
$\exp\left( \dfrac{ \hat{H}t }{i\hbar} \right)$
はunitary operatorの例である。

\subsubsection{固有状態とHermitian operator}

Operatorはvectorに作用して
再びvectorを与えるので、
ある$\hat{O}$に対し
$\ket{\psi} \neq 0$が存在して
\begin{align}
    \hat{O}\ket{\psi} \propto \ket{\psi}
,\quad\text{
    i.e.   
    $\exists \lambda\in\mathbb{C}$
    s.t.
}\quad
    \hat{O}\ket{\psi} = \lambda \ket{\psi}
\end{align}
となる特別な状況を考えることが出来る。
このとき、定数$\lambda$を$\ket{\psi}$の固有値（eigenvalue）と呼び、
状態vector $\ket{\psi}$は
$\hat{O}$の固有値$\lambda$に属する
固有vecctorまたは
固有状態（eigenstate）であると言う。
また、上の等式を固有方程式（特性方程式、永年方程式とも）という。

ある固有値$\lambda$に属する線形独立な
固有vectorが$n$個あるとき
$n$を$\lambda$の縮退度と呼び、
$n = 1$ならば縮退がない、
$n \ge 2$ならば$n$重縮退があるという。
固有値$\lambda$に属する固有vectorの集合は
vector spaceを為し、これを固有値$\lambda$に対する
固有空間という。

我々が特に興味があるのはobservableを表す
Hermitian operatorであるが、
$\hat{O} = \hat{O}^\dagger$のとき
$\lambda$が実数となること
\begin{align}
    &\lambda \braket{\psi | \psi}
    =
    \bra{\psi} \hat{O} \ket{\psi}
    = \bra{\psi} \hat{O}^\dagger \ket{\psi}
    = \left[ \bra{\psi} \hat{O} \ket{\psi}\right]^*
    = \lambda^* \braket{\psi | \psi}
\\
    &\lambda = \lambda^*
    \quad\because\quad
    \ket{\psi} \neq 0
\end{align}
および異なる固有値
$\lambda \neq \theta$
に属する固有vector
\begin{align}
    \hat{O} \ket{\psi} &= \lambda \ket{\psi} 
\\
    \hat{O} \ket{\phi} &= \theta \ket{\phi}
\end{align}
が直交すること
\begin{align}
    \lambda
    \braket{\psi|\phi}
    = 
    \lambda^*
    \braket{\phi|\psi}^*
    =
    \left[
        \bra{\phi} \hat{O} \ket{\psi}
    \right]^*
    &= \bra{\psi} \hat{O}^\dagger \ket{\phi}
    = \bra{\psi} \hat{O} \ket{\phi}
    = \theta \braket{\psi|\phi}
\\\therefore
    \braket{\psi|\phi}
    &=\braket{\psi|\phi}
    =0
\label{physically distinct states}
\end{align}
が示される。
例えば
$\hat{H}$の固有状態をenergy固有状態、
energy固有状態が持つ固有値をenergyというが、
任意のenergyは実数である。
また、特に最低energyに対応する固有vector
$\ket{0} \neq 0$は
真空（vacuum）、
それ以外のenergy固有状態は励起状態（excited state）というが、
真空と励起状態とは直交する。

\subsubsection{同時固有状態}

互いに可換な$n$個のoperator
$\hat{A}_1, \hat{A}_2, \dots, \hat{A}_n$
と、固有値$\lambda_i$に属する
$\hat{A}_i$の固有vector $\ket{\psi} \neq 0$
があるとしよう。
可換性$[\hat{A}_i, \hat{A}_j] = 0$から
\begin{align}
    \lambda_i \hat{A}_j \ket{\psi}
    &=
    \hat{A}_j \lambda_i \ket{\psi}
    =
    \hat{A}_j \hat{A}_i \ket{\psi}
    =
    \hat{A}_i \hat{A}_j \ket{\psi}
\end{align}
となるが、この式は
$\hat{A}_j \ket{\psi}$
が再び$\hat{A}_i$の固有値$\lambda_i$に対する
固有空間の元である事を意味する。
特に、縮退がない場合は
ある固有値
$\lambda_i$に属するvectorが定数倍を除いて一意に定まるため、
$\hat{A}_j \ket{\psi}$も
$\ket{\psi}$に比例しているはずである。
すなわち、$\ket{\psi}$は$\hat{A}_i$だけでなく
$\hat{A}_j$の固有vectorにもなっている。
$\lambda_i$に$m$重縮退がある場合でも、
固有空間の基底
$\ket{\psi_1}, \ket{\psi_2}, \dots, \ket{\psi_m}$
を適切に取ることにより
やはり全ての$\ket{\psi_k}$が
$\hat{A}_j$の固有vectorにもなるよう出来る事が示される
（ただし、$k$ごとに$\hat{A}_j$の固有値は
異なってよい）。

このように互いに可換なoperatorのうち一方の固有vectorが
同時に他方の固有vectorとなるように出来、
そのようなvectorを同時（simultaneous）固有vectorという。

\subsubsection{観測値とOperatorの関係、状態vectorの命名規則、物理的状態空間}

量子力学的な物理系の状態が
vector $\ket{\psi}$
で表されているとき、
物理量$\hat{A}$の期待値は
\begin{align}
    \braket{A} :=
    \dfrac{
        \bra{\psi} \hat{A} \ket{\psi}
    }{
        \braket{\psi|\psi}
    }
\end{align} 
と表される。
$\hat{A}$のspectral decompositionを
連続spectrum と点spectrum に分け、
対応するspectrumの固有空間への
projection operator $\hat{P}$を用いて
\begin{align}
    \hat{A} &=
    \sum_n { \hat{P}_n a_n }
    +
    \int d \hat{P} (a) a
\end{align}
のように書くと、
identity operatorとの関係
\begin{align}
    1 = 
    \sum_n \hat{P}_n
    +
    \int d \hat{P} (a)
\end{align}
を用いて
\begin{align}
    \ket{\psi} = 
    \sum_n \hat{P}_n \ket{\psi}
    +
    \int d \hat{P} (a) \ket{\psi}
\end{align}
が成り立つ。
実際に観測される結果は演算子$\hat{A}$の
固有値のいずれかであり、
全く同一の状態 vector $\ket{\psi}$で表される物理系を
十分多く用意したときの観測値は
\begin{enumerate}
    \item{点spectrum $a_n$に関しては確率
    $
    \dfrac{
        \bra{\psi} \hat{P}_n \ket{\psi}
    }{
     \braket{\psi|\psi}   
    }    
    $}
    \item{連続spectrum $a$に関しては確率密度
    $
    \dfrac{
        \bra{\psi} d \hat{P}(a) \ket{\psi}
    }{
     \braket{\psi|\psi}   
    }    
    $}
\end{enumerate}
で与えられるのである。

これらの規則を見ると、状態vector $\ket{\psi}$を
定数（たとえば$a \in \mathbb{C}$）倍だけ
再定義
$\ket{\psi} \mapsto a \ket{\psi}$
してもnormが伴って
$\braket{\psi|\psi} \mapsto |a|^2 \braket{\psi|\psi}$
と変化するため、
物理法則が予言する個々の観測量の期待値や確率は
一切変化しない事に気付くであろう。
実際vectorのnormは物理的情報を持っておらず、
従ってvector $\ket{\psi}$と$a \ket{\psi}$は
物理的に区別されるべき異なる状態ではない。
よって常に
$a = \dfrac{1}{\sqrt{ \braket{\psi|\psi} }}$
による再定義で$\braket{\psi|\psi} = 1$
としておくのが便利である。
このようなvectorの再定義を規格化（normalization）と言い、
以下では状態vectorは規格化されているものとする。
状態vectorを規格化してもなお、
$a=e^{i\theta}, \theta\in \mathbb{R}$
のような場合は$\ket{\psi}$と
$e^{i\theta}\ket{\psi}$は
独立な状態を表さない。
このようなoverallの位相も物理的情報を持たない
（もちろん複数のvectorの相対的な位相は意味を持つが）ため、
物理的状態は単にHilbert空間の元ではなく、
それらを規格化し、更に位相だけの違いは同一視した
射線（ray）と呼ばれるobjectにより表される。

物理的に区別できないvectorについては上のように述べたが、
更に我々は任意のoperatorについて同じ固有値を持つvectorは
どのような物理量ないし実験によっても区別できないため同じ状態と見做す。
物理的に明確に区別できる
（つまりあるHermitian operatorについて
異なる固有値を持つ）
状態を表す状態vector
は互いに直交する事を
(\ref{physically distinct states})
で示した。
一般にある量子系において、
線形独立なHermitian operatorのうち
可換に取れるもののmaximalな個数が$n$であるとき、
そのようなoperator
$\hat{O}_1,\hat{O}_2,\dots,\hat{O}_n$
の同時固有vectorは
（どのoperatorについて議論しているのか明らかな場合には）対応する固有値
$\lambda_1, \lambda_2, \dots , \lambda_n$を用いて
$\ket{\lambda_1, \lambda_2, \dots , \lambda_n}$
と名付けるのが普通であり、
このvectorに対応するrayが
（互いに独立な）物理的状態を表すのである。

改めてrayの集合を物理的状態空間あるいは単に状態空間（state space）
と呼ぶことにしよう。
ある物理的状態とそれを表すrayまたは状態vectorも区別せず、
これら全てを単に状態と呼ぶことにする。
以下で規格化などによる同一視を行わないHilbert空間を直接扱うことはなく、
そのため議論にvectorのnormが関わることもないので、
以前の用語との混乱は生じない。

\subsubsection{DiracのBracket記法}

これまでは$\ket{\psi}$のような記号を
単に状態vectorを表すものと扱っていたが、
Diracはこれを更に便利にする記法を導入した。
$\hat{A}$の固有値$a_n$に対する
固有vectorを$\ket{a_n}$と略記し、
固有空間に$m$重縮退がある場合には
適当な正規直交基底$\ket{a_n,i}(i=1,\dots,m)$を取る。
ここで、対応する固有空間へのprojection operatorを
\begin{align}
    \hat{P}_k &=: \sum_{i=1}^m \ket{a_n,i}\bra{a_n,i}
\\
    \hat{P}(a) &=: da \ket{a}\bra{a}
\end{align}
のように書くというのである。
なお数学的には連続spectrumに対して固有vectorは存在しないが、
上は単にspectral decompositionの略記法だと思えばよい。
点spetrumと連続spectrumとを形式的に区別せずに書けるため、
物理学者には非常に重宝がられている記法である。

\subsubsection{Hermitian operatorと完全性}

内積空間において、規格化されたvector
$\ket{e_1},\ket{e_2},\dots$
が互いに直交する
\begin{align}
    \braket{e_i | e_j} &= \delta_{ij}
\end{align}
場合、その集合を正規直交系（orthonormal system）という。
vectorが必ずしも規格化されていない場合は単に直交系(normal system)という。
あるHilbert空間$\mathcal{H}$の
互いに線形独立な元による正規直交系
$\ket{e_1},\ket{e_2},\dots$を取る。
任意のvector
$\ket{\psi} \in \mathcal{H}$が
\begin{align}
    \ket{\psi}
    &=\sum_n c_n \ket{e_n}
\end{align}
のように一意的に展開できる場合、
$\ket{e_n}$の集合を$\mathcal{H}$の正規直交完全系（orthonormal complete set）という。
ただし正規直交性から
\begin{align}
    c_n &=
    \sum_m c_m \delta_{nm} 
    =\sum_m c_m \braket{e_n|e_m}
    = \bra{e_n} \sum_m c_m \ket{e_m}
    = \braket{e_n | \psi}
\end{align}
が従うため、上の式は
\begin{align}
    \ket{\psi}
    &=\sum_n \ket{e_n} \braket{e_n | \psi}
    \quad\text{for $\forall \ket{\psi}$}
\\
\therefore
    1
    &=
    \sum _n \ket{e_n}\bra{e_n}
\end{align}
と書いても同じことである。
ここで$1$はidentity operatorを意味する。
等式はnormに関する収束
\begin{align}
    &\lim_{N\to\infty}\bigg|\bigg|
        \ket{\psi} - \ket{\psi_N}
    \bigg|\bigg|^2
    = 0
\\
    &\ket{\psi_N}
    :=
    \sum_{n=1}^N \ket{e_n} \braket{e_n | \psi}
\end{align}
を意味している。
完全系はvector spaceの基底の概念によく似ているが、
基底には必要ない内積という付加的な構造を定義に用いており、
特にvector spaceの基底は$n$について有限和しか許さないのに対し、
完全系は$n$についての無限和も許している点で相違している。

適当なHermitian operator
$\hat{O} = \hat{O}^\dagger$
が与えられたとき、
その全ての固有vector 
$\ket{\lambda_n}$の集合が完全系をなす事を仮定する。
これは、適当な状態$\ket{\psi}$のもとで
物理量$\hat{O}$を観測した際には、
必ず固有値$\lambda_n$のいずれかが
観測される必要があるためである。

\subsubsection{調和振動子の例、
    生成消滅演算子、
    Fock space}

$n$次元調和振動子を正準量子化してみよう。
$\{\hat{q}\}, \{\hat{p}\}$は可換測な物理量なのでHermitianであることを仮定しており、
\begin{align}
    \hat{H} &= \sum_{k=1}^n \bigg(
        \dfrac{ \hat{p}_k^2 }{2m} 
    +
        \dfrac{ m\omega^2 }{2} \hat{q}_k^2
    \bigg)
\\
    [ \hat{q}_i , \hat{p}_j ] &= i\hbar \delta_{ij}
\end{align}
から
$\hat{H}$のHermiticityも自然に従う。
公式(\ref{A,BC to B(A,C) + (A,B)C})を使って
\begin{align}
    [\hat{q}_i, \hat{H}] &= i\hbar \dfrac{ \hat{p}_i }{m} 
\\
    [\hat{p}_j, \hat{H}] &= - i \hbar\ m\omega^2 \hat{q}_j
\end{align}
が得られる。
これらが調和振動子の正準方程式
(\ref{hamiltonian e.o.m for harmonic oscillator})
に非常によく類似している事に注意しよう
（より詳しくは
(\ref{Heisenberg e.o.m})
を参照）。

このままでは議論を進めるのが難しいが、
必ずしもHermitianではない無次元量への
変数変換を考えることで見通しが良くなる。
生成消滅演算子（creation and annihilation operator。昇降(raising and lowering)演算子、はしご(ladder)演算子などとも言う）を
\begin{align}
    \hat{a}_i :=\ & 
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        +
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\\
    \hat{a}^\dagger_i =\ &
    \dfrac{1}{\sqrt{2\hbar}}
    \left(
        \sqrt{
            m\omega
        }\ \hat{q}_i
        -
        \dfrac{i}{\sqrt{m\omega}}
        \ \hat{p}_i
    \right)    
\end{align}
で定義しよう。
これは単に$\{\hat{q}\}, \{\hat{p}\}$から
$\{\hat{a}\}, \{\hat{a}^\dagger\}$への
線形変換であり、
逆変換は
\begin{align}
    \hat{q}_i &=
    \dfrac{1}{2}\sqrt{
        \dfrac{2\hbar}{m\omega}
    }
    \left(
        \hat{a}_i + \hat{a}^\dagger_i
    \right)
\\
    \hat{p}_i &=
    \dfrac{1}{2i}\sqrt{
        2\hbar m\omega
    }
    \left(
        \hat{a}_i - \hat{a}^\dagger_i
    \right)
\end{align}
で与えられる。

元の変数は容易に消去出来て
\begin{align}
    \hat{H}
%    &
    =
    \dfrac{ \hbar\omega }{ 2 }
    \sum_k
    \left(
        \hat{a}^\dagger_k\hat{a}_k
        +
        \hat{a}_k\hat{a}_k^\dagger
    \right)
%\\
    & 
    =
    \hbar\omega
    \sum_k
    \left(
        \hat{N}_k
        +
        \dfrac{ 1 }{ 2 }
    \right)
\\
    \hat{N}_k &:= \hat{a}^\dagger_k\hat{a}_k
\\
    [\hat{a}_i, \hat{a}^\dagger_j]
    &=\delta_{ij}
\label{creation annihilation operator}
\\
    [\hat{H},\hat{a}_i]
    &= - \hbar \omega \hat{a}_i
\label{annihilation operator}
\\
    [\hat{H},\hat{a}^\dagger_j]
    &= + \hbar \omega \hat{a}^\dagger_j
\label{creation operator}
\end{align}
が得られる。
ただし、
$k$番目の自由度のnumber operator
$\hat{N}_k$を定義した
（場の量子論の用語を流用して単に数演算子と呼ばれる事も多いが、
今の場合は粒子数ではなくenergy励起数を表す事に注意）。
適当なenergy固有状態$ \ket{\psi} \neq 0 $
\begin{align}
    \hat{H} \ket{\psi}
    &=
    E \ket{\psi}
\end{align}
が存在するとき、
状態$\hat{a}_i \ket{\psi}$に$ \hat{H} $
を作用させると
\begin{align}
    \hat{H} \bigg(
        \hat{a}_i \ket{\psi}
    \bigg) 
&=
    \left(
        \hat{a}_i \hat{H} 
    +
        \left[ \hat{H}, \hat{a}_i \right]
    \right) \ket{\psi}
\notag\\&=
    \left(
        \hat{a}_i E
    - \hbar \omega \hat{a}_i
    \right) \ket{\psi}
\notag\\&=
    \left(
        E - \hbar \omega
    \right)
    \hat{a}_i \ket{\psi}
\end{align}
が得られ、状態$\hat{a}_i \ket{\psi}$は
（もし$0$でないならば）
energy $E - \hbar \omega$に属する
energy固有vector
（ただし規格化されているとは限らない）
であることが分かる。
全く同様に
\begin{align}
    \hat{H} \bigg(
        \hat{a}^\dagger_i \ket{\psi}
    \bigg) 
&=
    \left(
        E + \hbar \omega
    \right)
    \hat{a}^\dagger_i \ket{\psi}
\end{align}
であり、
$\hat{a}^\dagger_i, \hat{a}_i$は
$i$番目の自由度のenergy levelを
enrgy量子$\hbar\omega$分だけ上下することが分かる。
これが生成消滅の名の所以である。

興味深いのは、$ \hat{H} $が
正定値なHilbert空間に作用しているという仮定のみから、
Hilbert空間にどのようなenergy固有状態が存在する（あるいはし得る）かの
情報が得られるということである。
$\hat{N}_i$同士は互いに可換なので、
その同時固有状態$\ket{N_1, N_2,\dots, N_n}$
を用意できる。
これは明らかに
$ \hat{H} = \hbar\omega
\sum_k
\left(
    \hat{N}_k
    +
    \dfrac{ 1 }{ 2 }
\right) $
の固有状態でもあり、
$\hat{a}^\dagger_i, \hat{a}_i$が
$\hat{N}_i$のみの固有値を$1$だけ上下する事も
上の議論から明らかであろう。
この状態$\ket{N_1, N_2,\dots, N_n}$によって
$\hat{N}_i$の期待値を取ると
\begin{align}
    N_i &=
    \bra{N_1, N_2,\dots, N_n} N_i \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \bra{N_1, N_2,\dots, N_n} \hat{N}_i \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \bra{N_1, N_2,\dots, N_n}     
    \hat{a}^\dagger_i\hat{a}_i
    \ket{N_1, N_2,\dots, N_n}
\notag\\&=
    \Big|\Big|
        \hat{a}_i \ket{N_1, N_2,\dots, N_n}
    \Big|\Big|^2 \ge 0
\end{align}
が導かれる。
最後の不等式は単に内積の正定値性から要求されるのだが、
最初に気が付くことは$N_i = 0$のときには内積の正定値性から
真空条件：
\begin{align}
    \hat{a}_i \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n} = 0
\label{vacuum of number operator}
\end{align}
が成り立つことである。
それ以外の固有値$N_i\neq0$に属する状態に$\hat{a}_i$を掛けて得られるvectorはnormが非$0$となるため、
正定値性はこのvectorが$0$ vectorにはなり得ない事
$    \hat{a}_i \ket{N_1, N_2,\dots, N_i \neq 0,\dots, N_n} \neq 0$
も保証する。
また、$0<N_i<1$が存在するとすると
$\hat{a}_i$によって$\hat{N}_i$の固有値を下げたとき
\begin{align}
    \bra{N_1, N_2,\dots, N_n}
        \hat{a}_i^\dagger \hat{N}_i \hat{a}_i
    \ket{N_1, N_2,\dots, N_n}
    &\propto
    N_i - 1 < 0
\end{align}
となり、（比例係数は単にvector
$\hat{a}_i \ket{N_1, N_2,\dots, N_n}$
の規格化から出る正の定数であるため）
正定値性から導かれる不等式に矛盾してしまう。
同様に適当な$p\in\mathbb{N}_+$に対し
$p<N_i<p+1$が存在するときも$\hat{a}_i$を$p+1$回以上作用させれば
正定値性の不等式に矛盾する結果が得られるので、
$\hat{N}_i$の任意の固有値は（存在するならば）非負整数であること、
$N_i = 0$の状態に対しては真空条件から
それ以下の固有値と固有状態を作れないことが分かる。
すなわち$\forall\ i$について$N_i \in \mathbb{N}_{\ge 0}$であり、
energy固有値はこれらを用い
\begin{align}
    E = \hbar\omega
    \left(
    \sum_{k=1}^n
        N_k
    +
        \dfrac{ n }{ 2 }
    \right)
\end{align}
と表されることが内積の正定値性のみから導かれたのである。
なお$N = \sum_k N_k$とおくと
真空は$N=0$に対応し、
下から$N+1$番目のenergy準位
$E = \hbar \omega \left(N + \dfrac{n}{2} \right) $
の縮退度$\mathrm{deg}(N)$は
上式を満たす非負整数$(N_1, N_2,\dots, N_n)$の組の数、つまり
\begin{align}
    \mathrm{deg}(N)
    &=
    {}_{N + n-1}C_{N}
    =
    \dfrac{(N+n-1)!}{N!\ (n-1)!}
\end{align}
である。

さて、$\hat{N}_i$の固有値は（存在するならば）非負整数であり、
これらの同時固有状態がHamiltonian $\hat{H}$の
固有状態を与える事は分かった。
上の議論から得られるもう一つの非自明な条件である
真空条件
(\ref{vacuum of number operator})
を用いて、今度はその固有状態について議論しよう。
既に説明したように物理的状態は
線形独立で可換なHermitian operatorをmaximalな個数だけ取ってきたとき、
それらの同時固有状態として区別される。
$n$次元調和振動子の例では
$n$個のnumber operator $\hat{N}_i$がその可換な組を与えるから、
適当な同時固有状態
$\ket{N_1, N_2,\dots, N_n}$
が少なくとも$1$つ存在することは仮定する。
これが存在すれば、
昇降演算子によって任意の非負整数固有値
$N_i\pm n_i$に属する固有状態
\begin{align}
    \ket{N_1, N_2,\dots,N_i+n_i,\dots, N_n}
    &\propto
    \left(
        \hat{a}_i^\dagger
    \right)^{n_i}
    \ket{N_1, N_2,\dots, N_n}
\\
    \ket{N_1, N_2,\dots,N_i-n_i,\dots, N_n}
    &\propto
    \Big(
        \hat{a}_i
    \Big)^{n_i}
    \ket{N_1, N_2,\dots, N_n}
\end{align}
が構成できる事は明らかであろう
（$N_i\pm n_1= 0$でない限りこれらのvectorが$0$ vectorとならないことは既に説明した）。
この規格化定数を、
最低固有値$N_i = 0$に属する状態について
\begin{align}
    \hat{a}_i \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n} = 0
\\
    \braket{N_1, N_2,\dots, N_i = 0,\dots, N_n
    |
    N_1, N_2,\dots, N_i = 0,\dots, N_n}
    &=1
\end{align}
が成り立つという条件から計算してみよう。

一般の状態を
規格化定数$A_{n_i}$を用いて
\begin{align}
    \ket{N_1, N_2,\dots,N_i=n_i,\dots, N_n}
    &=
    A_{n_i}
    \left(
        \hat{a}_i^\dagger
    \right)^{n_i}
    \ket{N_1, N_2,\dots,
    N_i = 0,
    \dots, N_n}
\end{align}
と書くと、$n_i = 1$の場合には規格化条件
\begin{align}
    1 &=
    \braket{
        N_1, N_2,\dots,N_i = 1,\dots, N_n
        |
        N_1, N_2,\dots,N_i = 1,\dots, N_n
    }
\notag\\&=
    |A_1|^2
    \bra{N_1, N_2,\dots, N_i = 0,\dots, N_n}
    \hat{a}_i
    \hat{a}_i^\dagger
    \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n}
\notag\\&=
    |A_1|^2
    \bra{N_1, N_2,\dots, N_i = 0,\dots, N_n}
    \bigg(
        \hat{a}_i^\dagger
        \hat{a}_i
        +
        [
        \hat{a}_i
        ,
        \hat{a}_i^\dagger
        ]
    \bigg)
    \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n}
\notag\\&=
    |A_1|^2
    \bra{N_1, N_2,\dots, N_i = 0,\dots, N_n}
    \bigg(
        \hat{N}_i
        +
        1
    \bigg)
    \ket{N_1, N_2,\dots, N_i = 0,\dots, N_n}
\notag\\&=
    |A_1|^2
    \bigg(
        N_i
            \Big|_{N_i=0}
        +
        1
    \bigg)
\end{align}
を課すことで
$|A_1|^2 = 1$が求まる。
一般の$n_i$の場合も
全く同じ議論を繰り返すことで
\begin{align}
    1 &=
    \braket{
        N_1, N_2,\dots,N_i = n_i + 1 ,\dots, N_n
        |
        N_1, N_2,\dots,N_i = n_i + 1 ,\dots, N_n
    }
\notag\\&=
    \dfrac{
        |A_{n_i + 1}|^2
    }{
        |A_{n_i}|^2
    }
    \bra{N_1, N_2,\dots, N_i = n_i ,\dots, N_n}
    \hat{a}_i
    \hat{a}_i^\dagger
    \ket{N_1, N_2,\dots, N_i = n_i ,\dots, N_n}
\notag\\&=
    \dfrac{
        |A_{n_i + 1}|^2
    }{
        |A_{n_i}|^2
    }
    \bigg(
        N_i
            \Big|_{N_i=n_i}
        +
        1
    \bigg)
\\\therefore\qquad
    |A_{n_i + 1}|^2 &= 
    \dfrac{1}{
        n_i + 1
    }
    |A_{n_i}|^2
\end{align}
なる漸化式が得られ、
その解は
$|A_{n_i}|^2 = \dfrac{1}{n_i!}$
と求まる。
状態vectorのoverallの位相は情報を持たないのであったから
$A_{n_i} \in \mathbb{R}_{>0}$と取っても一般性を失わず、
一般の規格化された状態vectorが
ただ一つの真空vector
$\ket{N_1 = 0, N_2 = 0 ,\dots,
N_i = 0,
\dots, N_n = 0}$
を用いて
\begin{align}
    \ket{N_1, N_2,\dots,N_i,\dots, N_n}
    &=
    \dfrac{
        \left(
            \hat{a}_i^\dagger
        \right)^{N_i}
    }{\sqrt{N_i!}}
    \ket{N_1, N_2,\dots,
    N_i = 0,
    \dots, N_n}
\notag\\\therefore
    \ket{N_1, N_2,\dots,N_i,\dots, N_n}
    &=
    \prod_{i=1}^n
    \left(
        \dfrac{
            \left(
                \hat{a}_i^\dagger
            \right)^{N_i}
        }{\sqrt{N_i!}}
    \right)
    \ket{N_1 = 0, N_2 = 0 ,\dots,
    N_n = 0}
\end{align}
と求まるのである。
なお、このような真空とそこからの励起で書かれるvectorが張る
vector spaceをFock spaceと呼ぶ。

\subsubsection{Coherent state}

量子力学では全てのobservableは
Hermitian operatorであったので、
基本的にはその固有状態に興味があった。
時にはnon-Hermitian operatorの固有状態も
興味深い性質を持つので、
$1$自由度の調和振動子系で
$\hat{a}^\dagger, \hat{a}$の固有状態を例に取り
その性質を調べてみよう。
$n$自由度系への拡張は上の議論から容易である。

調和振動子のcoherent状態を
\begin{align}
    \ket{\alpha}
    &:= 
    \dfrac{1}{A}
    \exp(\alpha \hat{a}^\dagger)
    \ket{0}
\end{align}
で定義する。$A$は規格化定数で、後で定める。
$\hat{a}^\dagger, \hat{a}$の交換関係
(\ref{creation annihilation operator})から
(\ref{differential by commutator})
を導くのと全く同じ議論を繰り返せて
\begin{align}
    [\hat{a},\hat{a}^\dagger]
    &= 1
\notag\\
    C_{n+1}
    &:=
    [\hat{a},\left(\hat{a}^\dagger\right)^{n+1}]
\notag\\
    &=
    \hat{a}^\dagger
    [\hat{a},\left(\hat{a}^\dagger\right)^{n}]
    +
    [\hat{a},\hat{a}^\dagger]
    \left(\hat{a}^\dagger\right)^{n}
\notag\\
    &= \hat{a}^\dagger C_n
     + \left(\hat{a}^\dagger\right)^{n}
\notag\\
    \therefore\quad
    [\hat{a},\left(\hat{a}^\dagger\right)^{n+1}]
    &=
    C_{n+1} = 
    (n+1) \left(\hat{a}^\dagger\right)^{n}
\end{align}
が成り立つので、
$\displaystyle
\exp(\alpha \hat{a}^\dagger) 
=
\sum_{n=0}^\infty
\dfrac{
    \left(\alpha \hat{a}^\dagger\right)^n
}{n!} 
$
との間には
\begin{align}
    [ \hat{a}, \exp(\alpha \hat{a}^\dagger) ]
&=
    \sum_{n=1}^\infty
    \dfrac{
        \alpha^n 
    }{n!} 
    n \left(\hat{a}^\dagger\right)^{n-1}
%\notag\\&
=
    \sum_{n=1}^\infty
    \dfrac{
        \alpha^n 
    }{(n-1)!} 
    \left(\hat{a}^\dagger\right)^{n-1}
\notag\\&=
    \alpha
    \sum_{n=0}^\infty
    \dfrac{
        \alpha^n 
    }{n!} 
    \left(\hat{a}^\dagger\right)^{n}
%\notag\\&=
=
    \alpha
    \exp(\alpha \hat{a}^\dagger)
\label{coherent commutator}
\end{align}
なる交換関係が成り立つ。
真空条件を用いるとcoherent stateは
\begin{align}
    \hat{a}
    \ket{\alpha}
    &= 
    \dfrac{1}{A}
    \bigg(
        \exp(\alpha \hat{a}^\dagger)
        \cancel{ \hat{a} }
        +
        [ \hat{a} , \exp(\alpha \hat{a}^\dagger) ]
    \bigg)
    \ket{0}
\notag\\ &=
    \dfrac{1}{A}
    \alpha\exp(\alpha \hat{a}^\dagger)
    \ket{0}
\notag\\ &=
    \alpha
    \ket{\alpha}
\end{align}
を満たし、
$\hat{a}$の固有値$\alpha$に属する固有状態であることが分かる。
$\hat{a}$がnon-Hermitianであることに対応して、
$\alpha$は実数ではなく任意の複素数でよい事に注意しよう。

規格化定数は
\begin{align}
    1
    &=
    \braket{ \alpha | \alpha }
    =
    \dfrac{1}{A^*}    
    \bra{0}
    \exp(\alpha^* \hat{a})
    \ket{\alpha}
    =
    \dfrac{1}{A^*}    
    \bra{0}
    \exp(\alpha^* \alpha)
    \ket{\alpha}
\notag\\&=
    \dfrac{
        \exp( |\alpha|^2 )
    }{|A|^2}
    \bra{0}
    \exp(\alpha \hat{a}^\dagger)
    \ket{0}
\notag\\&=
    \dfrac{
        \exp( |\alpha|^2 )
    }{|A|^2}
\notag\\&=
    \dfrac{
        \exp( |\alpha|^2 )
    }{|A|^2}
\end{align}
最後の等式では、真空条件
$\bra{0}\hat{a}^\dagger = 0$
および真空が規格化されていること
$\braket{0|0}=1$
を用いた。
規格化定数が正の実数
$A = \exp\left( \dfrac{1}{2} |\alpha|^2 \right)$
になるよう位相を選んで一般性を失わないので、
規格化されたcoherent stateは
\begin{align}
    \ket{\alpha}
    &=
    \exp\left( -\dfrac{1}{2} |\alpha|^2 \right)
    \exp(\alpha \hat{a}^\dagger)
    \ket{0}
\end{align}
と書けることが分かる。

\subsubsection{Displacement operator}

上で定義したcoherent stateは、
displacement operator $D(\alpha)$を
\begin{align}
    D(\alpha) &:=
   \exp(
        \alpha\hat{a}^\dagger
        - \alpha^* \hat{a}
    )
\end{align}
で定義するとより系統的に扱うことが出来る。
$[\hat{a}, \hat{a}]=0$であるので、
交換関係
(\ref{coherent commutator})
を証明したのと全く同じ方法で
\begin{align}
    [\hat{a},\left(
        \alpha\hat{a}^\dagger
        - \alpha^* \hat{a}
    \right)^{n+1}]
    &=
    \alpha
    (n+1) \left(
        \alpha\hat{a}^\dagger
        - \alpha^* \hat{a}
    \right)^{n}
\\\therefore\quad
    [\hat{a}, D(\alpha) ]
    &=
    \alpha D(\alpha)
\end{align}
が証明でき、
状態$D(\alpha)\ket{0}$もまた
$\hat{a}$の固有値$\alpha$に属する固有状態
\begin{align}
    \hat{a} D(\alpha)\ket{0}
    &=
    \alpha D(\alpha)\ket{0}
\end{align}
であることが分かる。

このdisplacement operatorはunitaryである
\begin{align}
    D(\alpha)^\dagger D(\alpha) &= 
    \exp(
        \alpha^* \hat{a}
        - \alpha \hat{a}^\dagger
    )
    \exp(
        \alpha\hat{a}^\dagger
        - \alpha^* \hat{a}
    )
\notag\\&=
    \exp\Big(
        - (
        \alpha \hat{a}^\dagger
        -
        \alpha^* \hat{a}
        )
    \Big)
    \exp(
        \alpha\hat{a}^\dagger
        - \alpha^* \hat{a}
    )
\notag\\&=
    1
\end{align}
ため状態$D(\alpha)\ket{0}$は規格化されており、
実際に
$[
    \alpha \hat{a}^\dagger,
     - \alpha^* \hat{a}
]
= |\alpha|^2$から
BCH formulaの特別な場合
(\ref{simpler BCH formula})
が使えて
\begin{align}
    D(\alpha) &= \exp\left(
        - \dfrac{1}{2}|\alpha|^2
    \right)
    \exp(\alpha \hat{a}^\dagger)
    \exp( - \alpha^* \hat{a})
\\
    \ket{\alpha} &= D(\alpha) \ket{0}
\end{align}
であることが証明できる。
ただし最後の等式は真空条件$\hat{a}\ket{0}=0$から従う。
