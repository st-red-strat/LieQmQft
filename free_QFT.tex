\section{自由場の量子論}
\label{sec: QFT}

場の量子論と言うとFeynman diagram
（古くはFeynman graphと呼ぶ文献もある）を使った計算に
皆さん憧れているのだろうが、
これは摂動計算に現れるものである。
摂動論は問題を解ける部分とそこからのズレに分けて
解析するというものであったので、
とにかく解ける理論がないと話にならない。
可解な場の量子論もそれ自身興味深い話題ではあるものの、
以下では解ける模型として非相対論的な場合から始め、
相対論的な場まで含めた自由場の量子化を扱う。

\subsection{自由場の古典論、場の解析力学}

以下では場の解析力学を学ぶ。
あくまでも量子論ではなく古典論であるため、
Lagrangianから運動方程式（Euler-Lagrange方程式）を導出できることも、
それ等価なHamiltonの正準方程式を
Hamiltonianから得られることも
質点の解析力学と違いはない。
ただし量子論を展開するためには
Hamiltonianが必要である一方で、
HamiltonianはLorentz vectorの第0成分であり、
Lorentz対称性を顕わに保つにはHamilton形式は不便である。
従ってまずは理論をLorentz scalarであるLagrangianで指定し、
Hamiltonianはその都度計算するのが普通である。
あるいは、Hamiltonianを一切用いず
Lagrangianしか現れない経路積分で量子化するのも
有効な手段だ。

いずれにせよ、
我々はvector場の持つ非物理的な自由度
（gauge自由度）により
その解析力学を拘束系として取り扱わなければならない事を見るであろう。
これは量子論に移行しても同じことで、
gauge対称性が理論に現れうる相互作用の形を
非常に強く制限すること、
またscalar場などに比べてその量子化が困難な原因も
同じくgauge対称性にあることが分かるはずだ。

\subsubsection{場のLagrangianとLagrange形式}

量子化するというからには
量子化される対象となる古典論を用意する必要がある。
空間$d$次元、時間$1$次元の$D:= d+1$次元時空$\mathcal{M}^{1,d}$を考え、
その座標を$(t, x^1,\dots, x^d)$とする。
時空$\mathcal{M}^{1,d}$上で定義された
適当な場$\phi(t, \bm{x})$と
その空間微分または時間微分
（上付き添え字の変数$x^\mu$による微分
$\partial_\mu$が下付き添え字を持つことに注意せよ）
\begin{align}
    \partial_\mu \phi(\bm{x})
    ,\quad
    \partial_\mu := \dfrac{\partial}{\partial x^\mu}
    \quad
    (\mu = 0,\dots,d)
    ,\quad
    x^0 := c t
    \quad
    \text{(c: the speed of light in vacuum)}
\end{align}
で書かれたLagrangian $L$を用意しよう。
力学自由度が空間の一点に局在している質点とは異なり、
場は空間的に広がりを持った自由度であるので
その相互作用の仕方も質点の場合とは大きく異なる。
物理学では経験的事実として
\begin{enumerate}
    \item{causality（因果律）：原因より先に結果が起こってはいけない}
    \item{locality（局所性）：遠く離れた地点で起こった事象が、直ちに他の地点の事象に影響を与えてはいけない。
    つまり、情報が速度無限大で伝わってはいけない}
\end{enumerate}
を仮定するので、
ある時刻$t$の物理量と別の時刻$t-t_0$とが直接相互作用すること、つまり
Lagrangianに$\phi(t) \psi(t-t_0)$のような項が現れることを禁止する。
Lagrangianに、例えば
\begin{align}
    \sqrt{\left(\dfrac{
        m c
    }{
        \hbar
    }\right)^2 + A^{\mu \nu}\partial_\mu \partial_\nu}
    \ \phi(t,\bm{x})
&=
    \dfrac{ m c }{ \hbar }
    \sqrt{
        1 + \left(\dfrac{ \hbar }{ m c }\right)^2
        A^{\mu \nu}\partial_\mu \partial_\nu
    }
    \ \phi(t,\bm{x})
\notag\\&= \dfrac{ m c }{ \hbar }
    \sum_{n=0}^\infty
    c_n
    (A^{\mu \nu}\partial_\mu \partial_\nu)^n
    \ \phi(t,\bm{x})
\notag\\&
\text{($A^{\mu\nu}$: a dimensionless matrix,  $c_n$: constants)}
\end{align}
のような無限階の微分を含めることも
localityを破るため禁止する。
operatorの関数がTaylor展開で与えられていた事を思い出そう。

さて、上のようなlocalityの制約により、
Lagrangianは時空上$\mathcal{M}^{1,d}$の
各点$(t, \bm{x})$の情報の和ないし積分で書ける筈である。
この局所的な情報をLagrangian密度と言い、
$\mathcal{L}$と書く。
用語の乱用であるが、
Lagrangian密度のことをLagrangianと呼ぶ事も多い。
当然Lagrangianは$L := \int d^d x \mathcal{L}$、
作用は$S= \int dt L = \int d^D x \mathcal{L}$である。
場の変分$\phi \mapsto \phi + \delta \phi$のもとで
作用の変分は
\begin{align}
    \delta S
    &=
    \int d^D x
    \left[
        \mathcal{L}(\phi + \delta \phi ,
        \partial \phi + \partial (\delta \phi))
        - \mathcal{L}
    \right]
\notag\\&=
    \int d^D x
    \left[
        \delta \phi
        \dfrac{\partial \mathcal{L}}
            {\partial \phi}
        +
        \partial_\mu (\delta \phi)
        \dfrac{\partial \mathcal{L}}
            {\partial (\partial_\mu \phi)}
    \right]
\notag\\&=
    \int d^D x
    \ 
    \delta \phi
    \left[
        \dfrac{\partial \mathcal{L}}{\partial \phi}
        -
        \partial_\mu
        \dfrac{\partial \mathcal{L}}{\partial (\partial_\mu \phi)}
    \right]
    + \text{(surface term)}
\end{align}
であり、作用の停留条件$\delta S = 0$から
場のEuler-Lagrange方程式は
\begin{align}
    0 &=
    \dfrac{\partial \mathcal{L}}
        {\partial \phi}
    -
    \partial_\mu
    \dfrac{\partial \mathcal{L}}
        {\partial (\partial_\mu \phi)}
\label{field EL eq}
\end{align}
と導かれる。

\subsubsection{Free Scalar場の例}

$\phi(t, \bm{x}), \varphi(t, \bm{x})$を
それぞれ実および複素scalar場とし、
Lagrangianを
\begin{align}
    \mathcal{L}_{\rm real}
    &:=
    -
    \dfrac{ \eta^{\rho\sigma} }{2}
        \partial_\rho \phi
        \partial_\sigma \phi
    -
    \dfrac{m^2}{2} \phi^2
\label{free real scalar lagrangian}
\\
    \mathcal{L}_{\rm complex}
    &:=
    -
    \eta^{\rho\sigma}
        \partial_\rho \varphi^*
        \partial_\sigma \varphi
    -
    m^2 |\varphi|^2
\label{free complex scalar lagrangian}
\end{align}
で与える。
ここで$\eta$は無次元の実定数対称行列である。

Lagrangianや運動方程式に$\phi, \varphi$自身しか現れないため
これらの理論で$\phi, \varphi$は
他の場と相互作用をしていないことが分かり、
特にLagrangianが$\phi, \varphi$の$3$次以上の項
（自己相互作用項、self-interaction term）
を持たないため
下記の運動方程式は$\phi, \varphi$について$1$次、
つまり線形となる。
このような線形微分方程式はFourier変換などを用いて
容易に解くことが出来るため、
このようにLagrangianに場の$2$次までの項しか現れない理論を
free field theory（自由場の理論）という。
自由場の理論の場合、Lagrangianに場の$1$次の項があっても
適切に平方完成し場を再定義する事により
上のLagrangianに帰着することが出来る。
Lagrangian中の場の$2$次の項をmass term（質量項）、
その係数に現れる$|m| > 0$を場の質量と呼ぶ。

これらの運動方程式(\ref{field EL eq})は
d'Alembert operator
（ダランベール演算子、
d'Alembertian、ダランベルシアン、
古い文献ではd'Alemberian、ダランベーリアンとも）
$\Box := \eta^{\mu \sigma}
    \partial_\mu
    \partial_\sigma$
を用いて
\begin{align}
    0 &=
    \dfrac{\partial \mathcal{L}_{\rm real}}
        {\partial \phi}
    -
    \partial_\mu
    \dfrac{\partial \mathcal{L}_{\rm real}}
        {\partial (\partial_\mu \phi)}
    =
    - \dfrac{m^2}{2}2 \phi
    -
    \partial_\mu
    \left[
        -
        \dfrac{ \eta^{\rho \sigma} }{2}
        \left(
            \delta_\rho^\mu
            \partial_\sigma \phi
        +
            \partial_\rho \phi
            \delta_\sigma^\mu
        \right)
    \right]
\notag\\&
    =
    - m^2 \phi
    +
    \partial_\mu
    \left[
        \dfrac{
            \eta^{\mu \sigma}
            \partial_\sigma \phi
        +
            \eta^{\rho \mu}
            \partial_\rho \phi
        }{2}
    \right]
    =
    - m^2 \phi
    +
    \eta^{\mu \sigma}
        \partial_\mu
        \partial_\sigma
    \phi
\notag\\&
    =
    (\Box - m^2) \phi
\label{free real scalar eom}
\end{align}
および
\begin{subequations}
\begin{align}
    0 &=
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial \varphi^*}
    -
    \partial_\mu
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial (\partial_\mu \varphi^*)}
    =
    -
    m^2 \varphi
    -
    \partial_\mu
    \left(
        -
        \eta^{\rho\sigma}
        \delta_\rho^\mu
        \partial_\sigma \varphi        
    \right)
\notag\\&
    =
    -
    m^2 \varphi
    +
    \eta^{\mu\sigma}
        \partial_\mu
        \partial_\sigma
        \varphi
    =
    (\Box - m^2)
    \varphi
\\
    0 &=
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial \varphi}
    -
    \partial_\mu
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial (\partial_\mu \varphi)}
    =
    (\Box - m^2)
    \varphi^*
\end{align}
\label{free complex scalar eom}
\end{subequations}
と得られる。

$\eta$を
(\ref{mostly plus minkowski metric})
で与え、運動方程式を実際にFourier変換で解くと

\subsubsection{Massive Free Vector場の例}

$\eta_{\mu\nu}$を無次元の実定数対称行列、
$\eta^{\mu\nu}$をその逆行列
$\eta_{\mu\lambda} \eta^{\lambda \nu} = \delta_\mu^\nu$として、
vector場$A^\mu$に対し
$A_\mu := \eta_{\mu\nu} A^\nu$
および
場の強さテンソル
（field strength tensor）
$F_{\mu\nu} :=
\partial_\mu A_\nu
- \partial_\nu A_\mu$
を定義する。
明らかに、一度添え字を下げたvector $A_\nu$の
添え字を逆行列$\eta^{\mu\nu}$で上げると元に戻る
\begin{align}
    \eta^{\mu\nu} A_\nu
    =
    \eta^{\mu\nu} \eta_{\nu \rho} A^\rho
    =
    \delta^\mu_\rho A^\rho
    =
    A^\mu
\end{align}
ため、以下では任意のvectorおよびtensorについて
同様に添え字の上げ下げを$\eta$で行う。
Lagrangianを
\begin{align}
    \mathcal{L}_{\rm massvec}
    :=
    -
    \dfrac{1}{4}
        \eta^{\mu\rho}
        \eta^{\nu\sigma}
    F_{\mu\nu} F_{\rho\sigma}
    -
    \dfrac{m^2}{2}
        \eta_{\mu \nu}
        A^\mu A^\nu
=
    - \dfrac{1}{4}
    F_{\mu\nu} F^{\mu\nu}
    -
    \dfrac{m^2}{2}
        A^\mu A_\mu
\end{align}
で与えるとき、
\begin{align}
    \dfrac{\partial}
        {\partial (\partial_\sigma A_\rho)}
    F_{\mu\nu}
    &=
    \dfrac{\partial}
        {\partial (\partial_\sigma A_\rho)}
    \left[
        \partial_\mu A_\nu
        - \partial_\nu A_\mu
    \right]
    =
    \delta_\mu^\sigma
    \delta_\nu^\rho
    -
    \delta_\nu^\sigma
    \delta_\mu^\rho
\\
    F_{\mu\nu} &= - F_{\nu\mu}
\end{align}
に気を付けると
Euler-Lagrange方程式(\ref{field EL eq})は
\begin{subequations}
\begin{align}
    0
    &=
    \dfrac{\partial \mathcal{L}_{\rm massvec}}
        {\partial A_\rho}
    -
    \partial_\sigma
    \dfrac{\partial \mathcal{L}_{\rm massvec}}
        {\partial (\partial_\sigma A_\rho)}
    =
    -
    \dfrac{m^2}{2}
        \eta_{\mu \nu}
        \left(
            A^\mu \eta^{\nu\rho}
        +
            \eta^{\mu\rho} A^\nu
        \right)
    -
    \partial_\sigma
    \dfrac{\delta}
        {\delta (\partial_\sigma A_\rho)}
        \left[
            - \dfrac{1}{4}
            F_{\mu\nu} F^{\mu\nu}
        \right]
\notag\\&
    =
    -
    \dfrac{m^2}{2}
        \left(
            A^\mu \delta_\mu^{\rho}
        +
            \delta_{\nu}^\rho A^\nu
        \right)
    +
    \dfrac{1}{4}
    \partial_\sigma
    \bigg\{
        F_{\mu\nu}
        \left[
            \eta^{\mu \sigma}
            \eta^{\nu \rho}
        -
            \eta^{\nu\sigma}
            \eta^{\mu \rho}
        \right]
    +
        \left[
            \delta_\mu^\sigma
            \delta_\nu^\rho
            -
            \delta_\nu^\sigma
            \delta_\mu^\rho        
        \right]
        F^{\mu\nu}
    \bigg\}
\notag\\&
    =
    -
    m^2
    A^\rho
    +
    \dfrac{1}{4}
    \partial_\sigma
    \bigg\{
        F^{\sigma\rho}
    -
        F^{\rho\sigma}
    +
        F^{\sigma\rho}
    -
        F^{\rho\sigma}
    \bigg\}
=
    -
    m^2
    A^\rho
    +
    \partial_\sigma
        F^{\sigma\rho}
\\&
=
    -
    m^2
    A^\rho
    +
    \Box A^\rho
    -
    \eta^{\rho \lambda}
    \partial_\sigma \partial_\lambda
    A^\sigma
=
    \bigg[
        \delta^\rho_\sigma
        (\Box - m^2)
    -
        \eta^{\rho \lambda}
        \partial_\lambda
        \partial_\sigma
    \bigg]
    A^\sigma
\label{free massive vector field EL eq}
\end{align}
\end{subequations}
と得られる。

特に、$F_{\mu\nu}$は
gauge transformation（ゲージ変換）
$A'^\mu = A^\mu + \partial^\mu \Lambda$
のもとで不変
\begin{align}
    F'_{\mu\nu}
&=
    \partial_\mu A'_\nu
    -
    \partial_\nu A'_\mu
=
    \partial_\mu (A_\nu + \partial_\nu \Lambda)
    -
    \partial_\nu (A_\mu + \partial_\mu \Lambda)
\notag\\&
=
    \partial_\mu A_\nu
    -
    \partial_\nu A_\mu
    + (
        \partial_\mu \partial_\nu
    -
        \partial_\nu \partial_\mu
    )\Lambda
=
    F_{\mu\nu}
\label{gauge invariance of vector field strength}
\end{align}
である事に注意しよう。
従って作用が$F_{\mu\nu}$のみを使って書かれる
massless $m^2 = 0$の場合のみ
作用および運動方程式はgauge symmetry
（ゲージ対称性）を持つ。
逆の言い方をすると、
理論の作用がgauge symmetryを持つよう要請する場合
vector場はmassを持てないことが分かる。

更に興味深い事実として、
$F_{\mu \nu}$の反対称性からも明らかなことだが
この運動方程式は$A^0$の
$x^0 = ct$による$2$階微分を含まない。
これは$A^0$という変数が
実は物理的な自由度ではない事を暗示している。
実際、
作用がgauge不変でない場合$m^2 \neq 0$は
$A^0$やその空間微分は$A^i$を使って書けてしまうし、
作用がgauge不変である場合$m^2 = 0$には
この運動方程式の任意の解は
$\Lambda =
    - \int_{t_0}^t dt'
        A^0(t', \bm{x})$
と取るgauge変換によって
temporal gauge $A^0 = 0$
に移り変わる事が出来る。

このように$A^0$という非物理的な自由度が
Lagrangianに現れる事により
vector場を含む系は一般に拘束系となり、
その量子化はscalar場の場合と比べて
格段に複雑になる。

$\eta$を
(\ref{mostly plus minkowski metric})
で与えた場合の運動方程式
(\ref{free massive vector field EL eq})
を、$\rho = 0$の場合と
$\rho = i$（ただし$i = 1, 2, \dots, d$）
の場合に分けて実際に解いてみよう。
解きたい方程式は
\begin{subequations}
\begin{align}
    0
&=
    \bigg[
        \delta^0_\sigma
        (\Box - m^2)
    -
        \eta^{0 \lambda}
        \partial_\lambda
        \partial_\sigma
    \bigg]
    A^\sigma
=
    (\Box - m^2)
    A^0
+
    \partial_0
    (\partial_\sigma A^\sigma)
\notag\\&
=
    \left(
        - \partial_0^2
        + \partial_j^2
        - m^2
    \right)
    A^0
+
    \partial_0
    (\partial_0 A^0
    + \partial_k A^k)
=
    \left(
        \partial_j^2
        - m^2
    \right)
    A^0
+
    \partial_0
    \partial_p A^p
\\
    0
&=
    \bigg[
        \delta^i_\sigma
        (\Box - m^2)
    -
        \eta^{i \lambda}
        \partial_\lambda
        \partial_\sigma
    \bigg]
    A^\sigma
=
    \left(
        - \partial_0^2
        + \partial_l^2
        - m^2
    \right)
    A^i
-
    \partial_i
    (\partial_0 A^0
    + \partial_q A^q)
\end{align}
\end{subequations}
で、上で既に述べたように
$A^0$の$x^0$による$2$階微分は
方程式のどこにも現れない。
この方程式をFourier変換
(\ref{fourier transf})
する（ただし面倒なので、
いちいち$A$のFourier変換を
$\tilde{A}$などと書くことはせず、
単に$A(k)$などと書く）と、
微分$\partial_i$は$i k_i$倍に置き換わる
（Fourier変換の定義の仕方によっては
$- i k_i$となるが、
得られる解に違いはない）
ため、
\begin{subequations}
\begin{align}
    0
&=
    \left(
        - k_j^2
        - m^2
    \right)
    A^0 (t, k)
+
    i \partial_0
    k_p A^p (t, k)
\label{fourier transf of vector eom; time component}
\\
    0
&=
    \left(
        - \partial_0^2
        - k_l^2
        - m^2
    \right)
    A^i (t, k)
-
    i k_i
    (\partial_0 A^0
    + i k_q A^q)
\end{align}
\end{subequations}
が従う。
第$1$式に$- i k_i \partial_0$を、
第$2$式に$k_j^2 + m^2$を掛けて
両辺の和を取ることで$A^0$は簡単に消去出来て、
$E_k := \sqrt{\bm{k}^2 + m^2}$を使って
\begin{align}
    0
&=
    (k_j^2 + m^2)
    \left(
        - \partial_0^2
        - k_l^2
        - m^2
    \right)
    A^i (t, k)
+
    k_i k_p
    \partial_0^2
    A^p (t, k)
+
    (k_j^2 + m^2)
    k_i k_q
    A^q (t, k)
\notag\\&
=
    - E_k^2
    \left(
        \partial_0^2
        + E_k^2
    \right)
    A^i (t, k)
+
    k_i
    \bigg[
        \partial_0^2
    +
        E_k^2
    \bigg]
    k_p A^p (t, k)
=
    \bigg[
        \partial_0^2
    +
        E_k^2
    \bigg]
    \bigg(
        k_i
        k_p A^p (t, k)
    -
        E_k^2
        A^i (t, k)
    \bigg)
\end{align}
となるので、一般解は
$t$に依存しない$2$つの任意vector
$\bm{B}^\pm (k)$を使って
\begin{align}
    k_i
    k_p A^p (t, k)
-
    E_k^2
    A^i (t, k)
&=
    - \bm{k}^2
    \left[
        (B^+)_i (k) e^{i E_k t}
    +
        (B^-)_i (k) e^{- i E_k t}
    \right]
\end{align}
と得られる。
ここで$A^i$を、$k_i$に平行な成分と
それに直交する成分$\bm{A}_\perp$
（$\bm{A}_\perp \cdot \bm{k} = 0$）に分けて
$\bm{A} = i \lambda (t, k) \bm{k}
+ \bm{A}_\perp(t, k)$
と書こう。
$\bm{k}$は$t$とは独立なので
$k_p A^p = i \lambda \bm{k}^2$
は時刻によらず成り立たせることが出来、
\begin{align}
    &
    - \bm{k}^2
    \left[
        (B^+)_i (k) e^{i E_k t}
    +
        (B^-)_i (k) e^{- i E_k t}
    \right]
=
    k_i k_p A^p
-
    E_k^2
    A^i
\notag\\&
=
    i k_i
    \lambda \bm{k}^2
-
    (\bm{k}^2 + m^2)
    (i \lambda k_i
    + (A_\perp)_i )
=
    - i m^2
    \lambda k_i
    -
    (\bm{k}^2 + m^2)
    (A_\perp)_i
\label{free vec field eom general sol decomposed}
\end{align}
が得られる。

\begin{enumerate}
\renewcommand{\labelenumi}{(\roman{enumi})}
\item {massless $m^2 = 0$の場合}

    この場合は
    (\ref{free vec field eom general sol decomposed})
    から$\lambda(t, k)$が消えてしまい、
    $\lambda(t, k)$は従うべき条件を持たない
    任意関数となる。
    またこのとき$E_k = ||\bm{k}||$より
    \begin{align}
        - \bm{k}^2
        (A_\perp)_i
    &=
    - \bm{k}^2
    \left[
        (B^+)_i (k) e^{i ||\bm{k}|| t}
    +
        (B^-)_i (k) e^{- i ||\bm{k}|| t}
    \right]
    \notag\\\therefore\quad
        \bm{A}_\perp
    &=
        \bm{B}^+ (k) e^{i ||\bm{k}|| t}
    +
        \bm{B}^- (k) e^{- i ||\bm{k}|| t}
    \end{align}
    となる。
    $(A_\perp)_i$は$\bm{k}$に直交する成分なので
    vector $\bm{B}^\pm$も
    $\bm{k}$に直交していなければならないが、
    その条件のほかは任意である。
    時間成分は
    (\ref{fourier transf of vector eom; time component})
    から
    \begin{align}
        A^0 (t, k)
    =
        \dfrac{i \partial_0}
            {\bm{k}^2}
        (i \lambda \bm{k}^2)
    =
        - \partial_0 \lambda (t, k)
    \end{align}
    と求まり、
    $\bm{A}
    = i \bm{k} \lambda
        + \bm{A}_\perp$
    と合わせて逆Fourier変換することで
    求める解が
    \begin{subequations}
    \begin{align}
        A^0 (t, x)
    &=
        - \partial_0 \lambda (t, x)
    =
        \partial^0 \lambda (t, x)
    \\
        \bm{A}
    &=
        \bm{A}_\perp
    +
        \nabla \lambda(t, x)
    =
        \int d^d k\ 
        e^{i \bm{k} \cdot \bm{x}}
        \left(
            \bm{B}^+ (k) e^{i ||\bm{k}|| t}
        +
            \bm{B}^- (k) e^{- i ||\bm{k}|| t}
        \right)
    +
        \nabla \lambda(t, x)
    \end{align}
    \end{subequations}
    と求まる。
    特に、任意関数$\lambda(t, x)$は
    (\ref{gauge invariance of vector field strength})
    で議論したgauge自由度に他ならないことが見て取れる。

\item {massive $m^2 \neq 0$の場合}

    この場合は
    (\ref{free vec field eom general sol decomposed})
    の両辺と$\bm{k}$との内積を取ることで
    $\lambda(t, k)$が求まってしまい、
    \begin{align}
        - i m^2
        \lambda \bm{k}^2
    &=
    (- \bm{k}^2)
    \bm{k} \cdot \left[
        \bm{B}^+ (k) e^{i E_k t}
    +
        \bm{B}^- (k) e^{- i E_k t}
    \right]
    \notag\\\therefore\quad
        i \lambda
    &=
    \dfrac{ \bm{k} }{ m^2 }
    \cdot \left[
        \bm{B}^+ (k) e^{i E_k t}
    +
        \bm{B}^- (k) e^{- i E_k t}
    \right]
    \end{align}
    となる。
    一方、これを使って
    (\ref{free vec field eom general sol decomposed})
    から$\bm{A}_\perp$を求めると
    \begin{align}
        \bm{A}_\perp
    &=
        \dfrac{ \bm{k}^2 }{ E_k^2 }
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    -
        \dfrac{i m^2 \lambda \bm{k}}
            { E_k^2 }
    \notag\\&
    =
        \dfrac{ \bm{k}^2 }{ E_k^2 }
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    -
        \dfrac{\bm{k}}
            { E_k^2 }
        \bm{k}
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \end{align}
    となり、確かに$\bm{k}$と直交している。
    $\bm{A} = i \lambda \bm{k} + \bm{A}_\perp$
    よりまとめると
    \begin{align}
        \bm{A} (t, k)
    &=
        \bm{k}
        \dfrac{ \bm{k} }{ m^2 }
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \notag\\&\qquad
    +
            \dfrac{ \bm{k}^2 }{ E_k^2 }
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    -
        \dfrac{\bm{k}}
            { E_k^2 }
        \bm{k}
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \notag\\&
    =
        \bm{k}
        \left(
            \dfrac{ 1 }{ m^2 }
        -
        \dfrac{ 1 }
            { E_k^2 }
        \right)
        \bm{k} \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    +
            \dfrac{ \bm{k}^2 }{ E_k^2 }
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \notag\\&
    =
        \bm{k}
        \dfrac{
            \bm{k}^2
        }{ m^2 E_k^2 }
        \bm{k} \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    +
            \dfrac{ \bm{k}^2 }{ E_k^2 }
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \end{align}

    最後に時間成分は
    (\ref{fourier transf of vector eom; time component})
    から
    \begin{align}
        A^0 (t, k)
    &=
        \dfrac{
            i \partial_0
            k_p A^p (t, k)    
        }{ E_k^2 }
    =
        \dfrac{
            i \partial_0
            (i \lambda \bm{k}^2)
        }{ E_k^2 }
    \notag\\&
    =
        i \partial_0
        \dfrac{ \bm{k}^2 }
            { E_k^2 }
        \dfrac{ \bm{k} }{ m^2 }
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \notag\\&
    =
        - \dfrac{ \bm{k}^2 }
            { E_k }
        \dfrac{ \bm{k} }{ m^2 }
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        -
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \end{align}
    が分かるので、
    逆Fourier変換して求める解
    \begin{subequations}
    \begin{align}
        A^0 (t, x)
    &=
        - \int d^d k\ 
        e^{i\bm{k} \cdot \bm{x}}
        \dfrac{ \bm{k}^2 }
            { E_k }
        \dfrac{ \bm{k} }{ m^2 }
        \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        -
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \\
        \bm{A} (t, k)
    &=
        \int d^d k\ 
        e^{i\bm{k} \cdot \bm{x}}
    \dfrac{ \bm{k}^2 }{ E_k^2 }
    \bigg\{
        \dfrac{ \bm{k} }{ m^2 }
        \bm{k} \cdot \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \notag\\&\qquad
    +
        \left[
            \bm{B}^+ (k) e^{i E_k t}
        +
            \bm{B}^- (k) e^{- i E_k t}
        \right]
    \bigg\}
    \end{align}
    \end{subequations}
    が得られる。

    なお、今の場合
    $0 = \partial_\mu A^\mu
    = \partial_0 A^0 + \nabla \cdot \bm{A}$
    が勝手に成立することに注意しよう。
    従ってmassiveの場合、
    vector場の運動方程式は
    \begin{subequations}
    \begin{align}
        0
    &=
        (\Box - m^2) A^\mu
    \\
        0
    &=
        \partial_\mu A^\mu
    \end{align}
    \end{subequations}
    の独立な$2$式に分離する。
\end{enumerate}

\subsubsection{Hamilton形式}

$N$種類の場$\phi^a$（$a = 1, \dots, N$）
で書かれたLagrangian
$\mathcal{L}(\{ \phi \})$が与えられたとき、
場の正準共役量（運動量と呼ばないのは、
これ以外に場の理論の意味でmomentumと呼ばれるべき量、
つまりenergy-momentum tensor (\ref{energy-momentum})があるからだ）は
\begin{align}
    \pi_a (t, x)
    := \dfrac{\partial \mathcal{L}}
        {\partial \dot{\phi}^a}
\end{align}
で定義される。
Hamiltonianも解析力学の場合と全く同様に
（もちろん時間積分は行わず）
\begin{subequations}
\begin{align}
    H (t)
    &:=
    \int d^d x\ \mathcal{H}
\\
    \mathcal{H} (t, \bm{x})
    &:=
    \sum_{a = 1}^N
        \pi_a (t, \bm{x})
        \dot{\phi}^a (t, \bm{x})
    -
    \mathcal{L}(t, \bm{x})
\end{align}
\end{subequations}
と定義される。

正準方程式
(\ref{Hamilton's eom})は
場の理論の場合にも全く同様に、
$N$種類の場$\phi^a$及び
対応する共役量$\pi_a$が存在するとき
\begin{align}
    \begin{cases}
        \dot{\phi}^a =
        \dfrac{\partial \mathcal{H}}
            {\partial \pi_a}
      \\
      \\
        \dot{\pi}_a =
        - \dfrac{\partial \mathcal{H}}
            {\partial \phi^a}
      \end{cases}
    \label{hamilton eom for fields}    
\end{align}
と書ける。
Poisson括弧
(\ref{poisson bracket definition})
を使ってまとめることもできる。

\subsubsection{自由scalar場の例}

自由実scalar場のLagrangianは
(\ref{free real scalar lagrangian})
で与えられていた。
$\eta$を
(\ref{mostly plus minkowski metric})
で与えた場合の
自由実scalar場のHamiltonianは、
$i, j = 1, \dots, d = D-1$を
空間成分のみ走る添え字として
\begin{subequations}
\begin{align}
    \pi(t, \bm{x})
&=
    \dfrac{ \partial \mathcal{L}_{\rm real} }
        { \partial( c \partial_0 \phi) }
=
    - \dfrac{1}{2 c}
        2 \partial^0 \phi
=   \dfrac{1}{c}
    \partial_0 \phi
\\
    \mathcal{H}_{\rm real}
&=
    \pi\ 
        c
        \partial_0 \phi
    -
    \mathcal{L}
=
    c^2 \pi^2
    -
    \left[
        \dfrac{ c^2 }{2}
            \pi^2
        -
        \dfrac{ 1 }{2}
            \partial_i \phi
            \partial_i \phi
        -
        \dfrac{m^2}{2} \phi^2
    \right]
\notag\\&
=
    \dfrac{ c^2 }{2} \pi^2
    +
        \dfrac{ 1 }{2}
            \partial_i \phi
            \partial_i \phi
    +
        \dfrac{m^2}{2} \phi^2
\end{align}
\end{subequations}
と得られる。
運動方程式は
\begin{subequations}
\begin{align}
    \dot{\phi}
&=
    \dfrac{
        \partial \mathcal{H}_{\rm real}
    }{ \partial \pi}
=
    c^2 \pi
\\
    \dot{\pi}
&=
    -
    \dfrac{
        \partial \mathcal{H}_{\rm real}
    }{ \partial \phi}
=
    - \left[
    -
        \partial_i^2 \phi
    +
        m^2 \phi
    \right]
=
        \partial_i^2 \phi
    -
        m^2 \phi
\end{align}
\end{subequations}
となり、$\pi$を消去することで
Lagrange形式の結果
(\ref{free real scalar eom})を再現する。

自由複素scalar場のHamiltonianも全く同様に
Lagrangian
(\ref{free complex scalar lagrangian})
から
\begin{subequations}
\begin{align}
    \pi
&=
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial (c \partial_0 \varphi)}
=
    - \dfrac{1}{c}
    \partial^0 \varphi^*
=
    \dfrac{1}{c}
    \partial_0 \varphi^*
\notag\\
    \overline{\pi}
&=
    \dfrac{\partial \mathcal{L}_{\rm complex}}
        {\partial (c \partial_0 \varphi^*)}
=
    - \dfrac{1}{c}
    \partial^0 \varphi
=
    \dfrac{1}{c}
    \partial_0 \varphi
\notag\\
    \mathcal{H}_{\rm complex}
&=
    \pi (c \partial_0 \varphi)
    +
    \overline{\pi} (c \partial_0 \varphi^*)
    -
    \left[
        (c \pi)
        (c \overline{\pi})
    -
        \partial_i \varphi^*
        \partial_i \varphi
    -
        m^2 |\varphi|^2
    \right]
\notag\\&
=
    c^2 \overline{\pi} \pi
    +
        \partial_i \varphi^*
        \partial_i \varphi
    +
        m^2 |\varphi|^2
\end{align}
\end{subequations}
と導かれ、
運動方程式は
やはり(\ref{free complex scalar eom})
と等価な
\begin{subequations}
\begin{align}
    \dot{\varphi}
&=
    \dfrac{
        \partial \mathcal{H}_{\rm complex}
    }{ \partial \pi}
=
    c^2 \overline{\pi}
\\
    \dot{\varphi}^*
&=
    \dfrac{
        \partial \mathcal{H}_{\rm complex}
    }{ \partial \overline{\pi}}
=
    c^2 \pi
\\
    \dot{\pi}
&=
    -
    \dfrac{
        \partial \mathcal{H}_{\rm complex}
    }{ \partial \varphi}
=
    - \left[
    -
        \partial_i^2 \varphi^*
    +
        m^2 \varphi^*
    \right]
=
        \partial_i^2 \varphi^*
    -
        m^2 \varphi^*
\\
    \dot{\overline{\pi}}
&=
    -
    \dfrac{
        \partial \mathcal{H}_{\rm complex}
    }{ \partial \varphi^*}
=
    - \left[
    -
        \partial_i^2 \varphi
    +
        m^2 \varphi
    \right]
=
        \partial_i^2 \varphi
    -
        m^2 \varphi
\end{align}
\end{subequations}
となる。

\subsubsection{Energy-Momentum Tensor}

Noetherの定理は場の理論にも拡張できる。

時空並進に対応する保存量である
energy-momentum tensor（stress-energy tensor、stress tensor、エネルギー運動量テンソル）は
計量tensor $g_{\mu\nu}$を用いて
\begin{align}
    T^{\mu\nu}
    :=
    -
    \dfrac{2}{\sqrt{|g|} }
    \dfrac{\partial L_{\mathrm{matter}}}{\partial g_{\mu\nu}}
\label{energy-momentum}
\end{align}
で定義される。
ただし、一般相対論まで行くと重力場そのものの作用も
気にしなければならないので、
今はLagrangianの中に重力を表すEinstein-Hilbert項を含めていないと示すため
$L_{\mathrm{matter}}$と書いた。

\subsection{場の量子化}

古くは第2量子化と呼ばれる事もあったが、
量子力学に何らかの操作を施して新たな量子論を得るのではなく、
むしろ場の量子論の非相対論的極限で量子力学が現れるという理解の方が正しいため、
この用語は廃れてしまった。
同様に、かつては単純に量子力学を相対論的に拡張しようとした
相対論的量子力学という試みもあったが、
負の確率が現れてしまうなど様々な困難を孕んでおり、
それらは場の量子論の視点からは自然に解決するため
今更それを学ぶ価値はそう高くないだろう。

\subsubsection{非相対論的なScalar場}

正準交換関係
\begin{align}
    [\hat{\phi}(\bm{x}), \hat{\pi}(\bm{y})]
    &=
    i \hbar \delta(\bm{x} - \bm{y})
\end{align}
を課す。

\subsubsection{非相対論的なSpinor場}

\subsubsection{相対論的に可能な場}
\label{representation of Lorentz group}

\section{摂動展開と繰り込み}

\subsection{一般の相互作用が満たすべき性質}
Wightman axioms、Haag's theorem、
Coleman-Mandula theorem、
Haag-\L{}opusza\'nski-Sohnius theorem、
locality
\label{locality}
、
cluster decomposition principle