\section{質点の解析力学の基礎}

\subsection{Newton力学}

皆さんが良く知っているNewtonの運動方程式
\begin{align}
  \bm{F} = m\ddot{\bm{x}}
\end{align}
は解析力学に比べて最も一般的な運動方程式の形で、
例えば摩擦力が働くなどenergy散逸のある系や
外部から力を受けている系などを何の困難もなく表すことが出来る。

例えば1次元調和振動子の場合を考えると
\begin{align}
  F = -k x
\end{align}
であるので、Newton運動方程式は
\begin{align}
  m\ddot{x} = - k x
\end{align}
となる。

ただし、この方程式はvectorで記述されているため、
例えば極座標のような直交座標系以外の座標を用いると
形が著しく複雑になるという欠点も持っている。
これに対し、例えばenergyのようなscalar量は
座標変換の下でより自然に変換するため、
様々な力学法則をscalarを用いて表したいというのは自然な要求である。
以下で議論するLagrange力学やHamilton力学はそのような
記述を与える枠組みの例である。

\subsection{Lagrange力学}

多くの力学系において、
位置$\bm{x}$にある粒子に働く力は
位置の関数$\bm{F}(\bm{x})$と書ける。
この関数$\bm{F}$のように空間の各点$\bm{x}$に対し
あるvector $\bm{F}(\bm{x})$を与えるものを
vector値関数、あるいはvector場という。

物体に働く力$\bm{F}$が保存力である
\begin{align}
  \mathrm{rot} \bm{F}
  := 
  \nabla \times \bm{F}
  = 0
\end{align}
場合にはscalar potential $\phi(\bm{x})$
が存在して
\begin{align}
  \bm{F} = -\nabla \phi
\end{align}
と書けることは、力学で最初に習う事の一つだろう。

我々の主たる興味は空間が3次元である場合にあるが、
この場合にはより一般的な結果が知られている：
Helmholtzの分解定理は任意の
3次元vector場$\bm{F}(\bm{x})$に対し
vector potential $\bm{A}(\bm{x})$と
scalar potential $\phi(\bm{x})$の組であって
\begin{align}
  \bm{F}(\bm{x}) = \nabla \times \bm{A} - \nabla \phi
\end{align}
なるものが存在する事を主張する。
つまり、物体に働く力が場である
（顕わに時間依存したりすることなく、位置のみの関数として書けている）
限りにおいて、
必ずvector potential及びscalar potentialを用いて書けるのである。

これを踏まえ、
まずは物体に働く力がscalar potentialを用いて書ける場合に
話を限ろう。
3次元空間に記述したい質点が$n$個あるとすれば、
これらの質点の状態は
一般化座標$q_i$$(i=1,2,\dots,3n)$を用いて記述できる。
これらをまとめて$\{q\} := \{q_i| i=1,2,\dots,3n\}$と書く。
ここで我々の世界がNewtonの運動方程式のように
決定論的な力学法則に支配されていると信じると、
これらの力学変数$q_i$は各時刻で完全に決定されているはずなので、
時間の関数$q_i(t)$として与えられている。
よって時間微分が定義でき、
$\dot{q}(t) := \dfrac{dq(t)}{dt}$
と書く。

Newton以来の経験的事実として、
我々の世界の力学法則はこれらの座標の2階までの時間微分で記述できるため、
kinetic energy $T$と
potential energy $V$
が
$\{q\}, \{\dot{q}\}$の関数として表される事は事実として受け入れよう。
このとき、Lagrangian $L(\{q\}, \{\dot{q}\})$を
$6n$変数関数として
\begin{align}
  L := T - V
\end{align}
で定義する。
個々の力学変数$q_i(t)$は時間の関数であるので、
$6n$変数関数
$L(\{q\}, \{\dot{q}\})$との合成関数
$L(t) := L(\{q(t)\}, \{\dot{q}(t)\})$は時間の$1$変数関数であり、
時刻$t_i$から時刻$t_f$までの定積分が定義できる：
\begin{align}
  S := \int_{t_i}^{t_f}dt\ L(\{q\}(t), \{\dot{q}\}(t))
\end{align}
この$S$をaction（作用）と言い、$I$と書くこともある。

最小作用の原理は、個々の力学変数の時間依存性は
このactionが停留するような関数形で与えられる事を主張する。
つまり、$q_i(t)$を時間の関数と見做したときの関数形を
\begin{align}
  q_i(t) &\mapsto (q_i+\delta q_i)(t) := q_i(t) + \delta q_i(t)
  \\
  | q_i(t) | & \gg | \delta q_i(t) |
  \qquad (\forall t)
\end{align}
のように微小に変化させたとき、
どんな関数$\delta q_i(t)$に対しても
actionの変分
\begin{align}
  \delta S &:= \int dt\ L(\{ q_i(t) + \delta q_i(t) \},
  \{ \dot{q}_i(t) + \delta \dot{q_i}(t) \} )
\notag\\&\simeq
  \int dt\ \sum_i
  \bigg\{
    \delta q_i(t)
    \dfrac{\partial}{\partial q_i}
    L(\{ q(t) \},
    \{ \dot{q}(t) \} )
%  \notag\\&\qquad
+
    \delta \dot{q_i}(t)
    \dfrac{\partial}{\partial \dot{q_i}}
    L(\{ q(t) \},
    \{ \dot{q}(t) \} )
  \bigg\}
\notag\\&\simeq
\int dt\ \sum_i
\delta q_i(t)
\bigg\{
  \dfrac{\partial}{\partial q_i}
  L(\{ q(t) \},
  \{ \dot{q}(t) \} )
%  \notag\\&\qquad
-
  \dfrac{d}{dt}
  \dfrac{\partial}{\partial \dot{q_i}}
  L(\{ q(t) \},
  \{ \dot{q}(t) \} )
\bigg\}
%  \qquad (\ \forall\ \delta q_i(t), i\ )
\end{align}
（ここで、部分積分による表面項が現れない事
$[\cdots]_{t=t_i}^{t_f}=0$
を仮定した）
が消えること
\begin{align}
  \delta S &= 0
  \qquad (\forall\ \delta q_i(t), i)
\\\Leftrightarrow\qquad
  0 &= 
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q_i} }
  - \dfrac{\partial L}{\partial q_i }
  \qquad (\ \forall i\ )
\label{Euler-Lagrange for point masses}
\end{align}
を要求すると、得られた微分方程式の解が
物理的に実現される物体の軌跡${q(t)}$
を与えるというのである。
(\ref{Euler-Lagrange for point masses})
をEuler-Lagrange方程式と言い、
scalar量$L$によって力学法則を与えたという点で
確かに目標を達成している。
実際、$\{q\}$から新しい変数$\{ q'\}$への座標変換
$q_i = q_i(\{q'\})$
のもとでEuler-Lagrange方程式が形を変えないことが示される。

\subsubsection{調和振動子の例}

$n$次元調和振動子の場合Lagrangianは
\begin{align}
  L = \sum_{j=1}^n
  \bigg(
    \dfrac{m}{2}\dot{q_j}^2
  -
    \dfrac{m\omega^2}{2} q_j
  \bigg)
\end{align}
であるので、Euler-Lagrange方程式は
\begin{align}
  0 &= 
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q_i} }
  - \dfrac{\partial L}{\partial q_i }
\notag\\&=
  \dfrac{d}{dt}
  \bigg(
    m\dot{q_i}
  \bigg)
  - 
  \bigg(
  -
    m\omega^2 q_i
  \bigg)
\notag\\&=
    m\ddot{q_i}
  +
    m\omega^2 q_i
\end{align}
となり、確かにNewtonの運動方程式を再現する。

\subsection{Hamilton力学}

一般にEuler-Lagrange方程式は各変数$q_i$の
高階の微分を含む、複雑な方程式系となる。
変数を増やす代わりに、
低次の微分で書ける方程式系を見付けたいと思うのも自然な発想である。
Lagrangian $L(\{q\},\{\dot{q}\})$に
新しい変数$\{p\}$を導入する代わりに
$\dot{q}_i$を消去し、
Euler-Lagrange方程式と等価な微分方程式系を得ることを考えよう。

一般化運動量を
\begin{align}
  p_i := \dfrac{\partial L}{\partial \dot{q_i}}
\label{generalized momentum}
\end{align}
で定義する。
一般に$\det \dfrac{\partial^2 L}{\partial \dot{q_i} \partial \dot{q_j} } \neq 0 $
であれば
$p$の定義式を$\dot{q_i}$について
\begin{align}
  \dot{q_i} = \dot{q_i}(\{q\},\{p\},t)
\end{align}
のように解く事が出来、
\footnote{
  このような逆解きが出来ない力学系を
  特異Lagrange系と呼ぶ。
  gauge理論などは場の量子論における特異系の例である。
}
従って$\dot{q_i}$を方程式系から消去できる。
Euler-Lagrange方程式は
\begin{align}
  \begin{cases}
    \dot{p_i} = \dfrac{\partial L}{\partial q_i}
\\    \\
      p_i = \dfrac{\partial L}{\partial \dot{q_i}}   
  \end{cases}
%\quad
%&\Leftrightarrow
%\quad
\label{Euler-Lagrange with p}
\end{align}
となるが、
Lagrangianそのものから$\{\dot{q}\}$を消去し
$\{q\},\{p\}$の$6n$変数関数として書き直すと
(\ref{generalized momentum})の右辺を表現する方法がなくなってしまう。
そこで別のアプローチを考えよう。

我々が欲しいのは新しい変数で表されたLagrangianそのものではなく、
Lagrangianを古い変数で微分して得られる方程式系である。
そこで、新しい変数$\{q\},\{p\}$で微分すると
Lagrangianを古い変数$\{q\}, \{\dot{q}\}$
で微分したときと等価の式を与えるような、
新しい関数$H(\{q\},\{p\})$を構成することを考える。

Legendre変換
\begin{align}
  H(\{q\},\{p\})
  :=
  \bigg[
    \sum_i 
      \dot{q_i} p_i
  - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\end{align}
はそのような構成の例である。
右辺には$9n$個の変数$\{q\},\{\dot{q}\},\{p\}$が表れているが、
$\dot{q}$が消去され
$\{q\},\{p\}$の$6n$変数関数として表されていることに注意しよう。
関数$H$をHamiltonianというが、
その著しい性質は$\dot{q}$を消去する直前の表式が
$\dot{q}$に依っていないこと
\begin{align}
  \dfrac{\partial}{\partial \dot{q_i}}
  \bigg[
    \sum_j
      \dot{q_j} p_j
  - L(\{q\}, \{\dot{q}\})
  \bigg]
  &=
  \bigg[
    \sum_j\bigg(
      \delta_{ij} p_j
    \bigg)
  - \dfrac{\partial L}{\partial \dot{q_i}}
  \bigg]
\notag\\&=
  \bigg[
    p_i
    - \dfrac{\partial L}{\partial \dot{q_i}}
  \bigg]
\notag\\
  &=0
\end{align}
である。
ただし、偏微分は$\{q\},\{\dot{q}\},\{p\}$の全てを独立な変数と見做して
行っていることに注意せよ。

Hamiltonianの$\{q\},\{p\}$による微分は、
$q(t)$がEuler-Lagrange方程式の解であるとすると
\begin{align}
  \dfrac{\partial H}{\partial q_i} 
  &= 
  \dfrac{\partial}{\partial q_i} 
  \bigg[
    \sum_j p_j
     \dot{q_j}
     - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &= 
  \sum_j    p_j
   \dfrac{\partial \dot{q_j} (\{q\},\{p\},t) }{\partial q_i }
   - \dfrac{\partial L(\{q\}, \{\dot{q}(\{q\},\{p\},t)\} ) }{
     \partial q_i
   }
\notag\\  &= 
   \sum_j    p_j
    \dfrac{\partial \dot{q_j} }{\partial q_i}
    - \Bigg[
      \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
        \partial q_i
      }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
      +
      \sum_j
      \dfrac{\partial \dot{q_j}}{\partial q_i}
      \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
        \partial \dot{q_j}
      }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
    \Bigg]
\notag\\  &= 
    \sum_j    p_j
     \dfrac{\partial \dot{q_j} }{\partial q_i}
     - \Bigg[
       \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
         \partial q_i
       }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
       +
       \sum_j
       \dfrac{\partial \dot{q_j}}{\partial q_i}
       p_j
     \Bigg]
\notag\\  &= 
      - 
        \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
          \partial q_i
        }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &= 
      - 
      \dfrac{ d }{ dt }
      \dfrac{\partial L}{
        \partial \dot{q_i}
      }
    \qquad\because\text{Euler-Lagrange方程式}  
\notag\\  &= 
    - 
    \dot{p_i}
\label{Hamilton's eom1}
\\
  \dfrac{\partial H}{\partial p_i} 
  &= 
  \dfrac{\partial }{\partial p_i} 
  \bigg[
    \sum_j
      \dot{q_j} p_j
  - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &= 
  \sum_j
  \bigg[
    \dfrac{\partial \dot{q_j}(\{q\},\{p\},t)}{
      \partial p_i
    } p_j
  +
  \dot{q_j}(\{q\},\{p\},t) \delta_{ij}
  \bigg]
- \dfrac{\partial L(\{q\}, \{\dot{q}\}) }{
  \partial p_i
}
\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &= 
  \sum_j
    \dfrac{\partial \dot{q_j}}{
      \partial p_i
    } p_j
  +
  \dot{q_i}
  - \sum_j
  \dfrac{\partial \dot{q_j} }{
    \partial p_i
  }
  \dfrac{\partial L(\{q\}, \{\dot{q}\}) }{
    \partial \dot{q_j}
  }
  \bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &= 
  \sum_j
    \dfrac{\partial \dot{q_j}}{
      \partial p_i
    } p_j
  +
  \dot{q_i}
  - \sum_j
  \dfrac{\partial \dot{q_j} }{
    \partial p_i
  }
    p_j
\notag\\  &= 
    \dot{q_i}
\label{Hamilton's eom2}
\end{align}
のようにLagrangianを一切使わずに表せ、
逆にHamiltonianを再びLegendre変換したものに
(\ref{Hamilton's eom1}),(\ref{Hamilton's eom2})
の解$\{q(t)\},\{p(t)\}$を代入すると
$\{q\},\{p\}$で書いたEuler-Lagrange方程式
(\ref{Euler-Lagrange with p})
を再現する。
すなわち両者は微分方程式系として等価であり、
(\ref{Hamilton's eom1}), 
(\ref{Hamilton's eom2})を
Hamiltonの正準方程式という。

Hamiltonの方程式はscalar関数$H$から得られ、
1階の時間微分のみを含むので、
望む方程式系が得られたことになる。

\subsubsection{調和振動子の例}

$n$次元調和振動子の一般化運動量は
\begin{align}
  p_i &= \dfrac{\partial L}{\partial \dot{q_i}}
=
  m \dot{q_i}
\end{align}
と通常の運動量の定義に一致するので、
Hamiltonianは
\begin{align}
  H &= \bigg[
    \sum_i p_i \dot{q_i}
    - L
    \bigg]_{ \dot{q_i} = \frac{p_i}{m} }
\notag\\&=
    \sum_i p_i \frac{p_i}{m}
    - 
      \sum_i \bigg(
      \dfrac{p_i^2}{2m}
    -
      \dfrac{ m \omega^2 }{2}
      q_i^2
    \bigg)
\notag\\&=
    \sum_i \bigg(
      \dfrac{p_i^2}{2m}
    +
      \dfrac{ m \omega^2 }{2}
      q_i^2
    \bigg)
\end{align}
となる。
正準方程式は
\begin{align}
  \begin{cases}
    \dot{q_i} &= \dfrac{\partial H}{\partial p_i}
    = \dfrac{p_i}{m}
  \\\\
    \dot{p_i} &= - \dfrac{\partial H}{\partial q_i}
    = - m \omega^2 q_i  
  \end{cases}
\quad
\Leftrightarrow
\quad
  \ddot{q_i} &= \dfrac{\dot{p_i}}{m}
  = \dfrac{- m \omega^2 q_i}{m} 
  = - \omega^2 q_i
\end{align}
となって、やはりNewtonの方程式を再現する。

\subsubsection{Poisson括弧}

Hamiltonの正準方程式
\begin{align}
   \begin{cases}
      \dot{q_i} &= \dfrac{\partial H}{\partial p_i}
    \\\\
      \dot{p_i} &= - \dfrac{\partial H}{\partial q_i}
    \end{cases}
\label{Hamilton's eom}
\end{align}
は$\{q\},\{p\}$のいずれについても
時間の1階微分しか含まない点で美しいが、
$\{q\},\{p\}$に対して右辺の符号が異なるという非対称性がある。
より抽象的な演算を導入することで、この非対称性を取り除こう。

2つの量$A,B$のPoisson括弧を
\begin{align}
    \{A, B\}_{ \mathrm{P} }
    := \sum_i \bigg(
        \dfrac{ \partial A }{ \partial q_i }
        \dfrac{ \partial B }{ \partial p_i }
    -
        \dfrac{ \partial B }{ \partial q_i }
        \dfrac{ \partial A }{ \partial q_i }
    \bigg)
\end{align}
で定義すると、
正準方程式(\ref{Hamilton's eom})は
\begin{align}
    \begin{cases}
        \dot{q_i} = \{q_i, H\}_{ \mathrm{P} }
      \\
        \dot{p_i} = \{p_i, H\}_{ \mathrm{P} }
      \end{cases}
\quad
\therefore
\quad
    \dot{r} &= \{r, H\}_{ \mathrm{P} }
\qquad
    ( r = q_i, p_j \quad\forall i, j )
\end{align}
と書ける。
より一般に、任意の関数
$F( \{q\},\{p\} , t )$
の時間発展が
\begin{align}
    \dfrac{ d F }{ dt } &= \dfrac{ \partial F }{ \partial t } + \{F, H\}_{ \mathrm{P} } 
\end{align}
と一つの式にまとまってしまう。
あらゆる量の時間発展を求める過程が、
Poisson括弧の計算という一つの操作に統一されたのである。

なお、正準変数同士のPoisson括弧は
\begin{align}
   \{q_i, p_j\}_{ \mathrm{P} }
   = \delta_{ij}
,\qquad
   \{p_i, q_j\}_{ \mathrm{P} }
   = - \delta_{ij}
\end{align}
のようになる。
