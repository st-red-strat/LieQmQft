\section{質点の解析力学の基礎}

\subsection{Newton力学}

皆さんが良く知っているNewtonの運動方程式
\begin{align}
  \bm{F} = m\ddot{\bm{x}}
\label{newton eom}
\end{align}
は解析力学に比べて最も一般的な運動方程式の形で、
例えば摩擦力が働くなどenergy散逸のある系や
外部から力を受けている系などを何の困難もなく表すことが出来る。

例えば1次元調和振動子の場合を考えると
\begin{align}
  F = -k x
\end{align}
であるので、各振動数との関係
$\omega = \sqrt{\dfrac{k}{m}}$
を思い出すと
Newton運動方程式は
\begin{align}
  \ddot{x}
  = - \dfrac{k}{m} x
  = - \omega^2 x
\label{newton harm osci eom}
\end{align}
となる。

\subsubsection{極座標の場合}

$D$次元Euclid空間$\mathbb{R}^D$上の点は
$D$次元vector $\bm{r}$で表され、
直交座標系（orthogonal coordinate system、Cartesian coordinates、デカルト座標などとも）
$(x_1, x_2, \dots, x_D)$方向の単位ベクトル
$\bm{e}_1, \bm{e}_2, \dots, \bm{e}_D$を使って
\begin{align}
  \bm{r} = \sum_{i = 1}^D r_i \bm{e}_i
\end{align}
のように一意に展開できるのであった。
例として$D = 2$の場合を考えると、
$(x,y) := (x_1, x_2)$として
\begin{align}
  \bm{r} = r_x \bm{e}_x + r_y \bm{e}_y
\end{align}
となる。
さて、物理ではCoulomb力のように、
力が角度には依存せず物体の距離だけに依存するような場合がある。
例えば、原点$(0, 0)$に点電荷が固定されていて
位置$\bm{r}$にある質点の受ける力や運動を計算したいときは、
$(x, y)$よりも極座標
\begin{align}
  \begin{cases}
    r(x, y) := \sqrt{x^2 + y^2}
  \\
    \theta(x, y)
    =
    \mathrm{sgn} (y) \mathrm{Arccos}
    \dfrac{x}{ \sqrt{x^2 + y^2} }
    =
    \arctan \dfrac{y}{x}
  \end{cases}
&&\Leftrightarrow&&
  \begin{cases}
    x(r, \theta) = r \cos\theta
  \\
    y(r, \theta) = r \sin\theta
  \end{cases}
\end{align}
を使うのが便利であろう。

このような非直交座標系$(x_1,\dots,x_D)$では
座標軸の向きが空間上で一定ではない。
$i$番目の座標軸とは他の座標を固定して
$x_i$だけを変化させたときに
点$(x_1,\dots,x_D)$が描く軌跡のことであるので、
空間$\mathbb{R}^D$の各点$\bm{r}$ごとに
座標軸$i$方向の単位vectorを
「$i$番目の座標値を変化させたときに
位置vector $\bm{r}$が動く方向」、つまり
\begin{subequations}
\begin{align}
  \bm{e}_i (r, \theta)
  &:=
  \dfrac{ \widetilde{\bm{e}}_i }
  { \big|\big| \tilde{\bm{e}}_i \big|\big| }
\\
  \widetilde{\bm{e}}_i (r, \theta)
  &:=
  \dfrac{\partial \bm{r}}{\partial x_i}
\end{align}
\end{subequations}
と定義しよう。
今や単位vector $\bm{e}_i (r, \theta)$は
座標$(r, \theta)$の関数であり、
空間の各点で（つまり座標が変わるごとに）
単位vectorの向きも変わってしまう。
例えば、位置$(x, y) = (a,0), (0,b)$
すなわち$(r, \theta) = (a, 0), (b, \frac{\pi}{2})$
を表すvectorはそれぞれ
\begin{subequations}
\begin{align}
  a \bm{e}_x
  = a \bm{e}_r (r=a, \theta = 0)
\\
  b \bm{e}_y
  = b \bm{e}_r (r=b, \theta = \frac{\pi}{2})
\end{align}
\end{subequations}
と書かれる。
より一般の位置$\bm{r}$も常に
\begin{align}
  \bm{r} = r \bm{e}_r
  = x \bm{e}_x + y \bm{e}_y
  &&
  \begin{cases}
    \bm{e}_r
  =
    \cos \theta \bm{e}_x
  +
    \sin \theta \bm{e}_y
  \\
    \bm{e}_\theta
  =
    - \sin \theta \bm{e}_x
  +
    \cos \theta \bm{e}_y
  \end{cases}
\end{align}
と書ける事は明らかであろう。

Newtonの運動方程式(\ref{newton eom})は
位置vectorの時間微分を含んでいた。
時刻$t$での粒子の位置座標$(r(t), \theta(t))$を使って、
これを書き下してみるとどうなるだろうか。
単位vectorも位置依存性を通して
$t$に陰に依存していることに注意すると
\begin{subequations}
\begin{align}
  \dot{ \bm{e} }_r
  &=
  \dot{ \theta }(
    - \sin \theta \bm{e}_x
    + \cos \theta \bm{e}_y
  )
  = \dot{ \theta } \bm{e}_\theta
\\
  \dot{ \bm{e} }_\theta
  &=
  \dot{ \theta }(
    - \cos \theta \bm{e}_x
    - \sin \theta \bm{e}_y
  )
  = - \dot{ \theta } \bm{e}_r
\end{align}
\end{subequations}
が得られるから、
\begin{subequations}
\begin{align}
  \dot{ \bm{r} }
  &=
  \dot{r} \bm{e}_r
  +
  r \dot{ \bm{e} }_r
  =
  \dot{r} \bm{e}_r
  +
  r \dot{\theta} \bm{e}_\theta
\\
  \ddot{ \bm{r} }
  &=
  \left(
    \ddot{r} \bm{e}_r
  +
    \dot{r} \dot{ \bm{e} }_r
  \right)
  +
  \left(
    \dot{r} \dot{\theta} \bm{e}_\theta
  +
    r \ddot{\theta} \bm{e}_\theta
  +
    r \dot{\theta} \dot{ \bm{e} }_\theta
  \right)
\notag\\&=
  \left(
    \ddot{r}
  -
    r \dot{\theta}^2
  \right)
  \bm{e}_r
  +
  \left(
    2 \dot{r} \dot{\theta}
  +
    r \ddot{\theta}
  \right)
  \bm{e}_\theta
\end{align}
\end{subequations}
だと分かる。
従ってこの座標系でのNewton方程式は
\begin{align}
  \dfrac{ F_r }{m}
  &=
    \ddot{r}
  -
    r \dot{\theta}^2
\\
  \dfrac{ F_\theta }{m}
  &=
    2 \dot{r} \dot{\theta}
  +
    r \ddot{\theta}  
\end{align}
であり、整然とした直交座標での表式とは似ても似つかない。

\subsubsection{空間Vectorの性質とScalar、Tensor}

数学はvectorとはvector spaceの元であり、
vector spaceの定義は\ref{Axioms of Vector Space}
のように与えられていた。
ところが物理におけるvectorは
多くの場合は座標変換のもとでの変換性により特徴付けられ、
空間vectorと呼ばれるべきものである。
これらは抽象的には多様体上の接ベクトル、
ないし回転群の表現と定義される。
上の極座標における例と見比べながら、
その性質について考えよう。

Newton方程式はvectorで記述されているため、
例えば極座標のような直交座標系以外の座標を用いると
形が著しく複雑になるという欠点も持っている。
これに対し、例えばenergyのようなscalar量は
座標変換の下でより自然に変換するため、
様々な力学法則をscalarを用いて表したいというのは自然な要求だろう。
以下で議論するLagrange力学やHamilton力学はそのような
記述を与える枠組みの例である。

\subsection{Lagrange力学}

多くの力学系において、
位置$\bm{x}$にある粒子に働く力は
位置の関数$\bm{F}(\bm{x})$と書ける。
この関数$\bm{F}$のように空間の各点$\bm{x}$に対し
あるvector $\bm{F}(\bm{x})$を与えるものを
vector値関数、あるいはvector場という。

物体に働く力$\bm{F}$が保存力である
\begin{align}
  \mathrm{rot} \bm{F}
  :=
  \nabla \times \bm{F}
  = 0
\end{align}
場合にはscalar potential $\phi(\bm{x})$
が存在して
\begin{align}
  \bm{F} = -\nabla \phi
\end{align}
と書けることは、力学で最初に習う事の一つだろう。

我々の主たる興味は空間が3次元である場合にあるが、
この場合にはより一般的な結果が知られている：
Helmholtzの分解定理
（Helmholtz decomposition theorem）は任意の
3次元vector場$\bm{F}(\bm{x})$に対し
vector potential $\bm{A}(\bm{x})$と
scalar potential $\phi(\bm{x})$の組であって
\begin{align}
  \bm{F}(\bm{x}) = \nabla \times \bm{A} - \nabla \phi
\label{helmholtz decomposition theorem}
\end{align}
なるものが存在する事を主張する。
つまり、物体に働く力が場である
（顕わに時間依存したりすることなく、位置のみの関数として書けている）
限りにおいて、
必ずvector potential及びscalar potentialを用いて書けるのである。

これを踏まえ、
まずは物体に働く力がscalar potentialを用いて書ける場合に
話を限ろう。
3次元空間に記述したい質点が$n$個あるとすれば、
これらの質点の状態は
一般化座標$q_i$$(i=1,2,\dots,3n)$を用いて記述できる。
これらをまとめて$\{q\} := \{q_i| i=1,2,\dots,3n\}$と書き、
これらのparameterで張られる$3n$次元空間を
配位空間（configuration space）という。
ここで我々の世界がNewtonの運動方程式のように
決定論的な力学法則に支配されていると信じると、
これらの力学変数$q_i$は各時刻で完全に決定されているはず
（この時間parameter $t$をGalilean timeと呼ぶ。
わざわざ名前を付けるということは区別すべき概念が他にも存在するということで、
実際にNewton力学のような観測者に依らない
universalな時刻$t$は電磁気学と矛盾するため
特殊相対論が必要になる）なので、
時間をparameterとする配位空間上の軌跡$q_i(t)$として与えられている。
よって時間微分が定義でき、
$\dot{q}(t) := \dfrac{dq(t)}{dt}$
と書く。

Newton以来の経験的事実として、
我々の世界の力学法則はこれらの座標の2階までの時間微分で記述できるため、
kinetic energy $T$と
potential energy $V$
が
$\{q\}, \{\dot{q}\}$の関数として表される事は事実として受け入れよう。
\footnote{
  より高階、つまり3階以上の時間微分で記述される系については
  Ostrogradsky theoremとかOstrogradsky instabilityと呼ばれているものが知られており、
  Hamiltonian が上下に非有界になって
  物理的に不安定な系となってしまうらしい
  \cite{Ostrogradsky instability}。
  ただし、一般に高階の微分は高energy領域での理論の振る舞いを変化するため、
  低エネルギー領域でよく理解された理論を
  高エネルギー領域に拡張したい重力理論などの文脈では、
  高階の微分を含む理論が大真面目に議論されている。
  また、例えば弦理論に現れるD-braneの低エネルギー有効作用であるDBI作用（Dirac-Born-Infeld action）などは
  自然に高次の微分項を導く。
}
このとき、Lagrangian $L(\{q\}, \{\dot{q}\})$を
$6n$変数関数として
\begin{align}
  L := T - V
\end{align}
で定義する。
個々の力学変数$q_i(t)$は時間の関数であるので、
$6n$変数関数
$L(\{q\}, \{\dot{q}\})$との合成関数
$L(t) := L(\{q(t)\}, \{\dot{q}(t)\})$は時間の$1$変数関数であり、
時刻$t_i$から時刻$t_f$までの定積分が定義できる：
\begin{align}
  S[q] := \int_{t_i}^{t_f}dt\ L(\{q(t)\}, \{\dot{q}(t)\})
\end{align}
この$S$をaction（作用）と言い、$I$と書くこともある。
また、作用$S$は時間による定積分で与えられるので
それ自身は時間の関数ではないが、
時間の関数$q(t)$を与えると決まる量である、
という意味で$S[q]$と書いた。
このように関数$f(x)$を引数に取って
実数$F[f]$を与えるような写像$F$を
汎関数（functional）と呼ぶ。

Hamiltonの最小作用の原理
（Hamilton’s principle of least action）は、
個々の力学変数の時間依存性が
このactionが停留する
（一般には作用が最小であるとは限らず、
最大や鞍点であってもよい）
ような関数形で与えられる事を主張する。
つまり、$q_i(t)$を時間の関数と見做したときの関数形を
\begin{align}
  q_i(t) &\mapsto (q_i+\delta q_i)(t) := q_i(t) + \delta q_i(t)
  \\
  | q_i(t) | & \gg | \delta q_i(t) |
  \qquad (\forall t)
\notag
\end{align}
のように微小に変化させたとき、
どんな関数$\delta q_i(t)$に対しても
actionの変分が微小量の$1$次まで
\begin{align}
  \delta S &:=
  S[q + \delta q] - S[q]
\notag\\&=
  \int dt\ L(\{ q_i(t) + \delta q_i(t) \},
  \{ \dot{q}_i(t) + \delta \dot{q}_i(t) \} )
  - S[q]
\notag\\&\simeq
  \int dt\ \sum_i
  \bigg\{
    \delta q_i(t)
    \dfrac{\partial}{\partial q_i}
    L(\{ q(t) \},
    \{ \dot{q}(t) \} )
%  \notag\\&\qquad
+
    \delta \dot{q}_i(t)
    \dfrac{\partial}{\partial \dot{q}_i}
    L(\{ q(t) \},
    \{ \dot{q}(t) \} )
  \bigg\}
\notag\\&=
  \sum_i
  \bigg[
    \delta q_i(t)
    \dfrac{\partial}{\partial \dot{q}_i}
    L(\{ q(t) \},
    \{ \dot{q}(t) \} )
  \bigg]_{t=t_i}^{t_f}
\notag\\&\qquad
  +
\int dt\ \sum_i
\delta q_i(t)
\bigg\{
  \dfrac{\partial}{\partial q_i}
  L(\{ q(t) \},
  \{ \dot{q}(t) \} )
-
  \dfrac{d}{dt}
  \dfrac{\partial}{\partial \dot{q}_i}
  L(\{ q(t) \},
  \{ \dot{q}(t) \} )
\bigg\}
%  \qquad (\ \forall\ \delta q_i(t), i\ )
\label{variation of action}
\end{align}
で消える
（同時に、部分積分による表面項
$[\cdots]_{t=t_i}^{t_f}$
も適当な境界条件を課すことにより消える）
こと
\begin{align}
  \delta S &= 0
  \qquad (\forall\ \delta q_i(t), i)
\notag\\\Leftrightarrow\qquad
  0 &=
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q}_i }
  - \dfrac{\partial L}{\partial q_i }
  \qquad (\ \forall i\ )
\label{Euler-Lagrange for point masses}
\end{align}
を要求すると、得られた微分方程式の解が
物理的に実現される物体の軌跡${q(t)}$
を与えるというのである。
(\ref{Euler-Lagrange for point masses})
をEuler-Lagrange方程式と言い、
scalar量$L$によって力学法則を与えたという点で
確かに目標を達成している。
実際、$\{q\}$から新しい変数$\{ q'\}$への座標変換
（一般座標変換、または点変換という）
$q_i = q_i(\{q'\})$
のもとで
\begin{align}
  L'(\{q'\}, \{\dot{q}'\}) &:= L(\{q(\{q'\})\}, \{\dot{q}(\{q'\})\})
\end{align}
と定めると、
Euler-Lagrange方程式が形を変えないこと
\begin{align}
  0 &=
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q}_i }
  - \dfrac{\partial L}{\partial q_i }
\notag\\\Rightarrow
0 &=
\dfrac{d}{dt}\dfrac{\partial L'}{\partial \dot{q}'_i }
- \dfrac{\partial L'}{\partial q_i' }
\label{point transformation}
\end{align}
が示される。

\subsubsection{調和振動子の例}

$n$次元調和振動子の場合Lagrangianは
\begin{align}
  L = \sum_{j=1}^n
  \bigg(
    \dfrac{m}{2}\dot{q}_j^2
  -
    \dfrac{m\omega^2}{2} q_j
  \bigg)
\label{harmonic oscillator lagrangian}
\end{align}
であるので、Euler-Lagrange方程式は
\begin{align}
  0 &=
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q}_i }
  - \dfrac{\partial L}{\partial q_i }
\notag\\&=
  \dfrac{d}{dt}
  \bigg(
    m\dot{q}_i
  \bigg)
  -
  \bigg(
  -
    m\omega^2 q_i
  \bigg)
\notag\\&=
    m\ddot{q}_i
  +
    m\omega^2 q_i
\end{align}
となり、確かにNewtonの運動方程式
(\ref{newton harm osci eom})を再現する。
この解については
\ref{classical analysis of harmonic oscillator}節
で詳説する。

\subsection{古典電磁気学}

\subsubsection{Maxwell方程式と  
  Scalar Potential、
  Vector Potential}

古典電磁気学によると、
電荷密度$\rho$および
電流密度$\bm{j}$の存在下で
電場（electric field、
工学の分野では電界とも）
$\bm{E}$
および
磁場（magnetic field、磁束密度、
工学では磁界とも）
$\bm{B}$は
Maxwell方程式
\begin{subequations}
\begin{align}
&\text{電場に関するGaussの法則}:
  &&\nabla \cdot \bm{E}
=
  \frac{\rho}{\epsilon_0}
\label{eq:maxwell-divE}
\\
&\text{磁場に関するGaussの法則}:
  &&\nabla \cdot \bm{B}
= 0
\label{eq:maxwell-divB}
\\
&\text{Faradayの電磁誘導の法則}:
  &&\nabla \times \bm{E}
=
  - \frac{\partial \bm{B}}
    {\partial t}
\label{eq:maxwell-rot E}
\\
&\text{Amp\'ereの法則}:
  &&\nabla \times \bm{B}
=
  \mu_0 \bm{j}
  +
  \mu_0 \epsilon_0
    \frac{\partial \bm{E}}
      {\partial t}
\label{eq:maxwell-rot B}
\end{align}
\end{subequations}
に従う。
定数
$\epsilon_0, \mu_0$をそれぞれ
真空中の誘電率、真空中の透磁率と呼ぶ。
なお、電磁気学においては
媒質中でないこと、
またはそれに加えて
$\rho = 0, \bm{j} = \bm{0}$
であることを指して真空という。
Maxwell方程式を組み合わせ、
滑らかな関数に対して
偏微分の順序を入れ替えてよい事
および公式
(\ref{div rot = 0})を使うと
\begin{align}
  \dfrac{\partial \rho}{\partial t}
+
  \nabla \cdot \bm{j}
=
  \epsilon_0
  \nabla \cdot
  \dfrac{\partial \bm{E}}{\partial t}
+
  \dfrac{1}{\mu_0}
  \nabla \cdot
  \left[
    \nabla \times \bm{B}
  -
    \mu_0 \epsilon_0
    \frac{\partial \bm{E}}
      {\partial t}
  \right]
= 0
\label{electric charge conservation}
\end{align}
が示せる。
この方程式はある点における電荷密度の時間変化
$\dfrac{\partial \rho}{\partial t}$
が、その点に流入する電流
$- \nabla \cdot \bm{j}$
（数学では普通ある領域の境界（これは閉曲面となる）
における法線vectorについて、
領域に対して外向きを正と取る。
ここではそれに合わせて
電流が流入ではなく流出する向きを正に取ったため、
先頭に負号が現れている）
に等しいこと、つまり電荷の保存則
（charge conservation、
the law of conservation of charge、
連続の式（equation of continuity）とも）
を表している。

Poincar\'eの補題により
(\ref{eq:maxwell-divB})は
（少なくとも局所的に）
vector potentialの存在
\begin{align}
  {}^\exists
  \bm{A}
\quad
\text{ s.t. }
\quad
  \nabla \times \bm{A}
=
  \bm{B}
\end{align}
を保証し、
逆に$\bm{A}$を使う限り
(\ref{eq:maxwell-divB})
$\nabla \cdot \bm{B}
= \nabla \cdot
(\nabla \times \bm{A})
= 0$
はベクトル解析の恒等式
(\ref{div rot = 0})から常に成り立つ。

次に
(\ref{eq:maxwell-rot E})は
$\bm{A}$を使って
\begin{align}
  0 =
  \nabla \times \bm{E}
  +
  \frac{\partial \bm{B}}
    {\partial t}
=
  \nabla \times
  \left(
    \bm{E}
    +
    \frac{\partial \bm{A}}
      {\partial t}      
  \right)
\end{align}
となるので、再びPoincar\'eの補題により
scalar potential
\begin{align}
  {}^\exists \phi
\quad
\text{ s.t. }
\quad
  - \nabla \phi
=
  \bm{E}
  +
  \frac{\partial \bm{A}}
    {\partial t}
\end{align}
が局所的に存在し、
(\ref{eq:maxwell-rot E})
も
$\nabla \times
\left(
  \bm{E} +
  \dfrac{\partial \bm{A}}
    {\partial t}
\right)
= - \nabla \times \nabla \phi
= 0$
の形になるため
恒等式(\ref{rot grad = 0})
から自明に成り立つ。

まとめると、vector potential
$\bm{A}$および
scalar potential $\phi$
を用いて電磁場は
\begin{subequations}
\begin{align}
  \bm{E} (t, \bm{x})
&=
  - \nabla \phi (t, \bm{x})
  - \dfrac{\partial \bm{A}}
    {\partial t} (t, \bm{x})
\\
  \bm{B} (t, \bm{x})
&=
  \nabla \times
  \bm{A} (t, \bm{x})
\end{align}
\label{relation between potential and electric or magnetic field}
\end{subequations}
と書け、これらの従うMaxwell方程式は
公式
(\ref{rot rot = grad div - laplacian})
を使って
\begin{subequations}
\begin{align}
  - \frac{\rho}{\epsilon_0}
&=
  - \nabla \cdot \bm{E}
=
  - \nabla \cdot
  \left[
    - \nabla \phi (t, \bm{x})
    - \dfrac{\partial \bm{A}}
      {\partial t} (t, \bm{x})
  \right]
=
  \Delta \phi (t, \bm{x})
  +
    \nabla \cdot
    \dfrac{\partial \bm{A}}
      {\partial t} (t, \bm{x})
\\
  - \mu_0 \bm{j}
&=
  \mu_0 \epsilon_0
    \frac{\partial \bm{E}}
      {\partial t}
  -
  \nabla \times \bm{B}
=
  \mu_0 \epsilon_0
    \frac{\partial}{\partial t}
  \left[
    - \nabla \phi (t, \bm{x})
    - \dfrac{\partial \bm{A}}
      {\partial t} (t, \bm{x})
  \right]
  -
  \nabla \times
    (\nabla \times \bm{A})
\notag\\&
=
  -
  \mu_0 \epsilon_0
  \left[
    \nabla
    \frac{\partial \phi (t, \bm{x})}
      {\partial t}
  +
    \dfrac{\partial^2 \bm{A}}
      {\partial t^2} (t, \bm{x})
  \right]
  -
  \left[
    \nabla
      (\nabla \cdot \bm{A} (t, \bm{x}))
  -
    \Delta \bm{A} (t, \bm{x})
  \right]
\notag\\&
=
  \left[
    - \mu_0 \epsilon_0
    \dfrac{\partial^2}{\partial t^2}
  +
    \Delta
  \right]
    \bm{A} (t, \bm{x})
  -
  \nabla
  \left[
    \mu_0 \epsilon_0
    \frac{\partial \phi (t, \bm{x})}
      {\partial t}
  +
    \nabla \cdot
      \bm{A} (t, \bm{x})
  \right]
\end{align}
\label{maxwell eq of potentials}
\end{subequations}
の$2$本に集約される。

potentialから再び電場や磁場を得るには
単に(\ref{relation between potential and electric or magnetic field})
に代入すればよいのだが、
特に公式
(\ref{3rd order epsilon to delta2 formula})
に気を付けて磁場を成分で書くと
\begin{subequations}
\begin{align}
  & F_{jk} :=
  \partial_j A_k - \partial_k A_j
=
  (\delta_{jn} \delta_{km}
  - \delta_{kn} \delta_{jm})
  \partial_n A_m
=
  \epsilon_{ijk} \epsilon_{inm}
  \partial_n A_m
=
  \epsilon_{ijk} B_i
\\
  & \qquad B_i =
  (\nabla \times A)_i =
  \epsilon_{ijk} \partial_j A_k
=
  \dfrac{1}{2}
  \epsilon_{ijk}
  ( \partial_j A_k
  - \partial_k A_j )
=
  \dfrac{1}{2}
  \epsilon_{ijk}
  F_{jk}
\end{align}
\label{field strength and magnetic field}
\end{subequations}
という相互関係がある事が分かる。
一般論は(\ref{3d hodge and axial vector})を参照のこと。

\subsubsection{静電磁気学（electrostatics）}

力学系や方程式系が時刻$t$に依存しない場合を
静的（static、time-independent、定常とも）という。
静電磁場の従う方程式を得るには
単に
(\ref{maxwell eq of potentials})
から時間微分を含む項を落とせばよく
\begin{subequations}
\begin{align}
  - \frac{\rho}{\epsilon_0}
&=
  \Delta \phi
\label{static eq for ele-mag scalar potential}
\\
  - \mu_0 \bm{j}
&=
  - [
    \nabla
    ( \nabla \cdot \bm{A} )
  -
    \Delta \bm{A}
  ]
=
  - \nabla \times
    (\nabla \times \bm{A})
\label{static eq for ele-mag vector potential}
\end{align}
\end{subequations}
となる。
静的な場合には
電場の方程式と磁場の方程式が
完全に分離しており、
それぞれ独立に解くことが可能であることに
注意しよう。

$3$次元LaplacianのGreen関数
$ - \dfrac{1}{4 \pi r} $
を
(\ref{green function of n dim laplacian})
で求めたので、
公式
(\ref{convolution representation of green function solution})
に代入することで
（Green関数により決まる、
無限遠で十分早く$0$となるという境界条件のもと）
静電場のscalar potentialは
\begin{align}
  \phi (\bm{x})
&=
  \int d^3 x'
  \left[
    - \dfrac{1}{
      4 \pi |\bm{x} - \bm{x}'|
    }
  \right]
  \left[
    - \frac{\rho(\bm{x}')}{\epsilon_0}
  \right]
=
  \int d^3 x'
    \dfrac{\rho(\bm{x}')}{
      4 \pi \epsilon_0
      |\bm{x} - \bm{x}'|
    }
\end{align}
と書けることが分かる。
実際、例えば電荷$q$を持ち
位置$\bm{y}$に固定された点電荷
$\rho(\bm{x})
= q \delta(\bm{x} - \bm{y})$
の場合にこの解は良く知られた
Coulomb potential
\begin{align}
  \phi (\bm{x})
&=
  \int d^3 x'
    \dfrac{
      q \delta(\bm{x}' - \bm{y})
    }{
      4 \pi \epsilon_0
      |\bm{x} - \bm{x}'|
    }
=
    \dfrac{ q }{
      4 \pi \epsilon_0
      |\bm{x} - \bm{y}|
    }
\label{coulomb potential of point charge}
\end{align}
を確かに再現する。

一方で、
vector potentialの従う方程式
(\ref{static eq for ele-mag vector potential})
を解くためには、第$1$項を落とした方程式
\begin{align}
  \mu_0 \bm{j}
&=
  -
    \Delta
    \bm{C}
\end{align}
がscalar potentialと同様にすると
簡単に解けて、
解が
\begin{align}
  \bm{C} (\bm{x})
&=
  \int d^3 x'
  \left[
    - \dfrac{1}{
      4 \pi |\bm{x} - \bm{x}'|
    }
  \right]
  \left[
    - \mu_0
    \bm{j} (\bm{x}')
  \right]
=
  \int d^3 x'
    \dfrac{
      \mu_0 \bm{j} (\bm{x}')
    }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
\end{align}
となる事を使うとよい。
$\bm{x}$に対する微分を$\nabla$、
$\bm{x}'$に対する微分を$\nabla'$と書くと、
部分積分により
\begin{align}
  \nabla \cdot \bm{C}(\bm{x})
&=
  \int d^3 x'
    \nabla \cdot
    \dfrac{
      \mu_0 \bm{j} (\bm{x}')
    }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
=
  \int d^3 x'
    \bm{j} (\bm{x}')
  \cdot
    \nabla
    \dfrac{ \mu_0 }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
\notag\\&
=
  \int d^3 x'
    \bm{j} (\bm{x}')
  \cdot
    \nabla'
    \dfrac{ -\mu_0 }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
\notag\\&
=
  \int d^3 x'
    \dfrac{ \mu_0 }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
    \nabla' \cdot \bm{j} (\bm{x}')
\end{align}
となるが、
電荷の保存則
(\ref{electric charge conservation})
は静的な場合には単に
$\nabla \cdot \bm{j} = 0$
であるので$\nabla \cdot \bm{C} = 0$
が分かる。
すなわち$\bm{C}$は実は
vector potentialの満たすべき方程式
(\ref{static eq for ele-mag vector potential})
を満たしており、
静的な電流の作る磁場は
\begin{align}
  \bm{A} (\bm{x})
&=
  \bm{C} (\bm{x})
=
  \int d^3 x'
    \dfrac{
      \mu_0 \bm{j} (\bm{x}')
    }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
\end{align}
と求まるのである。
これはCoulomb gauge
$\nabla \cdot\bm{A} = 0$
を取ったことに相当する。
実際、
この解はよく知られた
Biot-Savart（ビオ・サバール）の法則
\begin{align}
  \bm{B}
&=
  \nabla \times \bm{A}
=
  \int d^3 x'
  \nabla \times
    \dfrac{
      \mu_0 \bm{j} (\bm{x}')
    }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
=
  \int d^3 x'
  \bm{j} (\bm{x}') \times
  \nabla
    \dfrac{
      - \mu_0
    }{
      4 \pi
      |\bm{x} - \bm{x}'|
    }
% \notag\\&
=
  \int d^3 x'
  \bm{j} (\bm{x}') \times
    \dfrac{
      \mu_0
      (\bm{x} - \bm{x}')
    }{
      4 \pi
      |\bm{x} - \bm{x}'|^3
    }
\end{align}
を再現する。
\footnote{
  あるいは
  $\bm{j}(\bm{x}')$に平行で同じ向きの
  線素$d \bm{l}'$および
  それに垂直な微小曲面$dS'$に対応する
  面素$d \bm{S}'$を用いて
  $d^3 x' = d \bm{l}' \cdot d \bm{S}'$
  かつ
  $I = \int_{S'} d \bm{S}' \cdot \bm{j}(\bm{x}')$
  （$I$は面$S'$を貫く電流）
  に注意すると、微小形で
  \begin{align}
    d \bm{B}
  &=
    \left[
      d \bm{l}' \cdot
      \int_{S'} d \bm{S}'
    \right]
    \nabla \times
      \dfrac{
        \mu_0 \bm{j} (\bm{x}')
      }{
        4 \pi
        |\bm{x} - \bm{x}'|
      }
  =
    \left[
      d \bm{l}' \cdot
      \int_{S'} d \bm{S}'
    \right]
    \bm{j} (\bm{x}') \times
      \dfrac{
        \mu_0
        (\bm{x} - \bm{x}')
      }{
        4 \pi
        |\bm{x} - \bm{x}'|^3
      }
  \notag\\&
  =
    \int_{S'}
      [d \bm{S}' \cdot \bm{j} (\bm{x}')]
    d \bm{l}' \times
      \dfrac{
        \mu_0
        (\bm{x} - \bm{x}')
      }{
        4 \pi
        |\bm{x} - \bm{x}'|^3
      }
  =
    I d \bm{l}'
    \times
      \dfrac{
        \mu_0
        (\bm{x} - \bm{x}')
      }{
        4 \pi
        |\bm{x} - \bm{x}'|^3
      }
  \end{align}
  と書いても同じである。
}

\subsubsection{真空中の電磁波解}

真空中$\rho = \bm{j} = 0$の
Maxwell方程式
\begin{subequations}
\begin{align}
  \nabla \cdot \bm{E}
&=
  0
\\
  \nabla \cdot \bm{B}
&= 0
\\
  \nabla \times \bm{E}
&=
  - \frac{\partial \bm{B}}
    {\partial t}
\\
  \nabla \times \bm{B}
&=
  \mu_0 \epsilon_0
    \frac{\partial \bm{E}}
      {\partial t}
\end{align}
\end{subequations}
または
\begin{subequations}
\begin{align}
  0
&=
    \Delta \phi (t, \bm{x})
  +
    \nabla \cdot
    \dfrac{\partial \bm{A}}
      {\partial t} (t, \bm{x})
\\
  0
&=
  \left[
    - \mu_0 \epsilon_0
    \dfrac{\partial^2}{\partial t^2}
  +
    \Delta
  \right]
    \bm{A} (t, \bm{x})
  -
  \nabla
  \left[
    \mu_0 \epsilon_0
    \frac{\partial \phi (t, \bm{x})}
      {\partial t}
  +
    \nabla \cdot
      \bm{A} (t, \bm{x})
  \right]
\end{align}
\label{maxwell eq of potentials in vacuum}
\end{subequations}
を考えよう。

\subsection{Vector Potential}

Helmholtzの定理(\ref{helmholtz decomposition theorem})によると、
$3$次元空間上のvector場$\bm{F}(x)$は
vector potentialとscalar potentialにより書けるのであった。
scalar potential $V(\bm{x})$で書かれる
保存力の下での運動は既に定式化したので、
次は話を$3$次元に限り、
vector potentialで書かれる力の例として
磁場を解析力学の枠組みで扱うことにしよう。
なお、以下ではvector potential
$\bm{C}(\bm{x})$
を使って書かれる一般の力
\begin{align}
  \bm{F}(\bm{x}) = \nabla \times \bm{C}(\bm{x})
\end{align}
を扱っているわけではない事に注意されたい。

\subsubsection{電磁場中の荷電粒子のLagrangian}

電荷を持つ粒子を
荷電粒子（charged particle）というが、
電荷$+q$の荷電粒子を
電磁場(\ref{maxwell eq of potentials})
の中に置くと
Lorentz force（ローレンツ力）
\begin{align}
  \bm{F}
  &=
  q
  \Big[
    \bm{E}
  +
   \dot{\bm{x}}
    \times
    \bm{B}
  \Big]
\notag\\&=
  q
  \Big[
    - \nabla\phi
    - \dfrac{\partial \bm{A}}
      {\partial t}
  +
   \dot{\bm{x}}
    \times
    \Big(
      \nabla \times \bm{A}
    \Big)
  \Big]
\label{lorentz force for charged point particle}
\end{align}
を受ける
（うるさいことを言うと
荷電粒子が存在するだけで
その周りにCoulomb potentialが生じるし、
他にも制動放射（bremsstrahlung）という現象があり、
荷電粒子が加速すると電磁波を出すので
$\bm{E}$とか$\bm{B}$も変わってしまうのだが、
以降の議論ではこのような電磁波が無視できるほど
電磁場$\bm{E}, \bm{B}$が大きいとする
\footnote{
  もっとうるさいことを言うと、
  この輻射（粒子自身が出す電磁波）の影響を取り入れて計算すると
  Abraham-Lorentz-Dirac方程式と呼ばれる
  時間の3階微分を含む運動方程式が得られる。
  これは相対論的な共変性とか因果律を破り、
  外場がないのに増大する訳の分からない解（runaway solution）を持つ。
  特殊な状況下ではLandau-Lifshitz方程式という
  ある程度振る舞いのいい運動方程式に帰着するものの、
  最も一般の場合については未だ未解決である
  \cite{Abraham-Lorentz}。
  }。
このように系の時間発展により影響を受けない
系外から系への影響を、
総称して外場（external field）という）。
このLorentz力を再現するLagrangian $L'$は、
電磁場がない場合のLagrangian $L = T - V$
（ただし$V$に静電potential $\phi$は含めていない）
を使って
\begin{align}
  L' = L - q(\phi - \dot{\bm{x}} \cdot \bm{A})
\label{point particle lagrangian with ele-mag potential}
\end{align}
で与えられる。
実際、このときのEuler-Lagrange方程式は
\begin{align}
  0
&=
  \dfrac{d}{dt}
    \dfrac{\partial L'}{\partial \dot{x}_i}
  -
    \dfrac{\partial L'}{\partial x_i}
=
  \dfrac{d}{dt}
    \dfrac{\partial L}{\partial \dot{x}_i}
  -
    \dfrac{\partial L}{\partial x_i}
- q \left[
  \dfrac{d}{dt}
    \dfrac{\partial}{\partial \dot{x}_i}
      (\phi - \dot{x}_j A_j)
  -
    \dfrac{\partial}{\partial x_i}
      (\phi - \dot{x}_k A_k)
\right]
\label{EL eq for charged point particle}
\end{align}
であり、新しく現れた項は
potentialが位置$\bm{x}$のみに依存し
速度$\dot{\bm{x}}$には依存しない事に気を付けると
\begin{align}
  &
- q \left[
  \dfrac{d}{dt}
    \dfrac{\partial}{\partial \dot{x}_i}
      (\phi - \dot{x}_j A_j)
  -
    \dfrac{\partial}{\partial x_i}
    \left\{
      (\phi - \dot{x}_k A_k)
    \right\}
\right]
=
- q \left[
  - \dfrac{d}{dt}
    \delta_{ij} A_j
  -
    \left\{
      \dfrac{\partial \phi}{\partial x_i}
    -
      \dot{x}_k
      \dfrac{\partial A_k}{\partial x_i}
    \right\}
\right]
\notag\\&
=
  q \left[
  \dfrac{d A_i}{dt}
  +
    \left\{
      \dfrac{\partial \phi}{\partial x_i}
    -
      \dot{x}_k
      \dfrac{\partial A_k}{\partial x_i}
    \right\}
\right]
=
q \left[
    \dfrac{\partial A_i}{\partial t}
  +
    \dot{x}_k
    \dfrac{\partial A_i}{\partial x_k}
  +
    \dfrac{\partial \phi}{\partial x_i}
  -
    \dot{x}_k
    \dfrac{\partial A_k}{\partial x_i}
\right]
\notag\\&
=
q \left[
    - E_i
  +
    \dot{x}_k
    \left(
      \dfrac{\partial A_i}{\partial x_k}
    -
      \dfrac{\partial A_k}{\partial x_i}
    \right)
\right]
\end{align}
と書ける。
最後に関係
(\ref{field strength and magnetic field})
から
\begin{align}
  \dot{x}_k
  \left(
    \dfrac{\partial A_i}{\partial x_k}
  -
    \dfrac{\partial A_k}{\partial x_i}
  \right)
&=
  \epsilon_{nki} \dot{x}_k B_n
=
  - \big(
    \dot{\bm{x}} \times \bm{B}
  \big)_i
\end{align}
が分かるので、Euler-Lagrange方程式
(\ref{EL eq for charged point particle})
は
\begin{align}
  0
&=
  \dfrac{d}{dt}
    \dfrac{\partial L}{\partial \dot{x}_i}
  -
    \dfrac{\partial L}{\partial x_i}
- q \left[
    E_i
  + \big(
      \dot{\bm{x}} \times \bm{B}
    \big)_i
\right]
\end{align}
のように正しくLorentz力
(\ref{lorentz force for charged point particle})
を再現している。

$n$粒子系への拡張は容易である。
これらの荷電粒子間のCoulomb potential
(\ref{coulomb potential of point charge})
は真空の誘電率$\epsilon_0$を使って単に
\begin{align}
  U(\bm{x}_1, \dots, \bm{x}_n)
  :=
  \sum_{1 \le i < j \le n}
  \dfrac{1}{4 \pi \epsilon_0}
  \dfrac{q_i q_j}{|\bm{x}_i - \bm{x}_j|}
  =
  \dfrac{1}{2}
  \sum_{i \neq j}
  \dfrac{1}{4 \pi \epsilon_0}
  \dfrac{q_i q_j}{|\bm{x}_i - \bm{x}_j|}
\end{align}
となる
（全ての$i, j$の組について足し上げると
同じ項が必ず$2$回ずつ現れてしまう事を考慮し、
和の範囲を制限した。
\footnote{
  いずれにしても$i = j$の和は取らない。
  点電荷の作るCoulomb potentialは原点で特異的なので、
  点電荷自身には無限大の斥力が掛かっている事になる。
  $i = j$に対応するのはこの斥力を表す項であり、
  （無限大ではあるが）定数なのでLagrangianに加えても加えなくても
  運動方程式の形を変えないため無視してよい。
  あるいは別の解釈として、
  点電荷がこの斥力により「飛び散って」しまわないよう
  点電荷にPoincar\'e応力（Poincar\'e stress）
  と呼ばれる電子を「固める」力が働いていると思ってもよい。
  この立場では、Poincar\'e応力の項が
  $i = j$の項を逆符号で打ち消している。

  何にせよ、矛盾にも思えるこの古典的な描像は
  場の量子論に移ることで自然に解決されるので、
  深く気にする必要はない。
}
また、我々のconventionでは
$\phi$はあくまで外場なので、
dynamicalな粒子が作るpotential
$U$に相当する項はその中に入れていない）。
また、各粒子が放射する電磁波は
無視できるという仮定を置いていたので、
ある粒子が他の粒子に電磁波を通じて影響を与えることはない。
従って
複数の粒子を扱うにも単に同様の項を足し上げればよく、
各粒子の電荷を$q_i$、位置を$\bm{x}_i$として
\begin{align}
  L' = L
  -
  U(\bm{x}_1, \dots, \bm{x}_n)
  -
  \sum_i
  q_i\Big[
    \phi(\bm{x}_i)
  -
    \dot{\bm{x}}_i \cdot \bm{A}(\bm{x}_i)
  \Big]
\label{many point particle lagrangian with ele-mag potential}
\end{align}
のようにすればよい。

\subsection{対称性}

Euler-Lagrange方程式を導く際、
我々は任意の変分$\delta q(t)$のもとで
作用の変分$\delta S$が消えることを要求し、
作用を停留する特別な$q(t)$を得た。
逆に、力学変数の任意の関数形$\forall q(t)$に対し、
変分に限らないある特別な変数変換（transformation）
$q \mapsto q + \delta^{\mathrm{sym}} q$のもとで
作用が変化しない場合、
この特別な変数変換$\delta^{\mathrm{sym}} q$は系の対称性（symmetry）である、という。
多くの系に現れる対称性変換の代表的な例を見てみよう。
\begin{itemize}
  \item{Time Reversal Symmetry（時間反転）}
  \begin{align}
    \begin{cases}
      q_0 = t \mapsto -t
      \\
      \delta^{\mathrm{sym}} q
      =
      \delta^{\mathrm{t.r.}} q [q](t)
      := -q(t) + q(-t)
      \\
      \dot{q} \mapsto -\dot{q}
    \end{cases}
  \end{align}
  \item {Time-Translational Symmetry（時間並進対称性）}
  \begin{align}
    \begin{cases}
      q_0 = t \mapsto t - t_0
      \\
      \delta^{\mathrm{sym}} q
      =
      \delta^{\mathrm{t.t.}} q[q](t; t_0)
      := -q(t) + q(t-t_0)
    \end{cases}
  \label{time translation}
  \end{align}
  \item {座標$q_i$についてのReflection Symmetry（鏡像対称性）}
  \begin{align}
    \delta^{\mathrm{sym}} q_j
    =
    \delta^{\mathrm{ref.}} q_j
    :=
    \begin{cases}
    - 2 q_i
    \qquad &(i = j)
    \\
    0
    \qquad &(i\neq j)
    \end{cases}
  \end{align}
  \item {Parity Symmetry（空間反転対称性）}
  \begin{align}
      \delta^{\mathrm{sym}} q_i
      =
      \delta^{\mathrm{parity}} q_i
      := - 2 q_i
  \qquad
  (\forall\ i)
  \end{align}
  \item {Translational Symmetry（空間並進対称性）}
  \begin{align}
    \delta^{\mathrm{sym}} q_i
    &=
    \delta^{\mathrm{trans}}q_i (\{a\} )
    := a_i
    ,\qquad\text{$a_i$: constant for $\forall\ i$}
  \end{align}
  \item {Rotational Symmetry（空間回転対称性）}
  \begin{align}
    &\quad\delta^{\mathrm{sym}} q_i
    =
    \delta^{\mathrm{rot}}q_i ( O )
    := -q_i + O_i{}^j q_j
    ,\\
    &\text{$O$: orthogonal matrix
    (i.e.
      $O^T O = I$, or
      $O_k{}^i O_k{}^j
      =:
      (O^T)^i{}_k O_k{}^j
      =
      \delta^{ij}$)}
  \notag
  \end{align}
\end{itemize}
ただし表記の簡単化のために
$q_0 := t$も正準変数のように見做し、
Einsteinの和の規約
（$1$つの項に同じ添え字が$2$度出てきたときには
その添え字について和を取る）を採用した。
このように、変換を記述するのに必要な
parameterの個数は変換ごとに異なり、
変換によっては$q(t)$の関数形を知らなければ
記述できないもの
（すなわち変換が汎関数であるもの。$[q]$と示した）も存在する。

より一般に、一定の規則に従って変数変換や
parameterの置き換えなど何らかの操作を行い、
考えている力学系から新たな力学系を得ることを変換といい、
ある変換$T$の下で元と同じ系が得られる
（系が変換前と全く同じ力学法則によって記述される）とき
$T$は系の対称性（symmetry）、
あるいは不変性（invariance）であるという。
時に、
\ref{representation of Lorentz group}節で扱うLorentz対称性のように
見た目は異なるが全く同じ内容の方程式を与えるときはinvariance、
方程式が全く変わらない場合をsymmetryと区別することもある。
特に、potentialや作用の形が異なる物理系の間で
全ての観測量について予言が一致するような
非自明な例はdualityとして知られており、
弦理論に現れるmirror symmetryのように
時折symmetryとほぼ区別しない用法で用いられる。

弦理論でnear-horizon極限のような特定の極限を取るとT-dualityやD-braneを駆使して
同じ理論を異なる複数の仕方で記述することが出来、
複数の異なる理論の間に非自明なdualityを与えられる場合がある。
例えばAdS/CFT correspondence
(AdS/CFT対応、
よりmodernにはgauge/gravity対応とも呼ばれる)
の代表的な例では
GKP-Witten relationなどの関係式により
5次元$\rm{AdS}_5(\times S^5)$時空上の
古典type-IIB超重力理論の物理量と
4次元CFTの例である$\mathcal{N}=4$ Super Yang-Mills理論の
（Large-$N$極限での）物理量とを関係付けることが出来る。
他にも$2$次元CFTと$4$次元gauge理論との間に対応を与えるAGT correspondenceや、
異なるgauge群を持つgauge理論が低energy極限で同じ予言をするSeiberg dualityなど、
様々な形のdualityが具体的に調べられている。
これらのdualityによると、
普通の摂動展開では調べることの難しい
場の理論の強結合領域などを調べることが出来る場合があるため、
現在でも（十分数学的に）理解されていない
quarkのconfinement（閉じ込め）の理解、
black holeの量子論的な性質を介した
量子重力の理論の解明などに向け
精力的に研究されている。

\subsubsection{連続な対称性とNoetherの定理、保存電荷}

Noetherの定理は
系に連続的な対称性が存在するとき、
必ず対応する保存量（時間に依らず一定であるような量）が
存在する事を主張する。
この保存量をelectric chargeが保存することのanalogyにより
Noether chargeと呼び、
電荷と訳す（が、一般にはelectric chargeとは全く関係ない）。
以下では具体的にNoether chargeを構成しよう。
ただし、対称性変換がGalilean time $t$
についてlocal
（この用語は場の理論からの流用、\ref{locality}を見よ）
であること、
すなわち変換後のLagrangianが
ある時刻$t$の情報$q(t), \dot{q}(t)$のみを用いて書ける事を仮定する。
例えばtime-translation(\ref{time translation})変換後の
Lagrangianは同一時刻$t - t_0$の力学変数のみを使って書けるので許されるが、
変換後のLagrangianに
$q(t)q(t-t_0)$のような項が現れることは許さない。

連続でlocalな変換を、$m$個の実数parameter
$\theta_a (a=1,\dots,m)$を用いて
\begin{align}
  q_i(t) \mapsto q_i(t) +
  \delta^{\mathrm{sym}} q_i[\{ q \}] (t, \{\theta\})
\end{align}
のように書こう。
\footnote{
  以下の議論は通常の教科書で見るものより冗長だが、
  対称性変換が恒等変換
  （identity、つまり何もしない変換）のまわりの
  無限小変換として実現されることを仮定せずに済む。
  例えば相対論で現れるLorentz変換は
  数学的には不定値直交群$SO(3,1)$で表され、
  恒等変換と連続的に繋がらない$3$つの部分を含む
  $4$つの部分集合からなるので、
  このような場合にも$4$つの部分集合それぞれに
  独立な証明が出来ることは重要である。
}
ただし今回は$\delta^{\mathrm{sym}} q_i$は変分ではないため、
微小と仮定する必要はない。
また、変換前の運動方程式に無かった2階以上の時間微分
$\ddot{q}, \dddot{q},\dots$が運動方程式に現れるとき
変換は明らかに対称性ではないので、
対称性変換の右辺には$q, \dot{q}$しか現れないとして一般性を失わない。
結局parameter $\theta_a = \theta_a^0$を固定しておく限り、
対称性変換はlocalityの仮定から
一般座標変換(\ref{point transformation})と
time-translation(\ref{time translation})の組み合わせを
与えるだけだと分かり、
これらをまとめて
\begin{align}
  q'_i( \{ q(t') \}, \{ \dot{q}(t') \} )
    \Big|_{t' = t - t_0}
  := q_i(t) +
  \delta^{\mathrm{sym}} q_i[\{ q \}] (t, \{\theta^0\})
\end{align}
と書くことにする。

無限小（infinitesimal）量$\epsilon$を、$\epsilon^2 = 0$かつ
任意の関数$f(x)$について
$f(x+\epsilon)=f(x) + \epsilon \dfrac{df(x)}{dx}$
が厳密に成り立つような量と定義する
（このような量は数学的には
超準解析（nonstandard analysis）により正当化されるが、
ここではこれ以上触れない）。
対称性変換が連続であることを仮定したので、
$q'$を与えるparameter $\theta_a^0$に対して
$\theta_a^0 + \epsilon_a$も対称性変換を与える。
この新たな変換
\begin{align}
  q_i(t) +
  \delta^{\mathrm{sym}} q_i[\{ q \}] (t, \{\theta^0 + \epsilon\})
  =:
  q'_i( \{ q(t') \}, \{ \dot{q}(t') \} )
    \Big|_{t' = t - t_0}
  + \epsilon_a \delta^a q'_i
\end{align}
によって$\delta^a$を定義しよう
（次の節で詳しく議論するが、
右辺の量は全て時刻$t' = t - t_0$で評価している）。
同じことだが、
\begin{align}
  \delta^a q'_i :=
  \dfrac{\partial
    (\delta^{\mathrm{sym}} q_i)
  }{
    \partial \theta_a
  }
  \Bigg|_{\{\theta\} = \{\theta^0\}}
\end{align}
と定義したと思っても良い。
$\delta^a q'_i
= \partial^a \delta^{\mathrm{sym}} q'_i$
（ただし$\partial^a := \dfrac{\partial}{\partial \theta_a}$）
の定義が
$\epsilon_a$と独立であることに注意せよ。

さて、ここまで$q(t)$は運動方程式の解に限らない
任意の時間の関数であった。
ここで初めて
$q'$についての運動方程式(\ref{point transformation})を解き、
その解を改めて$q'(t)$と呼ぶ事にする。
Lagrangianが対称性変換のもとで不変であるとき、
解$q'(t)$に対し
$m$個のNoether charge $Q^a(t)$を
\begin{align}
  Q^a(t):=
  \sum_i
    \delta^a q'_i (t)
  \dfrac{\partial L}{\partial \dot{q}'_i} (t)
\end{align}
で定義すると、
その時間微分は
\begin{align}
  \dfrac{d Q^a(t)}{dt}
&=
  \sum_i
  \bigg\{
    \delta^a q'_i
  \dfrac{d}{dt}\dfrac{\partial L}{\partial \dot{q}'_i }
+
    \delta^a \dot{q}'_i
    \dfrac{\partial L}{\partial \dot{q}'_i}
  \bigg\}
\notag\\&=
  \sum_i
  \bigg\{
      \delta^a q'_i
    \dfrac{\partial L}{\partial q'_i}
  +
      \delta^a \dot{q}'_i
    \dfrac{\partial L}{\partial \dot{q}'_i}
  \bigg\}
\notag\\&\qquad
    \text{
      $\because$ Euler-Lagrange equation
      (\ref{Euler-Lagrange for point masses})
    }
\notag\\&=
  \partial^a L(q'(t),\dot{q}'(t),t)
  \notag\\&= 0
\end{align}
と計算できる。
ただし$\delta^{\mathrm{sym}}$が対称性であること、
すなわち作用の不変性からLagrangianが
変換parameterに依らない場合
$\partial^a L = 0$
に話を限った。
仮に作用は変化しないがLagrangianが変化を受ける場合、
例えばLagrangianの変化分が
\begin{align}
  \delta L &:= L( q' + \epsilon_a \delta^a q' ) - L( q' )
  = \epsilon_a \dfrac{d \mathcal{K}^a}{dt}
  ,\notag\\
  \delta S &= \int dt \delta L
  = \epsilon_a \int dt \dfrac{d \mathcal{K}^a}{dt}
  = \text{(surface term)}
\end{align}
のように時間の全微分で書ける場合も、
対応するNoether chargeを
\begin{align}
  Q^a(t):=
  \sum_i
    \delta^a q'_i (t)
  \dfrac{\partial L}{\partial \dot{q}'_i} (t)
  -
  \mathcal{K}^a
\end{align}
と再定義すればこれは保存量となる。
対称性の定義は任意の関数$q(t)$に対して
変換を施した際に
作用が変化しないことを要求するので、
Lagrangianに生じ得る変化は
上の$2$例で尽きている
（ように思われる。
最も一般の場合にこれ以外の変化が許されるか、
考えてみよ）。
作用はその時間積分なので、
あとは積分区間に生じ得る変化を次節で議論すれば
作用の変化への寄与を全て考慮できている。

以上で$Q$が保存量であると示せたことになる。

\subsubsection{一般化されたNoetherの定理の証明}

上の議論では無限小の変換$\epsilon_a \delta^a$に伴って
Galilean time parameter $t$が変化する場合を無視した。
以下では
\begin{align}
  t
  \mapsto t + \delta t
  =: t + \epsilon_a \delta^a t
\end{align}
のような変化がある
場合にもNoether chargeに対応する量
\begin{align}
  F^a(t):=
    \delta^a q'_i (t)
  \dfrac{\partial L}{\partial \dot{q}'_i} (t)
-
  \delta^a t
  \ 
  L
\end{align}
が保存する事を確かめる。
対称性が連続であったので、
constant parameter $\theta_a^0$と$\theta_a^0 + \epsilon_a$
による変換は任意の時間の関数$q(t)$に対し
同一の作用を与えるはずである：
\begin{align}
  0 &=
  \delta_{\epsilon} S
\notag\\&:=
  S\left[ q + \delta^{\mathrm{sym}} q\Big|_{\theta^0 + \epsilon} \right]
  -
  S\left[ q + \delta^{\mathrm{sym}} q\Big|_{\theta^0} \right]
\notag\\&=
  S\left[ q' + \epsilon_a \delta^a q' \right]
  -
  S\left[ q' \right]
\notag\\&=
  \int_{t_i + \delta t}^{t_f + \delta t} dt\ 
    L( q' + \epsilon_a \delta^a q' )
  -
  \int_{t_i}^{t_f} dt\ 
    L( q' )
\notag\\&=
  \int_{t_i}^{t_f} dt\ 
  \bigg[
    L( q' + \epsilon_a \delta^a q' )
    - \delta t
    \dfrac{d}{dt}
    L( q' + \epsilon_a \delta^a q' )
  -
    L( q' )
  \bigg]
\notag\\&=
  \int_{t_i}^{t_f} dt
  \bigg[
    \epsilon_a
    \delta^a q'_i
    \dfrac{\partial L}{\partial q'_i}
  +
  \dfrac{d}{dt}
    (\epsilon_a
    \delta^a q'_i)
    \dfrac{\partial L}{\partial \dot{q}'_i}
  -
    \epsilon_a
    \delta^a t
    \ 
    \dfrac{d}{dt}
    L
  \bigg]
\notag\\&=
    \epsilon_a
  \bigg(
  \int_{t_i}^{t_f} dt
  \bigg[
    \delta^a q'_i
    \dfrac{\partial L}{\partial q'_i}
  +
    \dfrac{d}{dt}
    (\delta^a q'_i)
    \dfrac{\partial L}{\partial \dot{q}'_i}
  -
    \delta^a t
    \ 
    \dfrac{d}{dt}
    L
  \bigg]
  \bigg)
\label{action difference under symmetry transformation}
\end{align}
繰り返し強調しているように、
対称性変換は変分
（粒子の位置自体を時間の関数として変化させる）
ではなく、
粒子の同じ時間発展を異なる変数によって記述する変数変換である。
いま議論しているのは
この変数変換に時間parameter $t$自体の変化も含める場合で、
それに伴って現れた$\delta t$に比例する項は
数学的にはLie微分
（変数変換の前後で、同じ座標『値』における関数の値を比較する）
を取っていることに相当する。
変換前の$t$と変換後の$t + \delta t$とは
物理的には同じ時刻を表すが、
変換前の$t$と変換後の$t$は物理的に異なる時刻を表すことに注意しよう。
Lie微分で比較するのは後者である。

さて、$\epsilon_a$の値は
無限小であるという他は全く任意であるので、
右辺は$\epsilon_a$の多項式として
恒等的に消えなければならない。
また、ここまで$q'(t)$が
運動方程式の解であることを仮定していなかったが、
ここで初めてEuler-Lagrange方程式
(\ref{Euler-Lagrange for point masses})
を用いると
\begin{align}
  0 &=
  \int_{t_i}^{t_f} dt
  \bigg[
    \delta^a q'_i
    \dfrac{d}{dt}
    \dfrac{\partial L}{\partial \dot{q}'_i}
  +
    \dfrac{d}{dt}
    (\delta^a q'_i)
    \dfrac{\partial L}{\partial \dot{q}'_i}
  -
    \delta^a t
    \ 
    \dfrac{d}{dt}
    L
  \bigg]
\notag\\&=
  \int_{t_i}^{t_f} dt
  \dfrac{dF^a(t)}{dt}
\end{align}
が得られる。
対称性の定義は任意の時間の関数
$q'(t)$に対して上の量が消えることであるので、
当然$q'(t)$が運動方程式の解である場合にも上の量は消えていなければならない。
また、対称性の定義は
$t_i, t_f$を特定の値に選んだ時のみならず、
任意の$t_i, t_f$に対して上の量が消えることを要求する。
以上から保存則
\begin{align}
  \dfrac{dF^a(t)}{dt} = 0
\end{align}
が無事導かれたことになる。
既に見たように、$\delta t = 0$の場合には
これはLagrangianが変換parameterによらないという条件と同じであることが分かるだろう。

最後に$\delta t$を含めた対称性変換に対応する保存量の例を挙げておこう：以下で定義するHamiltonian
(\ref{hamiltonian definition})は
$m=1, \theta_1 = t_0$を変換parameterとする
時間並進対称性
$\delta q' = \dot{q}', \delta t \neq 0$ (const.)
のもとでの保存量と見做すことが出来る。
あるいは前節の表面項がある場合のNoether chargeで
$\mathcal{K}=L$としたものと思ってよい。
（が、その場合は$t$の変換ではなく
$q(t)$の変分
\begin{align}
  q(t) \to q(t-\delta t)
  = q(t) - \delta t \dot{q}(t)
\end{align}
のもとで
作用のLie微分ではなく変分を計算していることになるので、
作用の積分区間は
変換後の時間座標でも$(t_i, t_f)$のままで変わらない。
Lagrangianが全微分
$- \delta t \dfrac{d L}{dt}$
だけ変化するため、
作用は不変である。
最初からこの易しい解釈を導入しなかったのは単に、
scalar場の他にvectorやtensor量も含む
場の理論におけるNoetherの定理の証明には
Lie微分を使う方が簡単だからである。）

\subsubsection{対称性のgauge化}

無限小量に値を取る$m$個の時間の関数$\epsilon_a (t)$
を用意しよう。
$\delta^a q_i$の定義は
$\epsilon_a$に依っていなかったので、
$\epsilon_a(t) \delta^a q_i$は変数変換ではなく無限小の変分と見做せる。
このようにconstantであった対称性変換のparameterを
時空に依存する関数（つまり場）に置き換える操作を
対称性のgauge化（gauging）と言う。

さて、対称性変換のgauge化によって定義される変分のもとで、
作用がどう変化するか見てみよう。
基本的には(\ref{action difference under symmetry transformation})
と同様の計算をすれば良いが、
今度は$\epsilon_a$の微分は$0$ではないし、
$\epsilon_a$を積分の外には出せないし、
作用の変化分が$0$になるとも限らない：
\begin{align}
  \delta_{\epsilon(t)} S
  &:=
  \int_{t_i}^{t_f} dt
  \ 
  \epsilon_a(t)
  \delta^a q_i
  \bigg[
    \dfrac{\partial L}{\partial q_i}
  -
  \dfrac{d}{dt}
    \dfrac{\partial L}{\partial \dot{q}_i}
  \bigg]
  +
  \int_{t_i}^{t_f} dt
  \ 
  \dfrac{d}{dt}
  \bigg[
    \epsilon_a(t)
    \delta^a q_i
    \dfrac{\partial L}{\partial \dot{q}_i}
  -
    \epsilon_a(t)
    \delta^a t
    \ 
    L
  \bigg]
\notag\\&=
  \int_{t_i}^{t_f} dt
  \ 
  \epsilon_a(t)
  \delta^a q_i
  \bigg[
    \dfrac{\partial L}{\partial q_i}
  -
  \dfrac{d}{dt}
    \dfrac{\partial L}{\partial \dot{q}_i}
  \bigg]
  +
  \int_{t_i}^{t_f} dt
  \ 
  \dfrac{d}{dt}
  \bigg[
    \epsilon_a(t)
    F^a(t)
  \bigg]
\end{align}
単に特別な類の変分を取っただけだから
第1,2項がEuler-Lagrange方程式に現れる形であるのは当然だが、
全微分で書かれる
新たな項が現れているのは興味深い。
Euler-Lagrange方程式が成り立つ場合であっても、
これまで無視していた表面項が
作用の変化に非自明な寄与をし得ることが分かる。
対称性がgauge化された後も対称性であり続ける場合、
これをgauge対称性と言う。
素粒子理論においては全ての相互作用が
ある種のgauge対称性により記述されることが知られており、
逆に作用がgauge対称性を持つことを要求すると
作用に入り得る項の形も強く制限される。
この要求をgauge原理と呼ぶことがある。

\subsection{Hamilton力学}

一般にEuler-Lagrange方程式は各変数$q_i$の
高階の微分を含む、複雑な方程式系となる。
変数を増やす代わりに、
低次の微分で書ける方程式系を見付けたいと思うのも自然な発想である。
Lagrangian $L(\{q\},\{\dot{q}\})$に
新しい変数$\{p\}$を導入する代わりに
$\dot{q}_i$を消去し、
Euler-Lagrange方程式と等価な微分方程式系を得ることを考えよう。

一般化運動量を
\begin{align}
  p_i := \dfrac{\partial L}{\partial \dot{q}_i}
\label{generalized momentum}
\end{align}
で定義する。
一般に$\det \dfrac{\partial^2 L}{\partial \dot{q}_i \partial \dot{q}_j } \neq 0 $
であれば
$p$の定義式を$\dot{q}_i$について
\begin{align}
  \dot{q}_i = \dot{q}_i(\{q\},\{p\},t)
\end{align}
のように解く事が出来、
\footnote{
  このような逆解きが出来ない力学系を
  特異Lagrange系と呼ぶ。
  gauge理論などは場の理論における特異系の例である。
}
従って$\dot{q}_i$を方程式系から消去できる。
Euler-Lagrange方程式は
\begin{align}
  \begin{cases}
    \dot{p}_i = \dfrac{\partial L}{\partial q_i}
\\    \\
      p_i = \dfrac{\partial L}{\partial \dot{q}_i}
  \end{cases}
%\quad
%&\Leftrightarrow
%\quad
\label{Euler-Lagrange with p}
\end{align}
となるが、
Lagrangianそのものから$\{\dot{q}\}$を消去し
$\{q\},\{p\}$の$6n$変数関数として書き直すと、
$L$を$\dot{q}$で微分することが出来なくなるため
(\ref{generalized momentum})の右辺を表現する方法がなくなってしまう。
そこで別のアプローチを考えよう。

我々が欲しいのは新しい変数で表されたLagrangianそのものではなく、
Lagrangianを古い変数で微分して得られる方程式系である。
そこで、新しい変数$\{q\},\{p\}$で微分すると
Lagrangianを古い変数$\{q\}, \{\dot{q}\}$
で微分したときと等価の式を与えるような、
新しい関数$H(\{q\},\{p\})$を構成することを考える。

Legendre変換
\begin{align}
  H(\{q\},\{p\})
  :=
  \bigg[
    \sum_i
      \dot{q}_i p_i
  - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\label{hamiltonian definition}
\end{align}
はそのような構成の例である。
右辺には$9n$個の変数$\{q\},\{\dot{q}\},\{p\}$が現れているが、
$\dot{q}$が消去され
$\{q\},\{p\}$の$6n$変数関数として表されていることに注意しよう。
これらparameterで張られる$6n$次元空間を
相空間（phase space、
位相空間と訳す場合もあるが
topological spaceという幾何学の用語との混乱を招くので
推奨しない）といい、
以下で構成する新たな運動方程式の解は
相空間上の軌跡$\{q(t)\},\{p(t)\}$を与える。

関数$H$をHamiltonianというが、
その著しい性質は$\dot{q}$を消去する直前の表式が
$\dot{q}$に依っていないこと
\begin{align}
  \dfrac{\partial}{\partial \dot{q}_i}
  \bigg[
    \sum_j
      \dot{q}_j p_j
  - L(\{q\}, \{\dot{q}\})
  \bigg]
  &=
  \bigg[
    \sum_j\bigg(
      \delta_{ij} p_j
    \bigg)
  - \dfrac{\partial L}{\partial \dot{q}_i}
  \bigg]
\notag\\&=
    p_i
    - \dfrac{\partial L}{\partial \dot{q}_i}
\notag\\
  &\simeq 0
\end{align}
である。
ただし、偏微分を$\{q\},\{\dot{q}\},\{p\}$の全てを独立な変数と見做して
行ったことに注意せよ。
最後の等号$\simeq$は、
独立変数として導入した$p_i$を
（$\{q\},\{\dot{q}\}$の関数である）
一般化運動量$p_i(\{q\},\{\dot{q}\})$と同一視すると等号が成り立つ、
という意味である。

Hamiltonianの$\{q\},\{p\}$による微分は、
$q(t)$がEuler-Lagrange方程式の解であるとすると
\begin{subequations}
\begin{align}
  \dfrac{\partial H}{\partial q_i}
  &=
  \dfrac{\partial}{\partial q_i}
  \bigg[
    \sum_j p_j
     \dot{q}_j
     - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &=
  \sum_j    p_j
   \dfrac{\partial \dot{q}_j (\{q\},\{p\},t) }{\partial q_i }
   - \dfrac{\partial L(\{q\}, \{\dot{q}(\{q\},\{p\},t)\} ) }{
     \partial q_i
   }
\notag\\  &=
   \sum_j    p_j
    \dfrac{\partial \dot{q}_j }{\partial q_i}
    - \Bigg[
      \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
        \partial q_i
      }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
      +
      \sum_j
      \dfrac{\partial \dot{q}_j}{\partial q_i}
      \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
        \partial \dot{q}_j
      }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
    \Bigg]
\notag\\  &=
    \sum_j    p_j
     \dfrac{\partial \dot{q}_j }{\partial q_i}
     - \Bigg[
       \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
         \partial q_i
       }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
       +
       \sum_j
       \dfrac{\partial \dot{q}_j}{\partial q_i}
       p_j
     \Bigg]
\notag\\  &=
      -
        \dfrac{\partial L(\{q\}, \{\dot{q}\} ) }{
          \partial q_i
        }\bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &=
      -
      \dfrac{ d }{ dt }
      \dfrac{\partial L}{
        \partial \dot{q}_i
      }
    \qquad\because\text{Euler-Lagrange方程式}
\notag\\  &=
    -
    \dot{p}_i
\label{Hamilton's eom for p}
\\
  \dfrac{\partial H}{\partial p_i}
  &=
  \dfrac{\partial }{\partial p_i}
  \bigg[
    \sum_j
      \dot{q}_j p_j
  - L(\{q\}, \{\dot{q}\})
  \bigg]_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &=
  \sum_j
  \bigg[
    \dfrac{\partial \dot{q}_j(\{q\},\{p\},t)}{
      \partial p_i
    } p_j
  +
  \dot{q}_j(\{q\},\{p\},t) \delta_{ij}
  \bigg]
- \dfrac{\partial L(\{q\}, \{\dot{q}(\{q\},\{p\},t)\}) }{
  \partial p_i
}
\notag\\  &=
  \sum_j
    \dfrac{\partial \dot{q}_j}{
      \partial p_i
    } p_j
  +
  \dot{q}_i
  - \sum_j
  \dfrac{\partial \dot{q}_j }{
    \partial p_i
  }
  \dfrac{\partial L(\{q\}, \{\dot{q}\}) }{
    \partial \dot{q}_j
  }
  \bigg|_{\dot{q} = \dot{q}(\{q\},\{p\},t)}
\notag\\  &=
  \sum_j
    \dfrac{\partial \dot{q}_j}{
      \partial p_i
    } p_j
  +
  \dot{q}_i
  - \sum_j
  \dfrac{\partial \dot{q}_j }{
    \partial p_i
  }
    p_j
\notag\\  &=
    \dot{q}_i
\label{Hamilton's eom for q}
\end{align}
\end{subequations}
のようにLagrangianを一切使わずに表せ、
逆にHamiltonianを再びLegendre変換したものに
(\ref{Hamilton's eom for p}),(\ref{Hamilton's eom for q})
の解$\{q(t)\},\{p(t)\}$を代入すると
$\{q\},\{p\}$で書いたEuler-Lagrange方程式
(\ref{Euler-Lagrange with p})
を再現する。
すなわち両者は微分方程式系として等価であり、
(\ref{Hamilton's eom for p}),
(\ref{Hamilton's eom for q})を
Hamiltonの正準方程式という。

Hamiltonの方程式はscalar関数$H$から得られるため
(\ref{point transformation})
のような点変換の下でも不変である上、
より一般に
正準運動量$\{p\}$をも座標と等価に扱った座標変換
（正準変換、または接触変換という）
$q = q(\{q'\}, \{p'\}, t ) ,
p = p(\{q'\}, \{p'\}, t )
$
のもとでも不変である。
また1階の時間微分のみを含むので、
望む方程式系が得られたことになる。

\subsubsection{調和振動子の例}

$n$次元調和振動子のLagrangianは
(\ref{harmonic oscillator lagrangian})であったので、
一般化運動量は
\begin{align}
  p_i &= \dfrac{\partial L}{\partial \dot{q}_i}
=
  m \dot{q}_i
\end{align}
と通常の運動量の定義に一致する。
Hamiltonianは
\begin{align}
  H &= \bigg[
    \sum_i p_i \dot{q}_i
    - L
    \bigg]_{ \dot{q}_i = \frac{p_i}{m} }
\notag\\&=
    \sum_i p_i \frac{p_i}{m}
    -
      \sum_i \bigg(
      \dfrac{p_i^2}{2m}
    -
      \dfrac{ m \omega^2 }{2}
      q_i^2
    \bigg)
\notag\\&=
    \sum_i \bigg(
      \dfrac{p_i^2}{2m}
    +
      \dfrac{ m \omega^2 }{2}
      q_i^2
    \bigg)
\end{align}
となる。
正準方程式は
\begin{align}
  \begin{cases}
    \dot{q}_i = \dfrac{\partial H}{\partial p_i}
    = \dfrac{p_i}{m}
  \\
  \\
    \dot{p}_i = - \dfrac{\partial H}{\partial q_i}
    = - m \omega^2 q_i
  \end{cases}
\quad
&\Rightarrow
\quad
  \ddot{q}_i = \dfrac{\dot{p}_i}{m}
  = \dfrac{- m \omega^2 q_i}{m}
  = - \omega^2 q_i
\label{hamiltonian e.o.m for harmonic oscillator}
\end{align}
となって、やはりNewtonの方程式
(\ref{newton harm osci eom})を再現する。

\subsubsection{Poisson括弧}

Hamiltonの正準方程式
\begin{align}
  \begin{cases}
    \dot{q}_i
    = \dfrac{\partial H}
      {\partial p_i}
  \\
  \\
    \dot{p}_i
    = - \dfrac{\partial H}
      {\partial q_i}
  \end{cases}
\label{Hamilton's eom}
\end{align}
は$\{q\},\{p\}$のいずれについても
時間の1階微分しか含まない点で美しいが、
$\{q\},\{p\}$に対して右辺の符号が異なるという非対称性がある。
より抽象的な演算を導入することで、この非対称性を取り除こう。

2つの量$A,B$のPoisson括弧を
\begin{align}
    \{A, B\}_{ \mathrm{P} }
    := \sum_i \bigg(
        \dfrac{ \partial A }{ \partial q_i }
        \dfrac{ \partial B }{ \partial p_i }
    -
        \dfrac{ \partial B }{ \partial q_i }
        \dfrac{ \partial A }{ \partial q_i }
    \bigg)
\label{poisson bracket definition}
\end{align}
で定義すると、
正準変数同士のPoisson括弧は
\begin{align}
   \{q_i, p_j\}_{ \mathrm{P} }
   = \delta_{ij}
,\qquad
   \{p_i, q_j\}_{ \mathrm{P} }
   = - \delta_{ij}
\end{align}
のようになり、
正準方程式(\ref{Hamilton's eom})は
\begin{align}
    \begin{cases}
        \dot{q}_i
        = \dfrac{\partial H}{\partial p_i}
        = \{q_i, H\}_{ \mathrm{P} }
      \\
      \\
        \dot{p}_i
        = - \dfrac{\partial H}{\partial q_i}
        = \{p_i, H\}_{ \mathrm{P} }
      \end{cases}
\quad
\therefore
\quad
    \dot{r} &= \{r, H\}_{ \mathrm{P} }
\qquad
    ( r = q_i, p_j \quad\forall i, j )
\label{Hamilton e.o.m. in Poisson bracket}
\end{align}
と$\{q\},\{p\}$の間で対称な形になる。
より一般に、任意の関数
$F( \{q\},\{p\} , t )$
の時間発展が
\begin{align}
  \dfrac{ d F }{ dt }
  &=
  \dfrac{ \partial F }{ \partial t }
  +
  \sum_i
  \bigg(
    \dfrac{ d q_i }{ dt }
    \dfrac{ \partial F }{ \partial q_i }
  +
    \dfrac{ d p_i }{ dt }
    \dfrac{ \partial F }{ \partial p_i }
  \bigg)
\notag\\&=
  \dfrac{ \partial F }{ \partial t }
  +
  \sum_i
  \bigg(
    \dfrac{\partial H}{\partial p_i}
    \dfrac{ \partial F }{ \partial q_i }
  -
    \dfrac{\partial H}{\partial q_i}
    \dfrac{ \partial F }{ \partial p_i }
  \bigg)
\notag\\&=
  \dfrac{ \partial F }{ \partial t } + \{F, H\}_{ \mathrm{P} }
\label{time evolution in Poisson bracket}
\end{align}
と一つの式にまとまってしまう。
あらゆる量の時間発展を求める過程が、
Poisson括弧の計算という一つの操作に統一されたのである。

\subsubsection{電磁場中の荷電粒子のHamiltonian}

電磁場中の荷電粒子のLagrangianは
(\ref{point particle lagrangian with ele-mag potential})
や
(\ref{many point particle lagrangian with ele-mag potential})
で与えられていた。
このような系のHamiltonianはどのように与えられるだろうか。
$(x_n)_i$を$n$番目の粒子の位置vectorの
第$i$成分とする。
粒子の運動により生じる電磁波を無視する限り
相互作用potential $U$も
Coulomb potential $\phi$も
$\dot{x}$には依存していないので、
一般化運動量の定義から、
電磁場が導入される前後で
\begin{align}
  (p_n')_i
  &=
  \dfrac{\partial L'}{\partial (\dot{x}_n)_i}
  =
  \dfrac{\partial}{\partial (\dot{x_n})_i}
  \left(
    L
  -
    U(\bm{x}_1, \dots, \bm{x}_n)
  -
    \sum_m
    q_m
    \Big[
      \phi(\bm{x}_m)
    -
      \dot{\bm{x}}_m \cdot \bm{A}(\bm{x}_m)
    \Big]
  \right)
\notag\\&
  =
  (p_n)_i
  +
  \sum_m
    q_m
    \Big[
      \delta_{nm} A_i(\bm{x}_m)
    \Big]
=
  (p_n)_i
  +
  q_n
  A_i(\bm{x}_n)
\end{align}
のようにvector potentialの分だけ
正準運動量がsiftすることが分かる。
面倒なので$(n,i)$のlabelを
まとめて$i$と書き直す事にすると、
電磁場中の正準運動量は
\begin{align}
  p'_i = p_i + (q A)_i
\label{canonical momentum in em field}
\end{align}
である。
これらを区別するために、
正準運動量$p_i'$に対して
$p_i$を力学的運動量と呼ぶことがある。
電磁場を導入する前の正準運動量の定義を
逆解きして
$\dot{x}_i = \dot{x}_i(\{x\},\{p\},t)$のような
関係式が得られるとすると、
（$A$は$\dot{x}_i$に顕わに依存しない事を仮定していたので）
$\dot{x}_i$を
新たな正準運動量$p'_i$について逆解きした式は
上の関係から
\begin{align}
  \dot{x}_i = \dot{x}_i(\{x\},\{p\},t)
  =
  \dot{x}_i(\{x\},\{p' - q A\},t)
\end{align}
となるはずなので、
この運動量を用いて
Hamiltonian
(\ref{hamiltonian definition})を定義すると
\begin{align}
  H'
  &=
  \bigg[
    \sum_i
      \dot{x}_i p'_i
  - L'
  \bigg]_{
    \dot{x} =
    \dot{x}(\{x\},\{p' - q A\},t)
  }
\notag\\&
  =
  \left[
    \sum_i
      \dot{x}_i
      p_i'
  -
  \left(
    L
  -
    U(\bm{x}_1, \dots, \bm{x}_n)
  -
    \sum_m
    q_m
    \Big[
      \phi(\bm{x}_m)
    -
      \dot{\bm{x}}_m \cdot \bm{A}(\bm{x}_m)
    \Big]
  \right)
  \right]_{
    \dot{x}
    =
    \dot{x}(\{x\},\{p' - qA\},t)
  }
\notag\\&
  =
  \left[
    \sum_i
      \dot{x}_i
      \bigg(
        p_i' - (q A)_i
      \bigg)
      -
      L
  +
    U(\bm{x}_1, \dots, \bm{x}_n)
  +
    \sum_m
    q_m
      \phi(\bm{x}_m)
  \right]_{
    \dot{x}
    =
    \dot{x}(\{x\},\{p' - qA\},t)
  }
\notag\\&
  =
    H(\{x\},\{p' - qA\})
  +
    U
  +
  \sum_m
    q_m
    \phi(\bm{x}_m)
\label{point charge hamiltonian}
\end{align}
を得、電場はenergyを、
磁場はmomentumをsiftする事が分かる。
